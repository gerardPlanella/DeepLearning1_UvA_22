Running experiment on cifar10 with padding and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=16, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='padding', prompt_size=1, text_prompt_template='This is a photo of a {}', root='/scratch/lcur0640', dataset='cifar10', image_size=224, test_noise=False, visualize_prompt=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='padding_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume='.//save/models/padding_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar', evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/padding_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:09, 348177.22it/s]  0%|          | 163840/170498071 [00:00<06:27, 439975.23it/s]  0%|          | 327680/170498071 [00:00<03:31, 803300.62it/s]  0%|          | 622592/170498071 [00:00<02:09, 1307127.34it/s]  1%|          | 1277952/170498071 [00:00<01:10, 2408755.37it/s]  2%|▏         | 2719744/170498071 [00:00<00:30, 5500615.49it/s]  3%|▎         | 4456448/170498071 [00:00<00:19, 8685144.17it/s]  4%|▎         | 6356992/170498071 [00:01<00:14, 11543152.42it/s]  5%|▍         | 8257536/170498071 [00:01<00:11, 13659749.37it/s]  6%|▌         | 10387456/170498071 [00:01<00:10, 15854728.86it/s]  7%|▋         | 12681216/170498071 [00:01<00:08, 17917002.37it/s]  9%|▊         | 14778368/170498071 [00:01<00:08, 18709547.28it/s] 10%|█         | 17629184/170498071 [00:01<00:07, 21593978.91it/s] 12%|█▏        | 20316160/170498071 [00:01<00:06, 23140242.82it/s] 14%|█▎        | 23101440/170498071 [00:01<00:06, 23227400.46it/s] 15%|█▌        | 26017792/170498071 [00:01<00:05, 24910926.27it/s] 17%|█▋        | 29065216/170498071 [00:01<00:05, 26524390.86it/s] 19%|█▉        | 32178176/170498071 [00:02<00:04, 27869084.01it/s] 21%|██        | 35225600/170498071 [00:02<00:04, 28628993.69it/s] 22%|██▏       | 38240256/170498071 [00:02<00:04, 29055275.93it/s] 24%|██▍       | 41484288/170498071 [00:02<00:04, 30055249.56it/s] 26%|██▌       | 44728320/170498071 [00:02<00:04, 30762625.59it/s] 28%|██▊       | 47841280/170498071 [00:02<00:04, 27199574.74it/s] 30%|██▉       | 50987008/170498071 [00:02<00:04, 28218032.30it/s] 32%|███▏      | 54231040/170498071 [00:02<00:03, 29385129.42it/s] 34%|███▎      | 57245696/170498071 [00:02<00:03, 29546795.75it/s] 35%|███▌      | 60260352/170498071 [00:03<00:03, 29663166.19it/s] 37%|███▋      | 63275008/170498071 [00:03<00:03, 29766770.42it/s] 39%|███▉      | 66551808/170498071 [00:03<00:03, 30409163.14it/s] 41%|████      | 69795840/170498071 [00:03<00:03, 30990972.86it/s] 43%|████▎     | 73039872/170498071 [00:03<00:03, 31395421.21it/s] 45%|████▍     | 76218368/170498071 [00:03<00:03, 31333734.11it/s] 47%|████▋     | 79462400/170498071 [00:03<00:02, 31638750.55it/s] 48%|████▊     | 82640896/170498071 [00:03<00:02, 30926549.60it/s] 50%|█████     | 85819392/170498071 [00:03<00:02, 31161455.63it/s] 52%|█████▏    | 88965120/170498071 [00:03<00:02, 30784966.51it/s] 54%|█████▍    | 92078080/170498071 [00:04<00:02, 30513982.75it/s] 56%|█████▌    | 95158272/170498071 [00:04<00:02, 30102214.81it/s] 58%|█████▊    | 98172928/170498071 [00:04<00:02, 29741398.33it/s] 59%|█████▉    | 101154816/170498071 [00:04<00:02, 29403307.38it/s] 61%|██████    | 104235008/170498071 [00:04<00:02, 29771867.68it/s] 63%|██████▎   | 107380736/170498071 [00:04<00:02, 29855205.53it/s] 65%|██████▍   | 110493696/170498071 [00:04<00:01, 30173077.69it/s] 67%|██████▋   | 113573888/170498071 [00:04<00:01, 29978313.69it/s] 68%|██████▊   | 116686848/170498071 [00:04<00:01, 30289051.15it/s] 70%|███████   | 119734272/170498071 [00:05<00:01, 29642949.28it/s] 72%|███████▏  | 122716160/170498071 [00:05<00:01, 29680520.67it/s] 74%|███████▎  | 125698048/170498071 [00:05<00:01, 29175794.94it/s] 76%|███████▌  | 128778240/170498071 [00:05<00:01, 29584697.10it/s] 77%|███████▋  | 131760128/170498071 [00:05<00:01, 28763294.00it/s] 79%|███████▉  | 134643712/170498071 [00:05<00:01, 28686479.93it/s] 81%|████████  | 137527296/170498071 [00:05<00:01, 28581537.55it/s] 82%|████████▏ | 140607488/170498071 [00:05<00:01, 29231329.88it/s] 84%|████████▍ | 143654912/170498071 [00:05<00:00, 29578744.97it/s] 86%|████████▌ | 146800640/170498071 [00:05<00:00, 28901166.65it/s] 88%|████████▊ | 149946368/170498071 [00:06<00:00, 29586206.21it/s] 90%|████████▉ | 153059328/170498071 [00:06<00:00, 29993304.81it/s] 92%|█████████▏| 156172288/170498071 [00:06<00:00, 30183259.14it/s] 93%|█████████▎| 159350784/170498071 [00:06<00:00, 30636607.55it/s] 95%|█████████▌| 162496512/170498071 [00:06<00:00, 30093539.74it/s] 97%|█████████▋| 165642240/170498071 [00:06<00:00, 30423348.60it/s] 99%|█████████▉| 168787968/170498071 [00:06<00:00, 30723117.22it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25446015.26it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  0%|                                      | 1.02M/338M [00:00<01:18, 4.51MiB/s]  1%|▏                                     | 1.80M/338M [00:00<00:59, 5.88MiB/s]  1%|▎                                     | 2.67M/338M [00:00<00:50, 7.01MiB/s]  1%|▍                                     | 3.56M/338M [00:00<00:45, 7.75MiB/s]  1%|▌                                     | 4.50M/338M [00:00<00:41, 8.39MiB/s]  2%|▌                                     | 5.53M/338M [00:00<00:38, 9.12MiB/s]  2%|▋                                     | 6.44M/338M [00:00<00:38, 8.98MiB/s]  2%|▊                                     | 7.32M/338M [00:00<00:38, 9.04MiB/s]  2%|▉                                     | 8.29M/338M [00:01<00:36, 9.37MiB/s]  3%|█                                     | 9.20M/338M [00:01<00:39, 8.79MiB/s]  3%|█▏                                    | 10.1M/338M [00:01<00:39, 8.63MiB/s]  3%|█▏                                    | 10.9M/338M [00:01<00:39, 8.77MiB/s]  4%|█▎                                    | 11.9M/338M [00:01<00:37, 9.10MiB/s]  4%|█▍                                    | 13.0M/338M [00:01<00:34, 9.76MiB/s]  4%|█▌                                    | 14.2M/338M [00:01<00:32, 10.5MiB/s]  5%|█▋                                    | 15.3M/338M [00:01<00:31, 10.6MiB/s]  5%|█▊                                    | 16.3M/338M [00:01<00:31, 10.6MiB/s]  5%|█▉                                    | 17.4M/338M [00:01<00:31, 10.8MiB/s]  6%|██                                    | 18.6M/338M [00:02<00:29, 11.4MiB/s]  6%|██▏                                   | 19.9M/338M [00:02<00:27, 12.0MiB/s]  6%|██▎                                   | 21.0M/338M [00:02<00:27, 12.0MiB/s]  7%|██▍                                   | 22.2M/338M [00:02<00:28, 11.7MiB/s]  7%|██▋                                   | 23.3M/338M [00:02<00:27, 11.8MiB/s]  7%|██▊                                   | 24.6M/338M [00:02<00:26, 12.3MiB/s]  8%|██▉                                   | 26.0M/338M [00:02<00:25, 12.9MiB/s]  8%|███                                   | 27.5M/338M [00:02<00:23, 13.7MiB/s]  9%|███▏                                  | 28.8M/338M [00:02<00:24, 13.1MiB/s]  9%|███▍                                  | 30.0M/338M [00:03<00:26, 12.2MiB/s]  9%|███▌                                  | 31.2M/338M [00:03<00:28, 11.2MiB/s] 10%|███▋                                  | 32.3M/338M [00:03<00:29, 10.7MiB/s] 10%|███▊                                  | 33.4M/338M [00:03<00:29, 10.8MiB/s] 10%|███▉                                  | 34.5M/338M [00:03<00:29, 10.9MiB/s] 11%|███▉                                  | 35.5M/338M [00:03<00:30, 10.3MiB/s] 11%|████                                  | 36.5M/338M [00:03<00:31, 9.89MiB/s] 11%|████▏                                 | 37.5M/338M [00:03<00:31, 10.0MiB/s] 11%|████▎                                 | 38.6M/338M [00:03<00:29, 10.5MiB/s] 12%|████▍                                 | 39.9M/338M [00:04<00:27, 11.2MiB/s] 12%|████▋                                 | 41.2M/338M [00:04<00:26, 11.9MiB/s] 13%|████▊                                 | 42.6M/338M [00:04<00:24, 12.8MiB/s] 13%|████▉                                 | 44.1M/338M [00:04<00:22, 13.8MiB/s] 13%|█████                                 | 45.5M/338M [00:04<00:22, 13.5MiB/s] 14%|█████▎                                | 46.8M/338M [00:04<00:23, 13.2MiB/s] 14%|█████▍                                | 48.0M/338M [00:04<00:24, 12.5MiB/s] 15%|█████▌                                | 49.2M/338M [00:04<00:26, 11.4MiB/s] 15%|█████▋                                | 50.4M/338M [00:04<00:26, 11.4MiB/s] 15%|█████▊                                | 51.5M/338M [00:05<00:27, 10.9MiB/s] 16%|█████▉                                | 52.5M/338M [00:05<00:29, 10.2MiB/s] 16%|██████                                | 53.5M/338M [00:05<00:29, 9.99MiB/s] 16%|██████▏                               | 54.5M/338M [00:05<00:29, 9.99MiB/s] 16%|██████▏                               | 55.4M/338M [00:05<00:31, 9.29MiB/s] 17%|██████▎                               | 56.3M/338M [00:05<00:32, 9.10MiB/s] 17%|██████▍                               | 57.2M/338M [00:05<00:32, 9.11MiB/s] 17%|██████▌                               | 58.1M/338M [00:05<00:31, 9.33MiB/s] 18%|██████▋                               | 59.2M/338M [00:05<00:29, 9.88MiB/s] 18%|██████▊                               | 60.2M/338M [00:06<00:29, 9.80MiB/s] 18%|██████▉                               | 61.1M/338M [00:06<00:29, 9.82MiB/s] 18%|██████▉                               | 62.1M/338M [00:06<00:29, 9.89MiB/s] 19%|███████                               | 63.2M/338M [00:06<00:27, 10.4MiB/s] 19%|███████▏                              | 64.2M/338M [00:06<00:27, 10.3MiB/s] 19%|███████▎                              | 65.2M/338M [00:06<00:28, 10.0MiB/s] 20%|███████▍                              | 66.2M/338M [00:06<00:28, 10.2MiB/s] 20%|███████▌                              | 67.4M/338M [00:06<00:27, 10.4MiB/s] 20%|███████▋                              | 68.4M/338M [00:06<00:32, 8.80MiB/s] 21%|███████▊                              | 69.2M/338M [00:07<00:33, 8.35MiB/s] 21%|███████▉                              | 70.1M/338M [00:07<00:33, 8.42MiB/s] 21%|███████▉                              | 71.0M/338M [00:07<00:32, 8.63MiB/s] 21%|████████                              | 72.0M/338M [00:07<00:30, 9.17MiB/s] 22%|████████▏                             | 73.1M/338M [00:07<00:28, 9.90MiB/s] 22%|████████▎                             | 74.1M/338M [00:07<00:28, 9.87MiB/s] 22%|████████▍                             | 75.0M/338M [00:07<00:27, 9.87MiB/s] 23%|████████▌                             | 76.0M/338M [00:07<00:28, 9.70MiB/s] 23%|████████▋                             | 76.9M/338M [00:07<00:29, 9.27MiB/s] 23%|████████▊                             | 77.8M/338M [00:07<00:29, 9.09MiB/s] 23%|████████▊                             | 78.7M/338M [00:08<00:29, 9.13MiB/s] 24%|████████▉                             | 79.7M/338M [00:08<00:28, 9.60MiB/s] 24%|█████████                             | 80.9M/338M [00:08<00:26, 10.2MiB/s] 24%|█████████▏                            | 82.1M/338M [00:08<00:24, 11.0MiB/s] 25%|█████████▎                            | 83.2M/338M [00:08<00:25, 10.5MiB/s] 25%|█████████▍                            | 84.2M/338M [00:08<00:25, 10.5MiB/s] 25%|█████████▌                            | 85.3M/338M [00:08<00:24, 10.9MiB/s] 26%|█████████▋                            | 86.4M/338M [00:08<00:24, 10.8MiB/s] 26%|█████████▊                            | 87.4M/338M [00:08<00:25, 10.1MiB/s] 26%|█████████▉                            | 88.4M/338M [00:09<00:26, 9.95MiB/s] 26%|██████████                            | 89.4M/338M [00:09<00:25, 10.2MiB/s] 27%|██████████▏                           | 90.6M/338M [00:09<00:24, 10.7MiB/s] 27%|██████████▎                           | 91.6M/338M [00:09<00:24, 10.4MiB/s] 27%|██████████▍                           | 92.6M/338M [00:09<00:25, 10.2MiB/s] 28%|██████████▌                           | 93.7M/338M [00:09<00:24, 10.4MiB/s] 28%|██████████▋                           | 94.8M/338M [00:09<00:23, 10.9MiB/s] 28%|██████████▊                           | 96.1M/338M [00:09<00:21, 11.6MiB/s] 29%|██████████▉                           | 97.5M/338M [00:09<00:20, 12.5MiB/s] 29%|███████████▏                          | 99.0M/338M [00:09<00:18, 13.4MiB/s] 30%|███████████▌                           | 100M/338M [00:10<00:18, 13.6MiB/s] 30%|███████████▋                           | 102M/338M [00:10<00:18, 13.2MiB/s] 30%|███████████▉                           | 103M/338M [00:10<00:21, 11.5MiB/s] 31%|████████████                           | 104M/338M [00:10<00:22, 10.8MiB/s] 31%|████████████▏                          | 105M/338M [00:10<00:22, 10.9MiB/s] 31%|████████████▎                          | 106M/338M [00:10<00:21, 11.1MiB/s] 32%|████████████▍                          | 108M/338M [00:10<00:20, 11.7MiB/s] 32%|████████████▌                          | 109M/338M [00:10<00:19, 12.4MiB/s] 33%|████████████▊                          | 110M/338M [00:10<00:17, 13.3MiB/s] 33%|████████████▉                          | 112M/338M [00:11<00:16, 14.2MiB/s] 34%|█████████████                          | 113M/338M [00:11<00:16, 14.4MiB/s] 34%|█████████████▎                         | 115M/338M [00:11<00:16, 14.0MiB/s] 34%|█████████████▍                         | 116M/338M [00:11<00:16, 14.1MiB/s] 35%|█████████████▌                         | 118M/338M [00:11<00:16, 14.2MiB/s] 35%|█████████████▋                         | 119M/338M [00:11<00:17, 13.4MiB/s] 36%|█████████████▉                         | 120M/338M [00:11<00:17, 12.7MiB/s] 36%|██████████████                         | 121M/338M [00:11<00:18, 12.5MiB/s] 36%|██████████████▏                        | 123M/338M [00:11<00:17, 12.6MiB/s] 37%|██████████████▎                        | 124M/338M [00:12<00:17, 12.6MiB/s] 37%|██████████████▍                        | 125M/338M [00:12<00:18, 12.0MiB/s] 37%|██████████████▌                        | 126M/338M [00:12<00:18, 11.7MiB/s] 38%|██████████████▋                        | 127M/338M [00:12<00:18, 11.7MiB/s] 38%|██████████████▊                        | 128M/338M [00:12<00:19, 11.4MiB/s] 38%|██████████████▉                        | 130M/338M [00:12<00:20, 10.8MiB/s] 39%|███████████████                        | 131M/338M [00:12<00:20, 10.4MiB/s] 39%|███████████████▏                       | 132M/338M [00:12<00:20, 10.5MiB/s] 39%|███████████████▎                       | 133M/338M [00:12<00:19, 10.9MiB/s] 40%|███████████████▍                       | 134M/338M [00:13<00:19, 11.0MiB/s] 40%|███████████████▌                       | 135M/338M [00:13<00:19, 10.7MiB/s] 40%|███████████████▋                       | 136M/338M [00:13<00:19, 10.8MiB/s] 41%|███████████████▊                       | 137M/338M [00:13<00:18, 11.2MiB/s] 41%|████████████████                       | 139M/338M [00:13<00:17, 11.8MiB/s] 41%|████████████████▏                      | 140M/338M [00:13<00:16, 12.6MiB/s] 42%|████████████████▎                      | 141M/338M [00:13<00:15, 13.4MiB/s] 42%|████████████████▍                      | 143M/338M [00:13<00:15, 12.8MiB/s] 43%|████████████████▋                      | 144M/338M [00:13<00:15, 12.8MiB/s] 43%|████████████████▊                      | 145M/338M [00:13<00:15, 12.9MiB/s] 43%|████████████████▉                      | 146M/338M [00:14<00:16, 12.0MiB/s] 44%|█████████████████                      | 148M/338M [00:14<00:17, 11.5MiB/s] 44%|█████████████████▏                     | 149M/338M [00:14<00:19, 10.3MiB/s] 44%|█████████████████▎                     | 150M/338M [00:14<00:20, 9.50MiB/s] 45%|█████████████████▍                     | 151M/338M [00:14<00:20, 9.56MiB/s] 45%|█████████████████▌                     | 152M/338M [00:14<00:20, 9.58MiB/s] 45%|█████████████████▋                     | 153M/338M [00:14<00:19, 10.1MiB/s] 46%|█████████████████▊                     | 154M/338M [00:14<00:17, 10.9MiB/s] 46%|█████████████████▉                     | 155M/338M [00:14<00:16, 11.6MiB/s] 46%|██████████████████                     | 157M/338M [00:15<00:15, 12.5MiB/s] 47%|██████████████████▎                    | 158M/338M [00:15<00:13, 13.5MiB/s] 47%|██████████████████▍                    | 160M/338M [00:15<00:12, 14.6MiB/s] 48%|██████████████████▋                    | 161M/338M [00:15<00:11, 15.6MiB/s] 48%|██████████████████▊                    | 163M/338M [00:15<00:10, 16.6MiB/s] 49%|███████████████████                    | 165M/338M [00:15<00:12, 13.9MiB/s] 49%|███████████████████▏                   | 166M/338M [00:15<00:14, 12.5MiB/s] 50%|███████████████████▎                   | 168M/338M [00:15<00:14, 12.4MiB/s] 50%|███████████████████▌                   | 169M/338M [00:16<00:15, 11.2MiB/s] 50%|███████████████████▋                   | 170M/338M [00:16<00:16, 10.5MiB/s] 51%|███████████████████▊                   | 171M/338M [00:16<00:16, 10.6MiB/s] 51%|███████████████████▊                   | 172M/338M [00:16<00:16, 10.7MiB/s] 51%|████████████████████                   | 173M/338M [00:16<00:15, 11.1MiB/s] 52%|████████████████████▏                  | 174M/338M [00:16<00:14, 11.8MiB/s] 52%|████████████████████▎                  | 176M/338M [00:16<00:13, 12.6MiB/s] 53%|████████████████████▍                  | 177M/338M [00:16<00:12, 13.5MiB/s] 53%|████████████████████▋                  | 179M/338M [00:16<00:12, 13.3MiB/s] 53%|████████████████████▊                  | 180M/338M [00:17<00:14, 11.6MiB/s] 54%|████████████████████▉                  | 181M/338M [00:17<00:15, 10.8MiB/s] 54%|█████████████████████                  | 182M/338M [00:17<00:15, 10.7MiB/s] 54%|█████████████████████▏                 | 183M/338M [00:17<00:14, 10.9MiB/s] 55%|█████████████████████▎                 | 185M/338M [00:17<00:14, 11.4MiB/s] 55%|█████████████████████▍                 | 186M/338M [00:17<00:13, 12.1MiB/s] 55%|█████████████████████▋                 | 187M/338M [00:17<00:12, 12.9MiB/s] 56%|█████████████████████▊                 | 189M/338M [00:17<00:11, 13.8MiB/s] 56%|█████████████████████▉                 | 190M/338M [00:17<00:11, 13.7MiB/s] 57%|██████████████████████▏                | 192M/338M [00:18<00:12, 12.0MiB/s] 57%|██████████████████████▎                | 193M/338M [00:18<00:13, 11.1MiB/s] 57%|██████████████████████▍                | 194M/338M [00:18<00:13, 10.9MiB/s] 58%|██████████████████████▌                | 195M/338M [00:18<00:13, 11.0MiB/s] 58%|██████████████████████▋                | 196M/338M [00:18<00:13, 11.4MiB/s] 59%|██████████████████████▊                | 198M/338M [00:18<00:12, 12.1MiB/s] 59%|██████████████████████▉                | 199M/338M [00:18<00:11, 12.6MiB/s] 59%|███████████████████████                | 200M/338M [00:18<00:11, 12.1MiB/s] 60%|███████████████████████▎               | 201M/338M [00:18<00:11, 12.1MiB/s] 60%|███████████████████████▍               | 203M/338M [00:19<00:12, 11.3MiB/s] 60%|███████████████████████▌               | 204M/338M [00:19<00:13, 10.5MiB/s] 61%|███████████████████████▋               | 205M/338M [00:19<00:13, 10.5MiB/s] 61%|███████████████████████▊               | 206M/338M [00:19<00:13, 10.1MiB/s] 61%|███████████████████████▊               | 207M/338M [00:19<00:14, 9.47MiB/s] 61%|███████████████████████▉               | 208M/338M [00:19<00:14, 9.48MiB/s] 62%|████████████████████████               | 208M/338M [00:19<00:14, 9.58MiB/s] 62%|████████████████████████▏              | 210M/338M [00:19<00:13, 10.1MiB/s] 62%|████████████████████████▎              | 211M/338M [00:19<00:12, 10.8MiB/s] 63%|████████████████████████▍              | 212M/338M [00:20<00:11, 11.1MiB/s] 63%|████████████████████████▌              | 213M/338M [00:20<00:11, 11.1MiB/s] 63%|████████████████████████▋              | 214M/338M [00:20<00:11, 11.1MiB/s] 64%|████████████████████████▉              | 215M/338M [00:20<00:11, 11.5MiB/s] 64%|█████████████████████████              | 217M/338M [00:20<00:10, 12.1MiB/s] 65%|█████████████████████████▏             | 218M/338M [00:20<00:09, 12.8MiB/s] 65%|█████████████████████████▎             | 219M/338M [00:20<00:09, 12.7MiB/s] 65%|█████████████████████████▍             | 221M/338M [00:20<00:09, 12.4MiB/s] 66%|█████████████████████████▌             | 222M/338M [00:20<00:10, 12.1MiB/s] 66%|█████████████████████████▊             | 223M/338M [00:20<00:10, 11.2MiB/s] 66%|█████████████████████████▉             | 224M/338M [00:21<00:11, 10.8MiB/s] 67%|█████████████████████████▉             | 225M/338M [00:21<00:11, 10.5MiB/s] 67%|██████████████████████████             | 226M/338M [00:21<00:12, 9.62MiB/s] 67%|██████████████████████████▏            | 227M/338M [00:21<00:12, 9.32MiB/s] 68%|██████████████████████████▎            | 228M/338M [00:21<00:12, 9.38MiB/s] 68%|██████████████████████████▍            | 229M/338M [00:21<00:11, 9.81MiB/s] 68%|██████████████████████████▌            | 230M/338M [00:21<00:11, 9.49MiB/s] 68%|██████████████████████████▋            | 231M/338M [00:21<00:11, 9.49MiB/s] 69%|██████████████████████████▊            | 232M/338M [00:21<00:11, 9.59MiB/s] 69%|██████████████████████████▉            | 233M/338M [00:22<00:10, 10.2MiB/s] 69%|███████████████████████████            | 234M/338M [00:22<00:09, 10.9MiB/s] 70%|███████████████████████████▏           | 235M/338M [00:22<00:09, 11.0MiB/s] 70%|███████████████████████████▎           | 236M/338M [00:22<00:09, 10.8MiB/s] 70%|███████████████████████████▍           | 237M/338M [00:22<00:09, 11.0MiB/s] 71%|███████████████████████████▌           | 238M/338M [00:22<00:10, 10.0MiB/s] 71%|███████████████████████████▋           | 239M/338M [00:22<00:10, 9.60MiB/s] 71%|███████████████████████████▊           | 240M/338M [00:22<00:10, 9.66MiB/s] 72%|███████████████████████████▉           | 241M/338M [00:22<00:09, 10.1MiB/s] 72%|████████████████████████████           | 243M/338M [00:23<00:09, 10.7MiB/s] 72%|████████████████████████████▏          | 244M/338M [00:23<00:09, 10.2MiB/s] 72%|████████████████████████████▎          | 245M/338M [00:23<00:09, 10.2MiB/s] 73%|████████████████████████████▍          | 246M/338M [00:23<00:09, 10.6MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:23<00:08, 11.2MiB/s] 74%|████████████████████████████▋          | 248M/338M [00:23<00:07, 11.9MiB/s] 74%|████████████████████████████▊          | 249M/338M [00:23<00:07, 11.6MiB/s] 74%|████████████████████████████▉          | 250M/338M [00:23<00:08, 11.3MiB/s] 75%|█████████████████████████████          | 252M/338M [00:23<00:07, 11.7MiB/s] 75%|█████████████████████████████▏         | 253M/338M [00:23<00:07, 12.2MiB/s] 75%|█████████████████████████████▎         | 254M/338M [00:24<00:07, 12.2MiB/s] 76%|█████████████████████████████▍         | 255M/338M [00:24<00:07, 11.9MiB/s] 76%|█████████████████████████████▋         | 256M/338M [00:24<00:07, 11.6MiB/s] 76%|█████████████████████████████▊         | 258M/338M [00:24<00:07, 10.8MiB/s] 77%|█████████████████████████████▉         | 259M/338M [00:24<00:08, 10.3MiB/s] 77%|█████████████████████████████▉         | 260M/338M [00:24<00:07, 10.4MiB/s] 77%|██████████████████████████████         | 261M/338M [00:24<00:07, 10.6MiB/s] 78%|██████████████████████████████▏        | 262M/338M [00:24<00:07, 10.5MiB/s] 78%|██████████████████████████████▎        | 263M/338M [00:24<00:07, 10.3MiB/s] 78%|██████████████████████████████▍        | 264M/338M [00:25<00:07, 10.4MiB/s] 78%|██████████████████████████████▌        | 265M/338M [00:25<00:07, 10.3MiB/s] 79%|██████████████████████████████▋        | 266M/338M [00:25<00:07, 9.64MiB/s] 79%|██████████████████████████████▊        | 267M/338M [00:25<00:07, 9.46MiB/s] 79%|██████████████████████████████▉        | 268M/338M [00:25<00:07, 9.55MiB/s] 80%|███████████████████████████████        | 269M/338M [00:25<00:07, 10.1MiB/s] 80%|███████████████████████████████▏       | 270M/338M [00:25<00:06, 10.8MiB/s] 80%|███████████████████████████████▎       | 271M/338M [00:25<00:06, 11.6MiB/s] 81%|███████████████████████████████▍       | 272M/338M [00:25<00:05, 11.6MiB/s] 81%|███████████████████████████████▌       | 273M/338M [00:26<00:05, 11.5MiB/s] 81%|███████████████████████████████▋       | 275M/338M [00:26<00:05, 11.5MiB/s] 82%|███████████████████████████████▊       | 276M/338M [00:26<00:06, 10.2MiB/s] 82%|███████████████████████████████▉       | 277M/338M [00:26<00:06, 10.0MiB/s] 82%|████████████████████████████████       | 278M/338M [00:26<00:06, 10.1MiB/s] 83%|████████████████████████████████▏      | 279M/338M [00:26<00:05, 10.5MiB/s] 83%|████████████████████████████████▎      | 280M/338M [00:26<00:05, 11.1MiB/s] 83%|████████████████████████████████▍      | 281M/338M [00:26<00:04, 11.8MiB/s] 84%|████████████████████████████████▋      | 283M/338M [00:26<00:04, 12.7MiB/s] 84%|████████████████████████████████▊      | 284M/338M [00:26<00:04, 13.5MiB/s] 85%|████████████████████████████████▉      | 286M/338M [00:27<00:04, 12.9MiB/s] 85%|█████████████████████████████████▏     | 287M/338M [00:27<00:04, 12.9MiB/s] 85%|█████████████████████████████████▎     | 288M/338M [00:27<00:03, 13.3MiB/s] 86%|█████████████████████████████████▍     | 289M/338M [00:27<00:04, 11.9MiB/s] 86%|█████████████████████████████████▌     | 291M/338M [00:27<00:04, 11.5MiB/s] 86%|█████████████████████████████████▋     | 292M/338M [00:27<00:04, 10.9MiB/s] 87%|█████████████████████████████████▊     | 293M/338M [00:27<00:04, 10.3MiB/s] 87%|█████████████████████████████████▉     | 294M/338M [00:27<00:04, 9.86MiB/s] 87%|██████████████████████████████████     | 295M/338M [00:28<00:04, 9.91MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:28<00:04, 10.4MiB/s] 88%|██████████████████████████████████▎    | 297M/338M [00:28<00:03, 10.9MiB/s] 88%|██████████████████████████████████▍    | 298M/338M [00:28<00:03, 11.7MiB/s] 89%|██████████████████████████████████▌    | 300M/338M [00:28<00:03, 12.6MiB/s] 89%|██████████████████████████████████▊    | 301M/338M [00:28<00:03, 12.0MiB/s] 89%|██████████████████████████████████▉    | 302M/338M [00:28<00:03, 12.0MiB/s] 90%|███████████████████████████████████    | 303M/338M [00:28<00:02, 12.3MiB/s] 90%|███████████████████████████████████▏   | 305M/338M [00:28<00:02, 12.6MiB/s] 91%|███████████████████████████████████▎   | 306M/338M [00:28<00:02, 11.6MiB/s] 91%|███████████████████████████████████▍   | 307M/338M [00:29<00:02, 11.4MiB/s] 91%|███████████████████████████████████▌   | 308M/338M [00:29<00:02, 11.4MiB/s] 92%|███████████████████████████████████▋   | 309M/338M [00:29<00:02, 11.7MiB/s] 92%|███████████████████████████████████▉   | 311M/338M [00:29<00:02, 12.3MiB/s] 92%|████████████████████████████████████   | 312M/338M [00:29<00:02, 11.5MiB/s] 93%|████████████████████████████████████▏  | 313M/338M [00:29<00:02, 11.2MiB/s] 93%|████████████████████████████████████▎  | 314M/338M [00:29<00:02, 11.1MiB/s] 93%|████████████████████████████████████▍  | 315M/338M [00:29<00:02, 10.2MiB/s] 94%|████████████████████████████████████▌  | 316M/338M [00:29<00:02, 9.72MiB/s] 94%|████████████████████████████████████▌  | 317M/338M [00:30<00:02, 9.50MiB/s] 94%|████████████████████████████████████▋  | 318M/338M [00:30<00:02, 9.95MiB/s] 95%|████████████████████████████████████▊  | 319M/338M [00:30<00:01, 10.6MiB/s] 95%|█████████████████████████████████████  | 320M/338M [00:30<00:01, 11.4MiB/s] 95%|█████████████████████████████████████▏ | 322M/338M [00:30<00:01, 12.2MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:30<00:01, 12.5MiB/s] 96%|█████████████████████████████████████▍ | 324M/338M [00:30<00:01, 12.2MiB/s] 96%|█████████████████████████████████████▌ | 325M/338M [00:30<00:01, 11.9MiB/s] 97%|█████████████████████████████████████▋ | 327M/338M [00:30<00:01, 11.0MiB/s] 97%|█████████████████████████████████████▊ | 328M/338M [00:31<00:00, 10.6MiB/s] 97%|█████████████████████████████████████▉ | 329M/338M [00:31<00:00, 10.6MiB/s] 98%|██████████████████████████████████████ | 330M/338M [00:31<00:00, 11.0MiB/s] 98%|██████████████████████████████████████▎| 331M/338M [00:31<00:00, 11.6MiB/s] 98%|██████████████████████████████████████▍| 332M/338M [00:31<00:00, 12.4MiB/s] 99%|██████████████████████████████████████▌| 334M/338M [00:31<00:00, 13.2MiB/s] 99%|██████████████████████████████████████▊| 335M/338M [00:31<00:00, 14.1MiB/s]100%|██████████████████████████████████████▉| 337M/338M [00:31<00:00, 12.6MiB/s]100%|███████████████████████████████████████| 338M/338M [00:31<00:00, 11.1MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
=> loading checkpoint './/save/models/padding_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar'
=> loaded checkpoint './/save/models/padding_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar' (epoch 17)
Turning off gradients in both the image and the text encoder
Parameters to be updated:
("Parameters to be updated: {'prompt_learner.pad_up', "
 "'prompt_learner.pad_down', 'prompt_learner.pad_right', "
 "'prompt_learner.pad_left'}")
Number of prompt parameters:  2676
Files already downloaded and verified
Files already downloaded and verified
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:22, 336435.51it/s]  0%|          | 131072/169001437 [00:00<05:59, 470289.60it/s]  0%|          | 229376/169001437 [00:00<05:44, 490528.46it/s]  0%|          | 360448/169001437 [00:00<03:53, 720862.79it/s]  0%|          | 688128/169001437 [00:00<01:55, 1457019.01it/s]  1%|          | 1343488/169001437 [00:00<01:11, 2333176.76it/s]  2%|▏         | 2752512/169001437 [00:00<00:31, 5250910.13it/s]  3%|▎         | 4620288/169001437 [00:01<00:18, 8761606.86it/s]  4%|▍         | 6488064/169001437 [00:01<00:14, 11454023.04it/s]  5%|▍         | 8421376/169001437 [00:01<00:11, 13642825.68it/s]  6%|▌         | 10387456/169001437 [00:01<00:10, 15351740.40it/s]  7%|▋         | 12615680/169001437 [00:01<00:09, 17350170.21it/s]  9%|▉         | 14974976/169001437 [00:01<00:08, 19175616.83it/s] 10%|█         | 17072128/169001437 [00:01<00:07, 19655286.03it/s] 12%|█▏        | 19628032/169001437 [00:01<00:06, 21397145.83it/s] 13%|█▎        | 22216704/169001437 [00:01<00:06, 22720763.83it/s] 15%|█▍        | 24969216/169001437 [00:01<00:05, 24148305.80it/s] 17%|█▋        | 27918336/169001437 [00:02<00:05, 25723393.65it/s] 18%|█▊        | 30900224/169001437 [00:02<00:05, 26926767.08it/s] 20%|██        | 33849344/169001437 [00:02<00:04, 27690461.34it/s] 22%|██▏       | 36864000/169001437 [00:02<00:04, 28318544.13it/s] 24%|██▎       | 39944192/169001437 [00:02<00:04, 28928017.17it/s] 25%|██▌       | 42991616/169001437 [00:02<00:04, 29370155.84it/s] 27%|██▋       | 45940736/169001437 [00:02<00:04, 29338182.26it/s] 29%|██▉       | 48889856/169001437 [00:02<00:04, 29372055.48it/s] 31%|███       | 52002816/169001437 [00:02<00:03, 29834125.98it/s] 33%|███▎      | 55017472/169001437 [00:02<00:03, 29927391.58it/s] 34%|███▍      | 58032128/169001437 [00:03<00:03, 29899497.94it/s] 36%|███▌      | 61145088/169001437 [00:03<00:03, 30221284.87it/s] 38%|███▊      | 64258048/169001437 [00:03<00:03, 30487982.65it/s] 40%|███▉      | 67502080/169001437 [00:03<00:03, 31053513.93it/s] 42%|████▏     | 70746112/169001437 [00:03<00:03, 31466206.61it/s] 44%|████▎     | 73924608/169001437 [00:03<00:03, 31280200.99it/s] 46%|████▌     | 77168640/169001437 [00:03<00:02, 31612911.74it/s] 48%|████▊     | 80347136/169001437 [00:03<00:02, 31559954.12it/s] 49%|████▉     | 83525632/169001437 [00:03<00:03, 28328829.96it/s] 51%|█████▏    | 86769664/169001437 [00:04<00:02, 29459437.31it/s] 53%|█████▎    | 90046464/169001437 [00:04<00:02, 30260994.81it/s] 55%|█████▌    | 93290496/169001437 [00:04<00:02, 30858472.22it/s] 57%|█████▋    | 96468992/169001437 [00:04<00:02, 31068332.60it/s] 59%|█████▉    | 99614720/169001437 [00:04<00:02, 29997616.10it/s] 61%|██████    | 102891520/169001437 [00:04<00:02, 30315132.66it/s] 63%|██████▎   | 106135552/169001437 [00:04<00:02, 30205567.69it/s] 65%|██████▍   | 109412352/169001437 [00:04<00:01, 30900252.30it/s] 67%|██████▋   | 112558080/169001437 [00:04<00:01, 30954560.88it/s] 69%|██████▊   | 115834880/169001437 [00:04<00:01, 31466282.73it/s] 70%|███████   | 119013376/169001437 [00:05<00:01, 31517239.60it/s] 72%|███████▏  | 122191872/169001437 [00:05<00:01, 31407749.98it/s] 74%|███████▍  | 125337600/169001437 [00:05<00:01, 31264786.23it/s] 76%|███████▌  | 128483328/169001437 [00:05<00:01, 31187955.61it/s] 78%|███████▊  | 131629056/169001437 [00:05<00:01, 31093735.04it/s] 80%|███████▉  | 134774784/169001437 [00:05<00:01, 31039825.25it/s] 82%|████████▏ | 137887744/169001437 [00:05<00:01, 30946860.51it/s] 83%|████████▎ | 141000704/169001437 [00:05<00:00, 30872555.02it/s] 85%|████████▌ | 144211968/169001437 [00:05<00:00, 31028611.27it/s] 87%|████████▋ | 147456000/169001437 [00:05<00:00, 31228908.10it/s] 89%|████████▉ | 150601728/169001437 [00:06<00:00, 31012677.06it/s] 91%|█████████ | 153845760/169001437 [00:06<00:00, 30454853.48it/s] 93%|█████████▎| 157057024/169001437 [00:06<00:00, 30935239.38it/s] 95%|█████████▍| 160268288/169001437 [00:06<00:00, 31279955.08it/s] 97%|█████████▋| 163414016/169001437 [00:06<00:00, 31191852.11it/s] 99%|█████████▊| 166559744/169001437 [00:06<00:00, 31159708.80it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 25265105.30it/s]
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck',
 'This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:06<08:37,  6.64s/it]  3%|▎         | 2/79 [00:06<03:41,  2.88s/it]  4%|▍         | 3/79 [00:07<02:07,  1.68s/it]  5%|▌         | 4/79 [00:07<01:24,  1.12s/it]  6%|▋         | 5/79 [00:07<01:00,  1.22it/s]  8%|▊         | 6/79 [00:08<00:47,  1.54it/s]  9%|▉         | 7/79 [00:08<00:37,  1.90it/s] 10%|█         | 8/79 [00:08<00:33,  2.14it/s] 11%|█▏        | 9/79 [00:08<00:27,  2.51it/s] 13%|█▎        | 10/79 [00:09<00:26,  2.64it/s] 14%|█▍        | 11/79 [00:09<00:23,  2.95it/s] 15%|█▌        | 12/79 [00:09<00:20,  3.20it/s] 16%|█▋        | 13/79 [00:09<00:19,  3.40it/s] 18%|█▊        | 14/79 [00:10<00:18,  3.56it/s] 19%|█▉        | 15/79 [00:10<00:18,  3.44it/s] 20%|██        | 16/79 [00:10<00:18,  3.40it/s] 22%|██▏       | 17/79 [00:11<00:17,  3.53it/s] 23%|██▎       | 18/79 [00:11<00:16,  3.60it/s] 24%|██▍       | 19/79 [00:11<00:18,  3.29it/s] 25%|██▌       | 20/79 [00:11<00:17,  3.35it/s] 27%|██▋       | 21/79 [00:12<00:16,  3.53it/s] 28%|██▊       | 22/79 [00:12<00:15,  3.65it/s] 29%|██▉       | 23/79 [00:12<00:16,  3.42it/s] 30%|███       | 24/79 [00:13<00:15,  3.57it/s] 32%|███▏      | 25/79 [00:13<00:14,  3.61it/s] 33%|███▎      | 26/79 [00:13<00:14,  3.59it/s] 34%|███▍      | 27/79 [00:13<00:14,  3.60it/s] 35%|███▌      | 28/79 [00:14<00:14,  3.54it/s] 37%|███▋      | 29/79 [00:14<00:14,  3.57it/s] 38%|███▊      | 30/79 [00:14<00:13,  3.70it/s] 39%|███▉      | 31/79 [00:14<00:12,  3.77it/s] 41%|████      | 32/79 [00:15<00:12,  3.83it/s] 42%|████▏     | 33/79 [00:15<00:11,  3.88it/s] 43%|████▎     | 34/79 [00:15<00:11,  3.90it/s] 44%|████▍     | 35/79 [00:16<00:12,  3.53it/s] 46%|████▌     | 36/79 [00:16<00:13,  3.20it/s] 47%|████▋     | 37/79 [00:16<00:12,  3.40it/s] 48%|████▊     | 38/79 [00:16<00:11,  3.55it/s] 49%|████▉     | 39/79 [00:17<00:10,  3.67it/s] 51%|█████     | 40/79 [00:17<00:10,  3.60it/s] 52%|█████▏    | 41/79 [00:17<00:11,  3.35it/s] 53%|█████▎    | 42/79 [00:18<00:10,  3.44it/s] 54%|█████▍    | 43/79 [00:18<00:10,  3.59it/s] 56%|█████▌    | 44/79 [00:18<00:09,  3.67it/s] 57%|█████▋    | 45/79 [00:19<00:10,  3.31it/s] 58%|█████▊    | 46/79 [00:19<00:09,  3.36it/s] 59%|█████▉    | 47/79 [00:19<00:09,  3.51it/s] 61%|██████    | 48/79 [00:19<00:08,  3.63it/s] 62%|██████▏   | 49/79 [00:20<00:07,  3.76it/s] 63%|██████▎   | 50/79 [00:20<00:07,  3.84it/s] 65%|██████▍   | 51/79 [00:20<00:07,  3.91it/s] 66%|██████▌   | 52/79 [00:20<00:06,  3.96it/s] 67%|██████▋   | 53/79 [00:21<00:06,  4.00it/s] 68%|██████▊   | 54/79 [00:21<00:06,  4.03it/s] 70%|██████▉   | 55/79 [00:21<00:05,  4.05it/s] 71%|███████   | 56/79 [00:21<00:05,  4.06it/s] 72%|███████▏  | 57/79 [00:22<00:05,  4.05it/s] 73%|███████▎  | 58/79 [00:22<00:05,  4.07it/s] 75%|███████▍  | 59/79 [00:22<00:04,  4.08it/s] 76%|███████▌  | 60/79 [00:22<00:04,  4.09it/s] 77%|███████▋  | 61/79 [00:22<00:04,  4.09it/s] 78%|███████▊  | 62/79 [00:23<00:04,  4.07it/s] 80%|███████▉  | 63/79 [00:23<00:03,  4.06it/s] 81%|████████  | 64/79 [00:23<00:03,  4.06it/s] 82%|████████▏ | 65/79 [00:23<00:03,  4.07it/s] 84%|████████▎ | 66/79 [00:24<00:03,  4.09it/s] 85%|████████▍ | 67/79 [00:24<00:02,  4.09it/s] 86%|████████▌ | 68/79 [00:24<00:02,  4.09it/s] 87%|████████▋ | 69/79 [00:24<00:02,  4.09it/s] 89%|████████▊ | 70/79 [00:25<00:02,  4.08it/s] 90%|████████▉ | 71/79 [00:25<00:01,  4.08it/s] 91%|█████████ | 72/79 [00:25<00:01,  4.09it/s] 92%|█████████▏| 73/79 [00:25<00:01,  4.09it/s] 94%|█████████▎| 74/79 [00:26<00:01,  4.10it/s] 95%|█████████▍| 75/79 [00:26<00:00,  4.08it/s] 96%|█████████▌| 76/79 [00:26<00:00,  4.08it/s] 97%|█████████▋| 77/79 [00:26<00:00,  4.07it/s] 99%|█████████▊| 78/79 [00:27<00:00,  4.06it/s]100%|██████████| 79/79 [00:27<00:00,  2.88it/s]
Validate: [ 0/79]	Time  6.640 ( 6.640)	Loss 8.1250e+00 (8.1250e+00)	Prompt Acc@1  71.88 ( 71.88)
Validate: [10/79]	Time  0.250 ( 0.860)	Loss 5.7578e+00 (7.3146e+00)	Prompt Acc@1  79.69 ( 75.28)
Validate: [20/79]	Time  0.249 ( 0.583)	Loss 8.4688e+00 (7.8850e+00)	Prompt Acc@1  75.00 ( 74.93)
Validate: [30/79]	Time  0.253 ( 0.483)	Loss 7.6523e+00 (7.9888e+00)	Prompt Acc@1  79.69 ( 74.40)
Validate: [40/79]	Time  0.347 ( 0.435)	Loss 1.1211e+01 (7.9806e+00)	Prompt Acc@1  67.97 ( 74.16)
Validate: [50/79]	Time  0.246 ( 0.403)	Loss 7.6875e+00 (8.1187e+00)	Prompt Acc@1  75.00 ( 73.74)
Validate: [60/79]	Time  0.244 ( 0.377)	Loss 9.5391e+00 (8.0339e+00)	Prompt Acc@1  72.66 ( 73.74)
Validate: [70/79]	Time  0.244 ( 0.358)	Loss 7.9688e+00 (8.1042e+00)	Prompt Acc@1  75.78 ( 73.50)
 * Prompt Acc@1 73.550
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:03<05:09,  3.97s/it]  3%|▎         | 2/79 [00:04<02:35,  2.02s/it]  4%|▍         | 3/79 [00:05<01:47,  1.41s/it]  5%|▌         | 4/79 [00:05<01:23,  1.11s/it]  6%|▋         | 5/79 [00:06<01:07,  1.09it/s]  8%|▊         | 6/79 [00:06<00:54,  1.33it/s]  9%|▉         | 7/79 [00:07<00:44,  1.61it/s] 10%|█         | 8/79 [00:07<00:38,  1.84it/s] 11%|█▏        | 9/79 [00:07<00:31,  2.21it/s] 13%|█▎        | 10/79 [00:08<00:27,  2.55it/s] 14%|█▍        | 11/79 [00:08<00:23,  2.86it/s] 15%|█▌        | 12/79 [00:08<00:23,  2.88it/s] 16%|█▋        | 13/79 [00:09<00:22,  2.91it/s] 18%|█▊        | 14/79 [00:09<00:20,  3.15it/s] 19%|█▉        | 15/79 [00:09<00:19,  3.22it/s] 20%|██        | 16/79 [00:09<00:19,  3.26it/s] 22%|██▏       | 17/79 [00:10<00:19,  3.22it/s] 23%|██▎       | 18/79 [00:10<00:17,  3.41it/s] 24%|██▍       | 19/79 [00:10<00:16,  3.56it/s] 25%|██▌       | 20/79 [00:11<00:16,  3.68it/s] 27%|██▋       | 21/79 [00:11<00:15,  3.67it/s] 28%|██▊       | 22/79 [00:11<00:15,  3.74it/s] 29%|██▉       | 23/79 [00:11<00:14,  3.79it/s] 30%|███       | 24/79 [00:12<00:14,  3.70it/s] 32%|███▏      | 25/79 [00:12<00:14,  3.75it/s] 33%|███▎      | 26/79 [00:12<00:15,  3.50it/s] 34%|███▍      | 27/79 [00:12<00:14,  3.64it/s] 35%|███▌      | 28/79 [00:13<00:14,  3.42it/s] 37%|███▋      | 29/79 [00:13<00:13,  3.57it/s] 38%|███▊      | 30/79 [00:13<00:13,  3.70it/s] 39%|███▉      | 31/79 [00:14<00:13,  3.45it/s] 41%|████      | 32/79 [00:14<00:13,  3.60it/s] 42%|████▏     | 33/79 [00:14<00:12,  3.68it/s] 43%|████▎     | 34/79 [00:14<00:11,  3.77it/s] 44%|████▍     | 35/79 [00:15<00:12,  3.66it/s] 46%|████▌     | 36/79 [00:15<00:11,  3.74it/s] 47%|████▋     | 37/79 [00:15<00:11,  3.65it/s] 48%|████▊     | 38/79 [00:16<00:11,  3.60it/s] 49%|████▉     | 39/79 [00:16<00:10,  3.68it/s] 51%|█████     | 40/79 [00:16<00:10,  3.76it/s] 52%|█████▏    | 41/79 [00:16<00:10,  3.77it/s] 53%|█████▎    | 42/79 [00:17<00:10,  3.46it/s] 54%|█████▍    | 43/79 [00:17<00:10,  3.40it/s] 56%|█████▌    | 44/79 [00:17<00:09,  3.53it/s] 57%|█████▋    | 45/79 [00:17<00:09,  3.51it/s] 58%|█████▊    | 46/79 [00:18<00:09,  3.52it/s] 59%|█████▉    | 47/79 [00:18<00:09,  3.51it/s] 61%|██████    | 48/79 [00:18<00:08,  3.66it/s] 62%|██████▏   | 49/79 [00:19<00:07,  3.77it/s] 63%|██████▎   | 50/79 [00:19<00:07,  3.86it/s] 65%|██████▍   | 51/79 [00:19<00:07,  3.92it/s] 66%|██████▌   | 52/79 [00:19<00:06,  3.96it/s] 67%|██████▋   | 53/79 [00:20<00:06,  3.99it/s] 68%|██████▊   | 54/79 [00:20<00:06,  4.03it/s] 70%|██████▉   | 55/79 [00:20<00:05,  4.04it/s] 71%|███████   | 56/79 [00:20<00:05,  4.02it/s] 72%|███████▏  | 57/79 [00:21<00:05,  4.02it/s] 73%|███████▎  | 58/79 [00:21<00:05,  4.03it/s] 75%|███████▍  | 59/79 [00:21<00:04,  4.03it/s] 76%|███████▌  | 60/79 [00:21<00:04,  4.06it/s] 77%|███████▋  | 61/79 [00:21<00:04,  4.08it/s] 78%|███████▊  | 62/79 [00:22<00:04,  4.08it/s] 80%|███████▉  | 63/79 [00:22<00:03,  4.09it/s] 81%|████████  | 64/79 [00:22<00:03,  4.09it/s] 82%|████████▏ | 65/79 [00:22<00:03,  4.08it/s] 84%|████████▎ | 66/79 [00:23<00:03,  4.08it/s] 85%|████████▍ | 67/79 [00:23<00:02,  4.07it/s] 86%|████████▌ | 68/79 [00:23<00:02,  4.09it/s] 87%|████████▋ | 69/79 [00:23<00:02,  4.09it/s] 89%|████████▊ | 70/79 [00:24<00:02,  4.09it/s] 90%|████████▉ | 71/79 [00:24<00:01,  4.09it/s] 91%|█████████ | 72/79 [00:24<00:01,  4.10it/s] 92%|█████████▏| 73/79 [00:24<00:01,  4.09it/s] 94%|█████████▎| 74/79 [00:25<00:01,  4.09it/s] 95%|█████████▍| 75/79 [00:25<00:00,  4.10it/s] 96%|█████████▌| 76/79 [00:25<00:00,  4.09it/s] 97%|█████████▋| 77/79 [00:25<00:00,  4.09it/s] 99%|█████████▊| 78/79 [00:26<00:00,  4.08it/s]100%|██████████| 79/79 [00:26<00:00,  2.99it/s]
Validate: [ 0/79]	Time  3.973 ( 3.973)	Loss 6.0656e+01 (6.0656e+01)	Prompt Acc@1   0.00 (  0.00)
Validate: [10/79]	Time  0.252 ( 0.768)	Loss 5.5969e+01 (5.6222e+01)	Prompt Acc@1   0.78 (  0.36)
Validate: [20/79]	Time  0.275 ( 0.539)	Loss 5.2688e+01 (5.6234e+01)	Prompt Acc@1   0.00 (  0.30)
Validate: [30/79]	Time  0.334 ( 0.456)	Loss 5.5406e+01 (5.6230e+01)	Prompt Acc@1   0.00 (  0.30)
Validate: [40/79]	Time  0.264 ( 0.409)	Loss 5.7562e+01 (5.5986e+01)	Prompt Acc@1   0.78 (  0.30)
Validate: [50/79]	Time  0.246 ( 0.383)	Loss 5.6531e+01 (5.6206e+01)	Prompt Acc@1   0.00 (  0.29)
Validate: [60/79]	Time  0.242 ( 0.361)	Loss 5.2719e+01 (5.6354e+01)	Prompt Acc@1   0.78 (  0.31)
Validate: [70/79]	Time  0.245 ( 0.344)	Loss 5.1625e+01 (5.6426e+01)	Prompt Acc@1   0.00 (  0.32)
 * Prompt Acc@1 0.320
TOP1 Accuracy on cifar10 + cifar100 is: 36.934999999999995
