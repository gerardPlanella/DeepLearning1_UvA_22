Running experiment on cifar10 with random_patch and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=16, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', root='/scratch/lcur0640', dataset='cifar10', image_size=224, test_noise=False, visualize_prompt=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume='.//save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar', evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:31, 333365.16it/s]  0%|          | 131072/170498071 [00:00<07:03, 402279.80it/s]  0%|          | 229376/170498071 [00:00<05:36, 505289.11it/s]  0%|          | 491520/170498071 [00:00<02:48, 1006752.57it/s]  1%|          | 1114112/170498071 [00:00<01:09, 2424047.96it/s]  1%|▏         | 2293760/170498071 [00:00<00:33, 5039546.18it/s]  2%|▏         | 3997696/170498071 [00:00<00:21, 7581543.88it/s]  3%|▎         | 5734400/170498071 [00:01<00:16, 10194528.98it/s]  4%|▍         | 7569408/170498071 [00:01<00:13, 12231698.40it/s]  6%|▌         | 9666560/170498071 [00:01<00:10, 14669891.39it/s]  7%|▋         | 11829248/170498071 [00:01<00:09, 16651472.30it/s]  8%|▊         | 14155776/170498071 [00:01<00:08, 18550106.02it/s] 10%|▉         | 16678912/170498071 [00:01<00:07, 20499572.13it/s] 11%|█▏        | 19300352/170498071 [00:01<00:06, 22176799.67it/s] 13%|█▎        | 21921792/170498071 [00:01<00:06, 21593030.72it/s] 14%|█▍        | 24576000/170498071 [00:01<00:06, 22929809.22it/s] 16%|█▌        | 27426816/170498071 [00:02<00:05, 24519260.20it/s] 18%|█▊        | 30375936/170498071 [00:02<00:05, 25887451.89it/s] 20%|█▉        | 33521664/170498071 [00:02<00:04, 27490290.11it/s] 22%|██▏       | 36700160/170498071 [00:02<00:04, 28642010.83it/s] 23%|██▎       | 39944192/170498071 [00:02<00:04, 29635789.20it/s] 25%|██▌       | 43188224/170498071 [00:02<00:04, 30293513.93it/s] 27%|██▋       | 46399488/170498071 [00:02<00:04, 30735457.87it/s] 29%|██▉       | 49577984/170498071 [00:02<00:03, 31029106.98it/s] 31%|███       | 52690944/170498071 [00:02<00:04, 28999296.00it/s] 33%|███▎      | 55803904/170498071 [00:02<00:03, 29518937.35it/s] 34%|███▍      | 58785792/170498071 [00:03<00:03, 29512536.60it/s] 36%|███▌      | 61767680/170498071 [00:03<00:03, 29301402.47it/s] 38%|███▊      | 64946176/170498071 [00:03<00:03, 30021625.84it/s] 40%|███▉      | 68091904/170498071 [00:03<00:03, 30140536.60it/s] 42%|████▏     | 71237632/170498071 [00:03<00:03, 30274552.00it/s] 44%|████▎     | 74416128/170498071 [00:03<00:03, 30348024.42it/s] 46%|████▌     | 77660160/170498071 [00:03<00:03, 30895823.03it/s] 47%|████▋     | 80773120/170498071 [00:03<00:02, 30856043.07it/s] 49%|████▉     | 83918848/170498071 [00:03<00:02, 30832456.96it/s] 51%|█████     | 87195648/170498071 [00:03<00:02, 31322759.54it/s] 53%|█████▎    | 90439680/170498071 [00:04<00:02, 31367561.16it/s] 55%|█████▍    | 93585408/170498071 [00:04<00:02, 30966296.75it/s] 57%|█████▋    | 96731136/170498071 [00:04<00:02, 30341806.02it/s] 59%|█████▊    | 99844096/170498071 [00:04<00:02, 30044291.79it/s] 60%|██████    | 103055360/170498071 [00:04<00:02, 30436585.69it/s] 62%|██████▏   | 106233856/170498071 [00:04<00:02, 30635367.73it/s] 64%|██████▍   | 109445120/170498071 [00:04<00:01, 30876940.18it/s] 66%|██████▌   | 112623616/170498071 [00:04<00:01, 30964238.62it/s] 68%|██████▊   | 115867648/170498071 [00:04<00:01, 31388338.76it/s] 70%|██████▉   | 119078912/170498071 [00:04<00:01, 31248726.98it/s] 72%|███████▏  | 122224640/170498071 [00:05<00:01, 31298570.43it/s] 74%|███████▎  | 125435904/170498071 [00:05<00:01, 31521715.60it/s] 75%|███████▌  | 128679936/170498071 [00:05<00:01, 31786897.27it/s] 77%|███████▋  | 131891200/170498071 [00:05<00:01, 31361134.97it/s] 79%|███████▉  | 135036928/170498071 [00:05<00:01, 31152830.92it/s] 81%|████████  | 138182656/170498071 [00:05<00:01, 31098378.83it/s] 83%|████████▎ | 141426688/170498071 [00:05<00:00, 31484915.53it/s] 85%|████████▍ | 144605184/170498071 [00:05<00:00, 31512764.94it/s] 87%|████████▋ | 147783680/170498071 [00:05<00:00, 31385850.94it/s] 89%|████████▊ | 150929408/170498071 [00:06<00:00, 31326468.70it/s] 90%|█████████ | 154140672/170498071 [00:06<00:00, 31369057.70it/s] 92%|█████████▏| 157286400/170498071 [00:06<00:00, 31323133.00it/s] 94%|█████████▍| 160530432/170498071 [00:06<00:00, 31099555.29it/s] 96%|█████████▌| 163741696/170498071 [00:06<00:00, 31394305.00it/s] 98%|█████████▊| 166952960/170498071 [00:06<00:00, 30999487.54it/s]100%|█████████▉| 170098688/170498071 [00:06<00:00, 30390610.14it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25636309.12it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  0%|                                      | 1.08M/338M [00:00<00:31, 11.1MiB/s]  1%|▏                                     | 2.17M/338M [00:00<00:31, 11.1MiB/s]  1%|▎                                     | 3.28M/338M [00:00<00:31, 11.1MiB/s]  1%|▌                                     | 4.52M/338M [00:00<00:29, 11.7MiB/s]  2%|▋                                     | 5.88M/338M [00:00<00:27, 12.4MiB/s]  2%|▊                                     | 7.38M/338M [00:00<00:25, 13.4MiB/s]  3%|▉                                     | 8.66M/338M [00:00<00:26, 13.2MiB/s]  3%|█                                     | 9.91M/338M [00:00<00:26, 13.0MiB/s]  3%|█▎                                    | 11.2M/338M [00:00<00:26, 13.1MiB/s]  4%|█▍                                    | 12.7M/338M [00:01<00:24, 13.8MiB/s]  4%|█▌                                    | 14.4M/338M [00:01<00:23, 14.6MiB/s]  5%|█▊                                    | 16.1M/338M [00:01<00:21, 15.6MiB/s]  5%|██                                    | 18.0M/338M [00:01<00:20, 16.6MiB/s]  6%|██▏                                   | 19.6M/338M [00:01<00:20, 16.4MiB/s]  6%|██▍                                   | 21.2M/338M [00:01<00:23, 14.2MiB/s]  7%|██▌                                   | 22.6M/338M [00:01<00:25, 13.2MiB/s]  7%|██▋                                   | 23.9M/338M [00:01<00:25, 12.9MiB/s]  7%|██▊                                   | 25.2M/338M [00:01<00:26, 12.2MiB/s]  8%|██▉                                   | 26.4M/338M [00:02<00:28, 11.5MiB/s]  8%|███                                   | 27.5M/338M [00:02<00:28, 11.5MiB/s]  9%|███▏                                  | 28.7M/338M [00:02<00:27, 11.8MiB/s]  9%|███▎                                  | 29.9M/338M [00:02<00:28, 11.4MiB/s]  9%|███▍                                  | 31.0M/338M [00:02<00:29, 10.8MiB/s]  9%|███▌                                  | 32.0M/338M [00:02<00:29, 10.8MiB/s] 10%|███▋                                  | 33.2M/338M [00:02<00:28, 11.1MiB/s] 10%|███▊                                  | 34.2M/338M [00:02<00:30, 10.4MiB/s] 10%|███▉                                  | 35.2M/338M [00:02<00:31, 10.1MiB/s] 11%|████                                  | 36.3M/338M [00:03<00:31, 10.1MiB/s] 11%|████▏                                 | 37.4M/338M [00:03<00:29, 10.7MiB/s] 11%|████▎                                 | 38.7M/338M [00:03<00:28, 10.8MiB/s] 12%|████▍                                 | 39.8M/338M [00:03<00:29, 10.7MiB/s] 12%|████▌                                 | 40.9M/338M [00:03<00:28, 11.0MiB/s] 12%|████▋                                 | 42.0M/338M [00:03<00:28, 11.0MiB/s] 13%|████▊                                 | 43.1M/338M [00:03<00:28, 10.7MiB/s] 13%|████▉                                 | 44.1M/338M [00:03<00:29, 10.4MiB/s] 13%|█████                                 | 45.2M/338M [00:03<00:28, 10.6MiB/s] 14%|█████▏                                | 46.4M/338M [00:04<00:27, 11.3MiB/s] 14%|█████▎                                | 47.5M/338M [00:04<00:27, 11.1MiB/s] 14%|█████▍                                | 48.6M/338M [00:04<00:27, 10.9MiB/s] 15%|█████▌                                | 49.7M/338M [00:04<00:26, 11.3MiB/s] 15%|█████▋                                | 51.0M/338M [00:04<00:25, 11.8MiB/s] 16%|█████▉                                | 52.4M/338M [00:04<00:23, 12.6MiB/s] 16%|██████                                | 54.0M/338M [00:04<00:21, 13.5MiB/s] 16%|██████▏                               | 55.3M/338M [00:04<00:22, 13.4MiB/s] 17%|██████▎                               | 56.6M/338M [00:04<00:22, 13.3MiB/s] 17%|██████▌                               | 57.9M/338M [00:04<00:21, 13.4MiB/s] 18%|██████▋                               | 59.2M/338M [00:05<00:23, 12.4MiB/s] 18%|██████▊                               | 60.4M/338M [00:05<00:24, 11.8MiB/s] 18%|██████▉                               | 61.5M/338M [00:05<00:24, 11.8MiB/s] 19%|███████                               | 62.8M/338M [00:05<00:23, 12.2MiB/s] 19%|███████▏                              | 64.3M/338M [00:05<00:22, 12.9MiB/s] 20%|███████▍                              | 65.9M/338M [00:05<00:20, 13.9MiB/s] 20%|███████▌                              | 67.6M/338M [00:05<00:18, 14.9MiB/s] 20%|███████▊                              | 69.0M/338M [00:05<00:19, 14.4MiB/s] 21%|███████▉                              | 70.4M/338M [00:06<00:22, 12.3MiB/s] 21%|████████                              | 71.6M/338M [00:06<00:23, 11.9MiB/s] 22%|████████▏                             | 72.8M/338M [00:06<00:23, 11.9MiB/s] 22%|████████▎                             | 74.0M/338M [00:06<00:24, 11.1MiB/s] 22%|████████▍                             | 75.0M/338M [00:06<00:24, 11.1MiB/s] 23%|████████▌                             | 76.1M/338M [00:06<00:24, 11.1MiB/s] 23%|████████▋                             | 77.5M/338M [00:06<00:23, 11.8MiB/s] 23%|████████▉                             | 78.9M/338M [00:06<00:21, 12.6MiB/s] 24%|█████████                             | 80.1M/338M [00:06<00:22, 12.2MiB/s] 24%|█████████▏                            | 81.3M/338M [00:07<00:22, 12.1MiB/s] 24%|█████████▎                            | 82.6M/338M [00:07<00:21, 12.4MiB/s] 25%|█████████▍                            | 84.0M/338M [00:07<00:20, 13.1MiB/s] 25%|█████████▋                            | 85.5M/338M [00:07<00:19, 13.8MiB/s] 26%|█████████▊                            | 87.2M/338M [00:07<00:18, 14.3MiB/s] 26%|█████████▉                            | 88.5M/338M [00:07<00:21, 12.3MiB/s] 27%|██████████                            | 89.8M/338M [00:07<00:22, 11.6MiB/s] 27%|██████████▏                           | 90.9M/338M [00:07<00:22, 11.4MiB/s] 27%|██████████▎                           | 92.0M/338M [00:07<00:23, 10.9MiB/s] 28%|██████████▍                           | 93.1M/338M [00:08<00:25, 10.2MiB/s] 28%|██████████▌                           | 94.0M/338M [00:08<00:25, 10.1MiB/s] 28%|██████████▋                           | 95.1M/338M [00:08<00:24, 10.3MiB/s] 29%|██████████▊                           | 96.4M/338M [00:08<00:23, 11.0MiB/s] 29%|██████████▉                           | 97.5M/338M [00:08<00:22, 11.1MiB/s] 29%|███████████                           | 98.6M/338M [00:08<00:22, 11.0MiB/s] 30%|███████████▏                          | 99.7M/338M [00:08<00:23, 10.8MiB/s] 30%|███████████▋                           | 101M/338M [00:08<00:23, 10.5MiB/s] 30%|███████████▊                           | 102M/338M [00:08<00:24, 9.99MiB/s] 30%|███████████▊                           | 103M/338M [00:09<00:24, 10.1MiB/s] 31%|████████████                           | 104M/338M [00:09<00:22, 10.7MiB/s] 31%|████████████▏                          | 105M/338M [00:09<00:21, 11.3MiB/s] 32%|████████████▎                          | 106M/338M [00:09<00:22, 11.0MiB/s] 32%|████████████▍                          | 107M/338M [00:09<00:21, 11.1MiB/s] 32%|████████████▌                          | 109M/338M [00:09<00:21, 11.0MiB/s] 32%|████████████▋                          | 110M/338M [00:09<00:23, 10.2MiB/s] 33%|████████████▊                          | 111M/338M [00:09<00:23, 10.2MiB/s] 33%|████████████▉                          | 112M/338M [00:09<00:22, 10.6MiB/s] 33%|█████████████                          | 113M/338M [00:09<00:21, 11.2MiB/s] 34%|█████████████▏                         | 114M/338M [00:10<00:19, 12.1MiB/s] 34%|█████████████▍                         | 116M/338M [00:10<00:17, 13.1MiB/s] 35%|█████████████▌                         | 117M/338M [00:10<00:18, 12.7MiB/s] 35%|█████████████▋                         | 118M/338M [00:10<00:18, 12.6MiB/s] 35%|█████████████▊                         | 120M/338M [00:10<00:17, 12.8MiB/s] 36%|█████████████▉                         | 121M/338M [00:10<00:17, 12.9MiB/s] 36%|██████████████                         | 122M/338M [00:10<00:18, 12.5MiB/s] 37%|██████████████▎                        | 123M/338M [00:10<00:18, 12.1MiB/s] 37%|██████████████▍                        | 125M/338M [00:10<00:19, 11.7MiB/s] 37%|██████████████▌                        | 126M/338M [00:11<00:20, 10.8MiB/s] 38%|██████████████▋                        | 127M/338M [00:11<00:21, 10.3MiB/s] 38%|██████████████▊                        | 128M/338M [00:11<00:20, 10.5MiB/s] 38%|██████████████▉                        | 129M/338M [00:11<00:20, 10.5MiB/s] 38%|███████████████                        | 130M/338M [00:11<00:21, 9.96MiB/s] 39%|███████████████                        | 131M/338M [00:11<00:21, 9.90MiB/s] 39%|███████████████▏                       | 132M/338M [00:11<00:21, 9.95MiB/s] 39%|███████████████▎                       | 133M/338M [00:11<00:20, 10.6MiB/s] 40%|███████████████▍                       | 134M/338M [00:11<00:20, 10.6MiB/s] 40%|███████████████▌                       | 135M/338M [00:12<00:20, 10.5MiB/s] 40%|███████████████▋                       | 136M/338M [00:12<00:19, 10.9MiB/s] 41%|███████████████▊                       | 137M/338M [00:12<00:19, 10.8MiB/s] 41%|███████████████▉                       | 138M/338M [00:12<00:19, 10.7MiB/s] 41%|████████████████                       | 139M/338M [00:12<00:20, 10.4MiB/s] 42%|████████████████▏                      | 140M/338M [00:12<00:19, 10.6MiB/s] 42%|████████████████▎                      | 142M/338M [00:12<00:20, 10.2MiB/s] 42%|████████████████▍                      | 142M/338M [00:12<00:20, 9.84MiB/s] 42%|████████████████▌                      | 143M/338M [00:12<00:20, 9.77MiB/s] 43%|████████████████▋                      | 144M/338M [00:13<00:20, 9.93MiB/s] 43%|████████████████▊                      | 146M/338M [00:13<00:18, 10.6MiB/s] 44%|████████████████▉                      | 147M/338M [00:13<00:17, 11.6MiB/s] 44%|█████████████████                      | 148M/338M [00:13<00:16, 11.8MiB/s] 44%|█████████████████▎                     | 149M/338M [00:13<00:16, 11.7MiB/s] 45%|█████████████████▍                     | 151M/338M [00:13<00:16, 11.9MiB/s] 45%|█████████████████▌                     | 152M/338M [00:13<00:17, 11.4MiB/s] 45%|█████████████████▋                     | 153M/338M [00:13<00:17, 10.8MiB/s] 46%|█████████████████▊                     | 154M/338M [00:13<00:17, 10.8MiB/s] 46%|█████████████████▉                     | 155M/338M [00:13<00:17, 11.0MiB/s] 46%|██████████████████                     | 156M/338M [00:14<00:17, 10.6MiB/s] 47%|██████████████████▏                    | 157M/338M [00:14<00:18, 10.3MiB/s] 47%|██████████████████▎                    | 158M/338M [00:14<00:18, 10.4MiB/s] 47%|██████████████████▍                    | 159M/338M [00:14<00:17, 10.9MiB/s] 48%|██████████████████▌                    | 161M/338M [00:14<00:16, 11.5MiB/s] 48%|██████████████████▋                    | 162M/338M [00:14<00:15, 11.8MiB/s] 48%|██████████████████▊                    | 163M/338M [00:14<00:15, 11.7MiB/s] 49%|██████████████████▉                    | 164M/338M [00:14<00:15, 11.5MiB/s] 49%|███████████████████                    | 165M/338M [00:14<00:16, 10.7MiB/s] 49%|███████████████████▏                   | 166M/338M [00:15<00:17, 10.3MiB/s] 50%|███████████████████▎                   | 167M/338M [00:15<00:16, 10.6MiB/s] 50%|███████████████████▍                   | 168M/338M [00:15<00:17, 10.2MiB/s] 50%|███████████████████▌                   | 169M/338M [00:15<00:18, 9.67MiB/s] 50%|███████████████████▋                   | 170M/338M [00:15<00:17, 9.78MiB/s] 51%|███████████████████▊                   | 171M/338M [00:15<00:17, 9.79MiB/s] 51%|███████████████████▉                   | 172M/338M [00:15<00:18, 9.49MiB/s] 51%|████████████████████                   | 173M/338M [00:15<00:18, 9.22MiB/s] 52%|████████████████████                   | 174M/338M [00:15<00:18, 9.42MiB/s] 52%|████████████████████▏                  | 175M/338M [00:16<00:16, 10.0MiB/s] 52%|████████████████████▍                  | 177M/338M [00:16<00:15, 10.8MiB/s] 53%|████████████████████▌                  | 178M/338M [00:16<00:14, 11.8MiB/s] 53%|████████████████████▋                  | 179M/338M [00:16<00:12, 12.9MiB/s] 54%|████████████████████▉                  | 181M/338M [00:16<00:12, 13.3MiB/s] 54%|█████████████████████                  | 182M/338M [00:16<00:12, 13.2MiB/s] 54%|█████████████████████▏                 | 183M/338M [00:16<00:12, 13.1MiB/s] 55%|█████████████████████▎                 | 185M/338M [00:16<00:11, 13.4MiB/s] 55%|█████████████████████▌                 | 186M/338M [00:16<00:11, 14.0MiB/s] 56%|█████████████████████▋                 | 188M/338M [00:16<00:10, 15.0MiB/s] 56%|█████████████████████▉                 | 190M/338M [00:17<00:09, 16.0MiB/s] 57%|██████████████████████                 | 191M/338M [00:17<00:11, 13.5MiB/s] 57%|██████████████████████▎                | 193M/338M [00:17<00:12, 12.5MiB/s] 57%|██████████████████████▍                | 194M/338M [00:17<00:12, 12.3MiB/s] 58%|██████████████████████▌                | 195M/338M [00:17<00:13, 11.2MiB/s] 58%|██████████████████████▋                | 196M/338M [00:17<00:13, 10.7MiB/s] 58%|██████████████████████▊                | 197M/338M [00:17<00:13, 10.7MiB/s] 59%|██████████████████████▉                | 198M/338M [00:17<00:13, 11.0MiB/s] 59%|███████████████████████                | 200M/338M [00:18<00:12, 11.6MiB/s] 60%|███████████████████████▏               | 201M/338M [00:18<00:11, 12.0MiB/s] 60%|███████████████████████▎               | 202M/338M [00:18<00:11, 11.9MiB/s] 60%|███████████████████████▌               | 203M/338M [00:18<00:11, 11.9MiB/s] 61%|███████████████████████▋               | 205M/338M [00:18<00:11, 12.6MiB/s] 61%|███████████████████████▊               | 206M/338M [00:18<00:10, 13.3MiB/s] 62%|███████████████████████▉               | 208M/338M [00:18<00:10, 12.9MiB/s] 62%|████████████████████████▏              | 209M/338M [00:18<00:12, 11.2MiB/s] 62%|████████████████████████▎              | 210M/338M [00:18<00:12, 10.7MiB/s] 63%|████████████████████████▍              | 211M/338M [00:19<00:12, 10.7MiB/s] 63%|████████████████████████▍              | 212M/338M [00:19<00:13, 10.0MiB/s] 63%|████████████████████████▌              | 213M/338M [00:19<00:13, 9.76MiB/s] 63%|████████████████████████▋              | 214M/338M [00:19<00:13, 9.77MiB/s] 64%|████████████████████████▊              | 215M/338M [00:19<00:12, 10.2MiB/s] 64%|████████████████████████▉              | 216M/338M [00:19<00:11, 10.9MiB/s] 64%|█████████████████████████▏             | 218M/338M [00:19<00:10, 11.7MiB/s] 65%|█████████████████████████▎             | 219M/338M [00:19<00:11, 11.1MiB/s] 65%|█████████████████████████▍             | 220M/338M [00:19<00:11, 11.2MiB/s] 66%|█████████████████████████▌             | 221M/338M [00:20<00:10, 11.7MiB/s] 66%|█████████████████████████▋             | 222M/338M [00:20<00:11, 10.8MiB/s] 66%|█████████████████████████▊             | 223M/338M [00:20<00:11, 10.5MiB/s] 66%|█████████████████████████▉             | 224M/338M [00:20<00:11, 10.7MiB/s] 67%|██████████████████████████             | 226M/338M [00:20<00:10, 10.9MiB/s] 67%|██████████████████████████▏            | 227M/338M [00:20<00:09, 11.6MiB/s] 68%|██████████████████████████▎            | 228M/338M [00:20<00:09, 11.9MiB/s] 68%|██████████████████████████▍            | 229M/338M [00:20<00:09, 11.7MiB/s] 68%|██████████████████████████▋            | 231M/338M [00:20<00:09, 11.9MiB/s] 69%|██████████████████████████▊            | 232M/338M [00:21<00:10, 10.9MiB/s] 69%|██████████████████████████▉            | 233M/338M [00:21<00:10, 10.6MiB/s] 69%|███████████████████████████            | 234M/338M [00:21<00:10, 10.6MiB/s] 70%|███████████████████████████▏           | 235M/338M [00:21<00:09, 11.1MiB/s] 70%|███████████████████████████▎           | 236M/338M [00:21<00:09, 11.2MiB/s] 70%|███████████████████████████▍           | 237M/338M [00:21<00:09, 10.9MiB/s] 71%|███████████████████████████▌           | 238M/338M [00:21<00:09, 11.2MiB/s] 71%|███████████████████████████▋           | 239M/338M [00:21<00:09, 11.2MiB/s] 71%|███████████████████████████▊           | 240M/338M [00:21<00:09, 10.6MiB/s] 72%|███████████████████████████▉           | 242M/338M [00:22<00:09, 10.4MiB/s] 72%|████████████████████████████           | 243M/338M [00:22<00:09, 10.7MiB/s] 72%|████████████████████████████▏          | 244M/338M [00:22<00:09, 10.9MiB/s] 73%|████████████████████████████▎          | 245M/338M [00:22<00:09, 10.5MiB/s] 73%|████████████████████████████▍          | 246M/338M [00:22<00:09, 10.3MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:22<00:08, 10.6MiB/s] 74%|████████████████████████████▋          | 248M/338M [00:22<00:08, 11.2MiB/s] 74%|████████████████████████████▊          | 250M/338M [00:22<00:07, 12.0MiB/s] 74%|█████████████████████████████          | 251M/338M [00:22<00:07, 12.9MiB/s] 75%|█████████████████████████████▏         | 252M/338M [00:22<00:06, 13.2MiB/s] 75%|█████████████████████████████▎         | 254M/338M [00:23<00:06, 13.1MiB/s] 76%|█████████████████████████████▍         | 255M/338M [00:23<00:06, 13.2MiB/s] 76%|█████████████████████████████▋         | 257M/338M [00:23<00:06, 13.7MiB/s] 76%|█████████████████████████████▊         | 258M/338M [00:23<00:05, 14.5MiB/s] 77%|█████████████████████████████▉         | 260M/338M [00:23<00:05, 13.7MiB/s] 77%|██████████████████████████████▏        | 261M/338M [00:23<00:06, 13.1MiB/s] 78%|██████████████████████████████▎        | 262M/338M [00:23<00:06, 13.1MiB/s] 78%|██████████████████████████████▍        | 264M/338M [00:23<00:05, 13.4MiB/s] 79%|██████████████████████████████▌        | 265M/338M [00:23<00:05, 13.9MiB/s] 79%|██████████████████████████████▊        | 267M/338M [00:24<00:04, 14.9MiB/s] 79%|██████████████████████████████▉        | 268M/338M [00:24<00:05, 14.0MiB/s] 80%|███████████████████████████████▏       | 270M/338M [00:24<00:05, 12.3MiB/s] 80%|███████████████████████████████▎       | 271M/338M [00:24<00:05, 11.8MiB/s] 81%|███████████████████████████████▍       | 272M/338M [00:24<00:05, 11.8MiB/s] 81%|███████████████████████████████▌       | 273M/338M [00:24<00:05, 12.1MiB/s] 81%|███████████████████████████████▋       | 275M/338M [00:24<00:05, 12.8MiB/s] 82%|███████████████████████████████▉       | 276M/338M [00:24<00:04, 13.7MiB/s] 82%|████████████████████████████████       | 278M/338M [00:24<00:04, 14.8MiB/s] 83%|████████████████████████████████▎      | 279M/338M [00:25<00:04, 14.9MiB/s] 83%|████████████████████████████████▍      | 281M/338M [00:25<00:04, 14.7MiB/s] 84%|████████████████████████████████▌      | 282M/338M [00:25<00:03, 14.6MiB/s] 84%|████████████████████████████████▊      | 284M/338M [00:25<00:03, 15.1MiB/s] 85%|████████████████████████████████▉      | 285M/338M [00:25<00:03, 15.0MiB/s] 85%|█████████████████████████████████      | 287M/338M [00:25<00:04, 12.5MiB/s] 85%|█████████████████████████████████▎     | 288M/338M [00:25<00:04, 11.6MiB/s] 86%|█████████████████████████████████▍     | 289M/338M [00:25<00:04, 11.5MiB/s] 86%|█████████████████████████████████▌     | 290M/338M [00:25<00:04, 11.2MiB/s] 86%|█████████████████████████████████▋     | 291M/338M [00:26<00:04, 10.5MiB/s] 87%|█████████████████████████████████▊     | 292M/338M [00:26<00:04, 10.5MiB/s] 87%|█████████████████████████████████▉     | 294M/338M [00:26<00:04, 11.0MiB/s] 87%|██████████████████████████████████     | 295M/338M [00:26<00:03, 11.7MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:26<00:03, 11.8MiB/s] 88%|██████████████████████████████████▎    | 297M/338M [00:26<00:03, 11.4MiB/s] 88%|██████████████████████████████████▍    | 298M/338M [00:26<00:03, 11.7MiB/s] 89%|██████████████████████████████████▋    | 300M/338M [00:26<00:03, 12.3MiB/s] 89%|██████████████████████████████████▊    | 301M/338M [00:26<00:03, 11.6MiB/s] 90%|██████████████████████████████████▉    | 302M/338M [00:27<00:03, 11.6MiB/s] 90%|███████████████████████████████████    | 304M/338M [00:27<00:02, 12.0MiB/s] 90%|███████████████████████████████████▏   | 305M/338M [00:27<00:02, 11.6MiB/s] 91%|███████████████████████████████████▎   | 306M/338M [00:27<00:02, 11.2MiB/s] 91%|███████████████████████████████████▍   | 307M/338M [00:27<00:02, 11.1MiB/s] 91%|███████████████████████████████████▌   | 308M/338M [00:27<00:02, 11.4MiB/s] 92%|███████████████████████████████████▊   | 309M/338M [00:27<00:02, 12.2MiB/s] 92%|███████████████████████████████████▉   | 311M/338M [00:27<00:02, 13.0MiB/s] 93%|████████████████████████████████████   | 312M/338M [00:27<00:01, 13.4MiB/s] 93%|████████████████████████████████████▏  | 314M/338M [00:28<00:01, 13.1MiB/s] 93%|████████████████████████████████████▍  | 315M/338M [00:28<00:01, 13.2MiB/s] 94%|████████████████████████████████████▌  | 316M/338M [00:28<00:01, 13.8MiB/s] 94%|████████████████████████████████████▋  | 318M/338M [00:28<00:01, 14.4MiB/s] 95%|████████████████████████████████████▉  | 319M/338M [00:28<00:01, 13.0MiB/s] 95%|█████████████████████████████████████  | 321M/338M [00:28<00:01, 11.5MiB/s] 95%|█████████████████████████████████████▏ | 322M/338M [00:28<00:01, 11.3MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:28<00:01, 11.3MiB/s] 96%|█████████████████████████████████████▍ | 324M/338M [00:28<00:01, 11.6MiB/s] 96%|█████████████████████████████████████▌ | 325M/338M [00:29<00:01, 11.9MiB/s] 97%|█████████████████████████████████████▋ | 327M/338M [00:29<00:00, 11.8MiB/s] 97%|█████████████████████████████████████▊ | 328M/338M [00:29<00:00, 11.9MiB/s] 97%|██████████████████████████████████████ | 329M/338M [00:29<00:00, 12.4MiB/s] 98%|██████████████████████████████████████▏| 330M/338M [00:29<00:00, 12.2MiB/s] 98%|██████████████████████████████████████▎| 331M/338M [00:29<00:00, 11.6MiB/s] 99%|██████████████████████████████████████▍| 333M/338M [00:29<00:00, 11.5MiB/s] 99%|██████████████████████████████████████▌| 334M/338M [00:29<00:00, 10.3MiB/s] 99%|██████████████████████████████████████▋| 335M/338M [00:29<00:00, 9.90MiB/s] 99%|██████████████████████████████████████▊| 336M/338M [00:30<00:00, 9.97MiB/s]100%|██████████████████████████████████████▉| 337M/338M [00:30<00:00, 10.4MiB/s]100%|███████████████████████████████████████| 338M/338M [00:30<00:00, 11.7MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
=> loading checkpoint './/save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar'
=> loaded checkpoint './/save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar' (epoch 5)
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Files already downloaded and verified
Files already downloaded and verified
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:22, 336525.30it/s]  0%|          | 131072/169001437 [00:00<07:00, 401531.47it/s]  0%|          | 196608/169001437 [00:00<05:46, 486599.32it/s]  0%|          | 360448/169001437 [00:00<03:48, 738692.49it/s]  0%|          | 688128/169001437 [00:00<01:55, 1461324.06it/s]  1%|          | 1572864/169001437 [00:00<00:46, 3596697.79it/s]  2%|▏         | 3112960/169001437 [00:00<00:23, 7041131.47it/s]  3%|▎         | 4882432/169001437 [00:01<00:17, 9279269.74it/s]  4%|▍         | 6717440/169001437 [00:01<00:13, 11785595.70it/s]  5%|▌         | 8716288/169001437 [00:01<00:11, 14104482.67it/s]  6%|▋         | 10682368/169001437 [00:01<00:10, 15695067.12it/s]  8%|▊         | 13041664/169001437 [00:01<00:08, 17983990.12it/s]  9%|▉         | 15400960/169001437 [00:01<00:07, 19624892.19it/s] 11%|█         | 17989632/169001437 [00:01<00:07, 21462534.74it/s] 12%|█▏        | 20676608/169001437 [00:01<00:06, 23056801.04it/s] 14%|█▍        | 23527424/169001437 [00:01<00:05, 24666761.56it/s] 16%|█▌        | 26476544/169001437 [00:01<00:05, 23827395.70it/s] 17%|█▋        | 29458432/169001437 [00:02<00:05, 25262096.53it/s] 19%|█▉        | 32571392/169001437 [00:02<00:05, 26837811.86it/s] 21%|██        | 35848192/169001437 [00:02<00:04, 28523459.30it/s] 23%|██▎       | 39124992/169001437 [00:02<00:04, 29743312.87it/s] 25%|██▌       | 42369024/169001437 [00:02<00:04, 30518200.28it/s] 27%|██▋       | 45580288/169001437 [00:02<00:03, 30989164.21it/s] 29%|██▉       | 48857088/169001437 [00:02<00:03, 31499947.42it/s] 31%|███       | 52035584/169001437 [00:02<00:03, 30027187.67it/s] 33%|███▎      | 55115776/169001437 [00:02<00:03, 29888591.47it/s] 34%|███▍      | 58261504/169001437 [00:02<00:03, 30198372.06it/s] 36%|███▋      | 61374464/169001437 [00:03<00:03, 30347968.54it/s] 38%|███▊      | 64618496/169001437 [00:03<00:03, 30950273.76it/s] 40%|████      | 67764224/169001437 [00:03<00:03, 30971498.38it/s] 42%|████▏     | 71008256/169001437 [00:03<00:03, 31387598.58it/s] 44%|████▍     | 74252288/169001437 [00:03<00:02, 31688079.84it/s] 46%|████▌     | 77496320/169001437 [00:03<00:02, 31903304.72it/s] 48%|████▊     | 80707584/169001437 [00:03<00:02, 31940271.09it/s] 50%|████▉     | 83951616/169001437 [00:03<00:02, 31644685.94it/s] 52%|█████▏    | 87130112/169001437 [00:03<00:02, 30600926.20it/s] 53%|█████▎    | 90308608/169001437 [00:04<00:02, 30766348.21it/s] 55%|█████▌    | 93421568/169001437 [00:04<00:02, 30760090.05it/s] 57%|█████▋    | 96534528/169001437 [00:04<00:02, 30723952.99it/s] 59%|█████▉    | 99713024/169001437 [00:04<00:02, 30843879.86it/s] 61%|██████    | 102957056/169001437 [00:04<00:02, 31087162.58it/s] 63%|██████▎   | 106201088/169001437 [00:04<00:01, 31473227.23it/s] 65%|██████▍   | 109379584/169001437 [00:04<00:01, 31350110.98it/s] 67%|██████▋   | 112623616/169001437 [00:04<00:01, 31672353.21it/s] 69%|██████▊   | 115802112/169001437 [00:04<00:01, 31503505.37it/s] 70%|███████   | 119046144/169001437 [00:04<00:01, 31771315.00it/s] 72%|███████▏  | 122224640/169001437 [00:05<00:01, 31588958.56it/s] 74%|███████▍  | 125403136/169001437 [00:05<00:01, 31152501.61it/s] 76%|███████▌  | 128548864/169001437 [00:05<00:01, 30837114.02it/s] 78%|███████▊  | 131661824/169001437 [00:05<00:01, 30514141.03it/s] 80%|███████▉  | 134873088/169001437 [00:05<00:01, 30491100.13it/s] 82%|████████▏ | 137953280/169001437 [00:05<00:01, 30469583.34it/s] 84%|████████▎ | 141164544/169001437 [00:05<00:00, 30555030.95it/s] 85%|████████▌ | 144408576/169001437 [00:05<00:00, 31087865.76it/s] 87%|████████▋ | 147554304/169001437 [00:05<00:00, 31039443.54it/s] 89%|████████▉ | 150798336/169001437 [00:05<00:00, 31446756.53it/s] 91%|█████████ | 153976832/169001437 [00:06<00:00, 31427359.12it/s] 93%|█████████▎| 157220864/169001437 [00:06<00:00, 31723270.54it/s] 95%|█████████▍| 160432128/169001437 [00:06<00:00, 31468236.64it/s] 97%|█████████▋| 163610624/169001437 [00:06<00:00, 30920929.12it/s] 99%|█████████▊| 166789120/169001437 [00:06<00:00, 30713108.71it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 25898816.33it/s]
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck',
 'This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:06<08:35,  6.61s/it]  3%|▎         | 2/79 [00:06<03:42,  2.89s/it]  4%|▍         | 3/79 [00:07<02:08,  1.69s/it]  5%|▌         | 4/79 [00:07<01:24,  1.13s/it]  6%|▋         | 5/79 [00:07<01:00,  1.23it/s]  8%|▊         | 6/79 [00:07<00:45,  1.61it/s]  9%|▉         | 7/79 [00:08<00:35,  2.00it/s] 10%|█         | 8/79 [00:08<00:30,  2.34it/s] 11%|█▏        | 9/79 [00:08<00:25,  2.69it/s] 13%|█▎        | 10/79 [00:09<00:24,  2.80it/s] 14%|█▍        | 11/79 [00:09<00:21,  3.09it/s] 15%|█▌        | 12/79 [00:09<00:20,  3.25it/s] 16%|█▋        | 13/79 [00:09<00:19,  3.37it/s] 18%|█▊        | 14/79 [00:10<00:18,  3.55it/s] 19%|█▉        | 15/79 [00:10<00:17,  3.68it/s] 20%|██        | 16/79 [00:10<00:17,  3.70it/s] 22%|██▏       | 17/79 [00:10<00:16,  3.71it/s] 23%|██▎       | 18/79 [00:11<00:16,  3.69it/s] 24%|██▍       | 19/79 [00:11<00:16,  3.68it/s] 25%|██▌       | 20/79 [00:11<00:15,  3.80it/s] 27%|██▋       | 21/79 [00:11<00:15,  3.77it/s] 28%|██▊       | 22/79 [00:12<00:16,  3.55it/s] 29%|██▉       | 23/79 [00:12<00:15,  3.69it/s] 30%|███       | 24/79 [00:12<00:15,  3.46it/s] 32%|███▏      | 25/79 [00:13<00:14,  3.64it/s] 33%|███▎      | 26/79 [00:13<00:14,  3.58it/s] 34%|███▍      | 27/79 [00:13<00:15,  3.41it/s] 35%|███▌      | 28/79 [00:13<00:14,  3.47it/s] 37%|███▋      | 29/79 [00:14<00:13,  3.62it/s] 38%|███▊      | 30/79 [00:14<00:13,  3.60it/s] 39%|███▉      | 31/79 [00:14<00:14,  3.42it/s] 41%|████      | 32/79 [00:15<00:13,  3.51it/s] 42%|████▏     | 33/79 [00:15<00:12,  3.66it/s] 43%|████▎     | 34/79 [00:15<00:12,  3.57it/s] 44%|████▍     | 35/79 [00:15<00:12,  3.50it/s] 46%|████▌     | 36/79 [00:16<00:11,  3.66it/s] 47%|████▋     | 37/79 [00:16<00:11,  3.76it/s] 48%|████▊     | 38/79 [00:16<00:10,  3.84it/s] 49%|████▉     | 39/79 [00:16<00:10,  3.89it/s] 51%|█████     | 40/79 [00:17<00:09,  3.95it/s] 52%|█████▏    | 41/79 [00:17<00:09,  3.88it/s] 53%|█████▎    | 42/79 [00:17<00:10,  3.63it/s] 54%|█████▍    | 43/79 [00:18<00:09,  3.64it/s] 56%|█████▌    | 44/79 [00:18<00:09,  3.65it/s] 57%|█████▋    | 45/79 [00:18<00:09,  3.65it/s] 58%|█████▊    | 46/79 [00:18<00:08,  3.77it/s] 59%|█████▉    | 47/79 [00:19<00:08,  3.87it/s] 61%|██████    | 48/79 [00:19<00:07,  3.91it/s] 62%|██████▏   | 49/79 [00:19<00:07,  3.97it/s] 63%|██████▎   | 50/79 [00:19<00:07,  4.00it/s] 65%|██████▍   | 51/79 [00:20<00:06,  4.04it/s] 66%|██████▌   | 52/79 [00:20<00:06,  4.06it/s] 67%|██████▋   | 53/79 [00:20<00:06,  4.08it/s] 68%|██████▊   | 54/79 [00:20<00:06,  4.10it/s] 70%|██████▉   | 55/79 [00:20<00:05,  4.10it/s] 71%|███████   | 56/79 [00:21<00:05,  4.11it/s] 72%|███████▏  | 57/79 [00:21<00:05,  4.12it/s] 73%|███████▎  | 58/79 [00:21<00:05,  4.11it/s] 75%|███████▍  | 59/79 [00:21<00:04,  4.12it/s] 76%|███████▌  | 60/79 [00:22<00:04,  4.12it/s] 77%|███████▋  | 61/79 [00:22<00:04,  4.11it/s] 78%|███████▊  | 62/79 [00:22<00:04,  4.09it/s] 80%|███████▉  | 63/79 [00:22<00:03,  4.11it/s] 81%|████████  | 64/79 [00:23<00:03,  4.10it/s] 82%|████████▏ | 65/79 [00:23<00:03,  4.10it/s] 84%|████████▎ | 66/79 [00:23<00:03,  4.10it/s] 85%|████████▍ | 67/79 [00:23<00:02,  4.10it/s] 86%|████████▌ | 68/79 [00:24<00:02,  4.09it/s] 87%|████████▋ | 69/79 [00:24<00:02,  4.10it/s] 89%|████████▊ | 70/79 [00:24<00:02,  4.11it/s] 90%|████████▉ | 71/79 [00:24<00:01,  4.12it/s] 91%|█████████ | 72/79 [00:25<00:01,  4.12it/s] 92%|█████████▏| 73/79 [00:25<00:01,  4.12it/s] 94%|█████████▎| 74/79 [00:25<00:01,  4.12it/s] 95%|█████████▍| 75/79 [00:25<00:00,  4.12it/s] 96%|█████████▌| 76/79 [00:26<00:00,  4.13it/s] 97%|█████████▋| 77/79 [00:26<00:00,  4.10it/s] 99%|█████████▊| 78/79 [00:26<00:00,  4.10it/s]100%|██████████| 79/79 [00:26<00:00,  2.94it/s]
Validate: [ 0/79]	Time  6.613 ( 6.613)	Loss 4.6602e+00 (4.6602e+00)	Prompt Acc@1  77.34 ( 77.34)
Validate: [10/79]	Time  0.245 ( 0.843)	Loss 4.8984e+00 (5.7681e+00)	Prompt Acc@1  77.34 ( 75.07)
Validate: [20/79]	Time  0.271 ( 0.567)	Loss 4.7188e+00 (5.7896e+00)	Prompt Acc@1  79.69 ( 75.45)
Validate: [30/79]	Time  0.328 ( 0.477)	Loss 6.3906e+00 (6.1046e+00)	Prompt Acc@1  72.66 ( 74.60)
Validate: [40/79]	Time  0.269 ( 0.425)	Loss 4.8789e+00 (6.0413e+00)	Prompt Acc@1  70.31 ( 74.56)
Validate: [50/79]	Time  0.243 ( 0.392)	Loss 6.8203e+00 (6.1891e+00)	Prompt Acc@1  72.66 ( 74.19)
Validate: [60/79]	Time  0.245 ( 0.368)	Loss 6.9414e+00 (6.0334e+00)	Prompt Acc@1  74.22 ( 74.44)
Validate: [70/79]	Time  0.241 ( 0.350)	Loss 6.8867e+00 (6.0245e+00)	Prompt Acc@1  72.66 ( 74.25)
 * Prompt Acc@1 74.190
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:04<05:32,  4.26s/it]  3%|▎         | 2/79 [00:04<02:42,  2.11s/it]  4%|▍         | 3/79 [00:05<01:48,  1.43s/it]  5%|▌         | 4/79 [00:06<01:22,  1.10s/it]  6%|▋         | 5/79 [00:06<01:03,  1.17it/s]  8%|▊         | 6/79 [00:06<00:52,  1.40it/s]  9%|▉         | 7/79 [00:07<00:43,  1.64it/s] 10%|█         | 8/79 [00:07<00:37,  1.89it/s] 11%|█▏        | 9/79 [00:07<00:31,  2.22it/s] 13%|█▎        | 10/79 [00:08<00:27,  2.52it/s] 14%|█▍        | 11/79 [00:08<00:23,  2.87it/s] 15%|█▌        | 12/79 [00:08<00:21,  3.16it/s] 16%|█▋        | 13/79 [00:08<00:19,  3.35it/s] 18%|█▊        | 14/79 [00:09<00:21,  3.04it/s] 19%|█▉        | 15/79 [00:09<00:19,  3.30it/s] 20%|██        | 16/79 [00:09<00:18,  3.50it/s] 22%|██▏       | 17/79 [00:10<00:17,  3.62it/s] 23%|██▎       | 18/79 [00:10<00:17,  3.46it/s] 24%|██▍       | 19/79 [00:10<00:16,  3.63it/s] 25%|██▌       | 20/79 [00:10<00:16,  3.52it/s] 27%|██▋       | 21/79 [00:11<00:16,  3.55it/s] 28%|██▊       | 22/79 [00:11<00:15,  3.58it/s] 29%|██▉       | 23/79 [00:11<00:15,  3.61it/s] 30%|███       | 24/79 [00:12<00:15,  3.62it/s] 32%|███▏      | 25/79 [00:12<00:14,  3.75it/s] 33%|███▎      | 26/79 [00:12<00:13,  3.85it/s] 34%|███▍      | 27/79 [00:12<00:14,  3.61it/s] 35%|███▌      | 28/79 [00:13<00:14,  3.44it/s] 37%|███▋      | 29/79 [00:13<00:14,  3.50it/s] 38%|███▊      | 30/79 [00:13<00:13,  3.67it/s] 39%|███▉      | 31/79 [00:14<00:13,  3.61it/s] 41%|████      | 32/79 [00:14<00:12,  3.75it/s] 42%|████▏     | 33/79 [00:14<00:12,  3.82it/s] 43%|████▎     | 34/79 [00:14<00:13,  3.37it/s] 44%|████▍     | 35/79 [00:15<00:13,  3.37it/s] 46%|████▌     | 36/79 [00:15<00:12,  3.55it/s] 47%|████▋     | 37/79 [00:15<00:11,  3.71it/s] 48%|████▊     | 38/79 [00:15<00:10,  3.82it/s] 49%|████▉     | 39/79 [00:16<00:10,  3.77it/s] 51%|█████     | 40/79 [00:16<00:11,  3.41it/s] 52%|█████▏    | 41/79 [00:16<00:10,  3.46it/s] 53%|█████▎    | 42/79 [00:17<00:10,  3.50it/s] 54%|█████▍    | 43/79 [00:17<00:10,  3.54it/s] 56%|█████▌    | 44/79 [00:17<00:09,  3.56it/s] 57%|█████▋    | 45/79 [00:17<00:09,  3.69it/s] 58%|█████▊    | 46/79 [00:18<00:09,  3.45it/s] 59%|█████▉    | 47/79 [00:18<00:09,  3.55it/s] 61%|██████    | 48/79 [00:18<00:08,  3.71it/s] 62%|██████▏   | 49/79 [00:18<00:07,  3.81it/s] 63%|██████▎   | 50/79 [00:19<00:07,  3.89it/s] 65%|██████▍   | 51/79 [00:19<00:07,  3.94it/s] 66%|██████▌   | 52/79 [00:19<00:06,  3.98it/s] 67%|██████▋   | 53/79 [00:19<00:06,  4.03it/s] 68%|██████▊   | 54/79 [00:20<00:06,  4.04it/s] 70%|██████▉   | 55/79 [00:20<00:05,  4.08it/s] 71%|███████   | 56/79 [00:20<00:05,  4.08it/s] 72%|███████▏  | 57/79 [00:20<00:05,  4.08it/s] 73%|███████▎  | 58/79 [00:21<00:05,  4.08it/s] 75%|███████▍  | 59/79 [00:21<00:04,  4.09it/s] 76%|███████▌  | 60/79 [00:21<00:04,  4.11it/s] 77%|███████▋  | 61/79 [00:21<00:04,  4.11it/s] 78%|███████▊  | 62/79 [00:22<00:04,  4.10it/s] 80%|███████▉  | 63/79 [00:22<00:03,  4.09it/s] 81%|████████  | 64/79 [00:22<00:03,  4.10it/s] 82%|████████▏ | 65/79 [00:22<00:03,  4.10it/s] 84%|████████▎ | 66/79 [00:23<00:03,  4.10it/s] 85%|████████▍ | 67/79 [00:23<00:02,  4.10it/s] 86%|████████▌ | 68/79 [00:23<00:02,  4.08it/s] 87%|████████▋ | 69/79 [00:23<00:02,  4.10it/s] 89%|████████▊ | 70/79 [00:24<00:02,  4.11it/s] 90%|████████▉ | 71/79 [00:24<00:01,  4.10it/s] 91%|█████████ | 72/79 [00:24<00:01,  4.11it/s] 92%|█████████▏| 73/79 [00:24<00:01,  4.10it/s] 94%|█████████▎| 74/79 [00:25<00:01,  4.10it/s] 95%|█████████▍| 75/79 [00:25<00:00,  4.09it/s] 96%|█████████▌| 76/79 [00:25<00:00,  4.08it/s] 97%|█████████▋| 77/79 [00:25<00:00,  4.09it/s] 99%|█████████▊| 78/79 [00:26<00:00,  4.10it/s]100%|██████████| 79/79 [00:26<00:00,  3.00it/s]
Validate: [ 0/79]	Time  4.261 ( 4.261)	Loss 5.6375e+01 (5.6375e+01)	Prompt Acc@1   0.00 (  0.00)
Validate: [10/79]	Time  0.239 ( 0.771)	Loss 4.8625e+01 (5.0591e+01)	Prompt Acc@1   1.56 (  0.50)
Validate: [20/79]	Time  0.276 ( 0.537)	Loss 4.5594e+01 (5.0810e+01)	Prompt Acc@1   0.00 (  0.48)
Validate: [30/79]	Time  0.286 ( 0.452)	Loss 4.6969e+01 (5.0850e+01)	Prompt Acc@1   0.00 (  0.48)
Validate: [40/79]	Time  0.278 ( 0.410)	Loss 5.0438e+01 (5.0601e+01)	Prompt Acc@1   0.00 (  0.42)
Validate: [50/79]	Time  0.246 ( 0.382)	Loss 4.7438e+01 (5.0643e+01)	Prompt Acc@1   0.78 (  0.38)
Validate: [60/79]	Time  0.244 ( 0.359)	Loss 5.0844e+01 (5.0871e+01)	Prompt Acc@1   0.78 (  0.36)
Validate: [70/79]	Time  0.244 ( 0.343)	Loss 4.4125e+01 (5.0842e+01)	Prompt Acc@1   1.56 (  0.39)
 * Prompt Acc@1 0.370
TOP1 Accuracy on cifar10 + cifar100 is: 37.28
