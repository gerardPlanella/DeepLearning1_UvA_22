Running experiment on cifar10 with fixed_patch and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=12, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0640', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:05, 350791.23it/s]  0%|          | 131072/170498071 [00:00<06:03, 468060.62it/s]  0%|          | 196608/170498071 [00:00<06:59, 406111.10it/s]  0%|          | 294912/170498071 [00:00<05:03, 560234.92it/s]  0%|          | 458752/170498071 [00:00<04:04, 695937.12it/s]  0%|          | 851968/170498071 [00:00<01:53, 1494975.20it/s]  1%|          | 1605632/170498071 [00:00<00:55, 3068245.77it/s]  2%|▏         | 3211264/170498071 [00:01<00:25, 6589951.35it/s]  3%|▎         | 5013504/170498071 [00:01<00:16, 9773413.59it/s]  4%|▍         | 6848512/170498071 [00:01<00:13, 12214814.95it/s]  5%|▌         | 8650752/170498071 [00:01<00:11, 13891937.23it/s]  6%|▌         | 10551296/170498071 [00:01<00:10, 15382027.15it/s]  7%|▋         | 12615680/170498071 [00:01<00:09, 16916665.83it/s]  8%|▊         | 14450688/170498071 [00:01<00:09, 17308635.19it/s] 10%|▉         | 16547840/170498071 [00:01<00:08, 18240124.84it/s] 11%|█         | 18808832/170498071 [00:01<00:08, 18289880.36it/s] 12%|█▏        | 21102592/170498071 [00:02<00:08, 17350768.72it/s] 14%|█▍        | 23560192/170498071 [00:02<00:07, 19228486.33it/s] 15%|█▌        | 26050560/170498071 [00:02<00:06, 20778605.98it/s] 17%|█▋        | 28737536/170498071 [00:02<00:06, 22477778.40it/s] 18%|█▊        | 31522816/170498071 [00:02<00:05, 24011215.65it/s] 20%|██        | 34373632/170498071 [00:02<00:05, 25290898.82it/s] 22%|██▏       | 37224448/170498071 [00:02<00:05, 26226397.38it/s] 24%|██▎       | 40206336/170498071 [00:02<00:04, 27281628.41it/s] 25%|██▌       | 43253760/170498071 [00:02<00:04, 28217858.69it/s] 27%|██▋       | 46202880/170498071 [00:02<00:04, 28579284.30it/s] 29%|██▉       | 49217536/170498071 [00:03<00:04, 29028978.83it/s] 31%|███       | 52330496/170498071 [00:03<00:04, 29537781.01it/s] 33%|███▎      | 55640064/170498071 [00:03<00:03, 30576106.52it/s] 34%|███▍      | 58785792/170498071 [00:03<00:03, 30835743.02it/s] 36%|███▋      | 61898752/170498071 [00:03<00:03, 30823288.53it/s] 38%|███▊      | 65011712/170498071 [00:03<00:03, 30780481.14it/s] 40%|███▉      | 68091904/170498071 [00:03<00:03, 30673173.90it/s] 42%|████▏     | 71335936/170498071 [00:03<00:03, 31195471.90it/s] 44%|████▎     | 74514432/170498071 [00:03<00:03, 31274709.02it/s] 46%|████▌     | 77791232/170498071 [00:03<00:02, 31718512.34it/s] 47%|████▋     | 80969728/170498071 [00:04<00:03, 27434891.82it/s] 49%|████▉     | 84213760/170498071 [00:04<00:02, 28776586.38it/s] 51%|█████     | 87326720/170498071 [00:04<00:02, 28971108.80it/s] 53%|█████▎    | 90603520/170498071 [00:04<00:02, 30030685.41it/s] 55%|█████▍    | 93683712/170498071 [00:04<00:02, 30162337.63it/s] 57%|█████▋    | 96763904/170498071 [00:04<00:02, 30254927.70it/s] 59%|█████▊    | 100007936/170498071 [00:04<00:02, 30893128.52it/s] 61%|██████    | 103153664/170498071 [00:04<00:02, 30938315.61it/s] 62%|██████▏   | 106364928/170498071 [00:04<00:02, 31056097.99it/s] 64%|██████▍   | 109608960/170498071 [00:05<00:01, 31283764.50it/s] 66%|██████▌   | 112885760/170498071 [00:05<00:01, 31440611.33it/s] 68%|██████▊   | 116129792/170498071 [00:05<00:01, 31728625.85it/s] 70%|███████   | 119406592/170498071 [00:05<00:01, 32022548.72it/s] 72%|███████▏  | 122617856/170498071 [00:05<00:01, 31984676.51it/s] 74%|███████▍  | 125829120/170498071 [00:05<00:01, 31835045.76it/s] 76%|███████▌  | 129040384/170498071 [00:05<00:01, 31821794.51it/s] 78%|███████▊  | 132251648/170498071 [00:05<00:01, 31713459.31it/s] 79%|███████▉  | 135430144/170498071 [00:05<00:01, 31544349.34it/s] 81%|████████▏ | 138608640/170498071 [00:05<00:01, 31436606.80it/s] 83%|████████▎ | 141754368/170498071 [00:06<00:00, 31277020.44it/s] 85%|████████▍ | 144900096/170498071 [00:06<00:00, 31176382.03it/s] 87%|████████▋ | 148045824/170498071 [00:06<00:00, 28760521.41it/s] 89%|████████▊ | 151257088/170498071 [00:06<00:00, 28767097.87it/s] 91%|█████████ | 154468352/170498071 [00:06<00:00, 29496057.05it/s] 93%|█████████▎| 157712384/170498071 [00:06<00:00, 30326733.55it/s] 94%|█████████▍| 160792576/170498071 [00:06<00:00, 30432740.50it/s] 96%|█████████▌| 164003840/170498071 [00:06<00:00, 30922082.66it/s] 98%|█████████▊| 167215104/170498071 [00:06<00:00, 31153783.75it/s]100%|█████████▉| 170491904/170498071 [00:06<00:00, 31618484.01it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 24392081.12it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 3.16M/338M [00:00<00:11, 31.3MiB/s]  6%|██▏                                    | 19.3M/338M [00:00<00:03, 110MiB/s] 12%|████▍                                  | 38.9M/338M [00:00<00:02, 152MiB/s] 16%|██████▏                                | 53.6M/338M [00:00<00:01, 150MiB/s] 20%|███████▊                               | 68.0M/338M [00:00<00:01, 150MiB/s] 24%|█████████▌                             | 82.5M/338M [00:00<00:01, 150MiB/s] 29%|███████████▎                           | 97.6M/338M [00:00<00:01, 153MiB/s] 33%|█████████████▍                          | 113M/338M [00:00<00:01, 154MiB/s] 38%|███████████████▏                        | 128M/338M [00:00<00:01, 156MiB/s] 43%|█████████████████                       | 144M/338M [00:01<00:01, 158MiB/s] 47%|██████████████████▉                     | 160M/338M [00:01<00:01, 160MiB/s] 52%|████████████████████▊                   | 176M/338M [00:01<00:01, 162MiB/s] 57%|██████████████████████▋                 | 191M/338M [00:01<00:00, 162MiB/s] 61%|████████████████████████▌               | 207M/338M [00:01<00:00, 163MiB/s] 66%|██████████████████████████▍             | 223M/338M [00:01<00:00, 165MiB/s] 71%|████████████████████████████▍           | 240M/338M [00:01<00:00, 167MiB/s] 76%|██████████████████████████████▎         | 256M/338M [00:01<00:00, 169MiB/s] 81%|████████████████████████████████▎       | 272M/338M [00:01<00:00, 169MiB/s] 85%|██████████████████████████████████▏     | 289M/338M [00:01<00:00, 169MiB/s] 90%|████████████████████████████████████▏   | 305M/338M [00:02<00:00, 171MiB/s] 96%|██████████████████████████████████████▏ | 323M/338M [00:02<00:00, 173MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 159MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
  0%|          | 0/313 [00:00<?, ?it/s]  0%|          | 1/313 [00:05<28:13,  5.43s/it]  1%|          | 2/313 [00:06<13:35,  2.62s/it]  1%|          | 3/313 [00:06<08:55,  1.73s/it]  1%|▏         | 4/313 [00:07<06:55,  1.34s/it]  2%|▏         | 5/313 [00:08<05:43,  1.12s/it]  2%|▏         | 6/313 [00:08<04:52,  1.05it/s]  2%|▏         | 7/313 [00:09<04:24,  1.16it/s]  3%|▎         | 8/313 [00:10<04:02,  1.26it/s]  3%|▎         | 9/313 [00:10<03:53,  1.30it/s]  3%|▎         | 10/313 [00:11<03:41,  1.37it/s]  4%|▎         | 11/313 [00:12<03:33,  1.41it/s]  4%|▍         | 12/313 [00:12<03:22,  1.49it/s]  4%|▍         | 13/313 [00:13<03:21,  1.49it/s]  4%|▍         | 14/313 [00:14<03:18,  1.51it/s]  5%|▍         | 15/313 [00:14<03:12,  1.54it/s]  5%|▌         | 16/313 [00:15<03:09,  1.57it/s]  5%|▌         | 17/313 [00:15<03:09,  1.57it/s]  6%|▌         | 18/313 [00:16<03:03,  1.61it/s]  6%|▌         | 19/313 [00:17<03:00,  1.63it/s]  6%|▋         | 20/313 [00:17<02:57,  1.65it/s]  7%|▋         | 21/313 [00:18<03:00,  1.61it/s]  7%|▋         | 22/313 [00:18<02:58,  1.63it/s]  7%|▋         | 23/313 [00:19<03:03,  1.58it/s]  8%|▊         | 24/313 [00:20<02:59,  1.61it/s]  8%|▊         | 25/313 [00:20<02:58,  1.62it/s]  8%|▊         | 26/313 [00:21<02:54,  1.64it/s]  9%|▊         | 27/313 [00:22<02:52,  1.65it/s]  9%|▉         | 28/313 [00:22<02:57,  1.60it/s]  9%|▉         | 29/313 [00:23<02:55,  1.62it/s] 10%|▉         | 30/313 [00:23<02:54,  1.62it/s] 10%|▉         | 31/313 [00:24<02:52,  1.64it/s] 10%|█         | 32/313 [00:25<02:50,  1.65it/s] 11%|█         | 33/313 [00:25<02:49,  1.65it/s] 11%|█         | 34/313 [00:26<02:49,  1.65it/s] 11%|█         | 35/313 [00:26<02:52,  1.61it/s] 12%|█▏        | 36/313 [00:27<02:54,  1.59it/s] 12%|█▏        | 37/313 [00:28<02:55,  1.57it/s] 12%|█▏        | 38/313 [00:28<02:52,  1.59it/s] 12%|█▏        | 39/313 [00:29<02:49,  1.62it/s] 13%|█▎        | 40/313 [00:30<02:47,  1.63it/s] 13%|█▎        | 41/313 [00:30<02:46,  1.64it/s] 13%|█▎        | 42/313 [00:31<02:44,  1.65it/s] 14%|█▎        | 43/313 [00:31<02:43,  1.65it/s] 14%|█▍        | 44/313 [00:32<02:42,  1.66it/s] 14%|█▍        | 45/313 [00:33<02:45,  1.62it/s] 15%|█▍        | 46/313 [00:33<02:43,  1.64it/s] 15%|█▌        | 47/313 [00:34<02:41,  1.65it/s] 15%|█▌        | 48/313 [00:34<02:39,  1.66it/s] 16%|█▌        | 49/313 [00:35<02:37,  1.67it/s] 16%|█▌        | 50/313 [00:36<02:37,  1.67it/s] 16%|█▋        | 51/313 [00:36<02:37,  1.67it/s] 17%|█▋        | 52/313 [00:37<02:40,  1.63it/s] 17%|█▋        | 53/313 [00:37<02:38,  1.64it/s] 17%|█▋        | 54/313 [00:38<02:37,  1.64it/s] 18%|█▊        | 55/313 [00:39<02:35,  1.65it/s] 18%|█▊        | 56/313 [00:39<02:35,  1.65it/s] 18%|█▊        | 57/313 [00:40<02:34,  1.65it/s] 19%|█▊        | 58/313 [00:40<02:33,  1.66it/s] 19%|█▉        | 59/313 [00:41<02:36,  1.62it/s] 19%|█▉        | 60/313 [00:42<02:41,  1.57it/s] 19%|█▉        | 61/313 [00:42<02:41,  1.56it/s] 20%|█▉        | 62/313 [00:43<02:41,  1.55it/s] 20%|██        | 63/313 [00:44<02:38,  1.58it/s] 20%|██        | 64/313 [00:44<02:36,  1.59it/s] 21%|██        | 65/313 [00:45<02:33,  1.61it/s] 21%|██        | 66/313 [00:46<02:31,  1.63it/s] 21%|██▏       | 67/313 [00:46<02:29,  1.65it/s] 22%|██▏       | 68/313 [00:47<02:33,  1.60it/s] 22%|██▏       | 69/313 [00:47<02:34,  1.58it/s] 22%|██▏       | 70/313 [00:48<02:39,  1.52it/s] 23%|██▎       | 71/313 [00:49<02:42,  1.48it/s] 23%|██▎       | 72/313 [00:50<02:40,  1.50it/s] 23%|██▎       | 73/313 [00:50<02:40,  1.49it/s] 24%|██▎       | 74/313 [00:51<02:43,  1.46it/s] 24%|██▍       | 75/313 [00:52<02:44,  1.45it/s] 24%|██▍       | 76/313 [00:52<02:45,  1.43it/s] 25%|██▍       | 77/313 [00:53<02:44,  1.43it/s] 25%|██▍       | 78/313 [00:54<02:44,  1.43it/s] 25%|██▌       | 79/313 [00:54<02:44,  1.42it/s] 26%|██▌       | 80/313 [00:55<02:46,  1.40it/s] 26%|██▌       | 81/313 [00:56<02:45,  1.40it/s] 26%|██▌       | 82/313 [00:57<02:43,  1.41it/s] 27%|██▋       | 83/313 [00:57<02:38,  1.45it/s] 27%|██▋       | 84/313 [00:58<02:38,  1.45it/s] 27%|██▋       | 85/313 [00:59<02:38,  1.44it/s] 27%|██▋       | 86/313 [00:59<02:38,  1.43it/s] 28%|██▊       | 87/313 [01:00<02:38,  1.42it/s] 28%|██▊       | 88/313 [01:01<02:37,  1.43it/s] 28%|██▊       | 89/313 [01:01<02:33,  1.46it/s] 29%|██▉       | 90/313 [01:02<02:30,  1.48it/s] 29%|██▉       | 91/313 [01:03<02:25,  1.53it/s] 29%|██▉       | 92/313 [01:03<02:24,  1.53it/s] 30%|██▉       | 93/313 [01:04<02:27,  1.49it/s] 30%|███       | 94/313 [01:05<02:25,  1.51it/s] 30%|███       | 95/313 [01:05<02:24,  1.51it/s] 31%|███       | 96/313 [01:06<02:23,  1.52it/s] 31%|███       | 97/313 [01:07<02:21,  1.52it/s] 31%|███▏      | 98/313 [01:07<02:17,  1.57it/s] 32%|███▏      | 99/313 [01:08<02:13,  1.60it/s] 32%|███▏      | 100/313 [01:08<02:15,  1.57it/s] 32%|███▏      | 101/313 [01:09<02:15,  1.56it/s] 33%|███▎      | 102/313 [01:10<02:15,  1.56it/s] 33%|███▎      | 103/313 [01:10<02:12,  1.58it/s] 33%|███▎      | 104/313 [01:11<02:10,  1.60it/s] 34%|███▎      | 105/313 [01:12<02:08,  1.62it/s] 34%|███▍      | 106/313 [01:12<02:06,  1.63it/s] 34%|███▍      | 107/313 [01:13<02:05,  1.64it/s] 35%|███▍      | 108/313 [01:13<02:04,  1.65it/s] 35%|███▍      | 109/313 [01:14<02:05,  1.62it/s] 35%|███▌      | 110/313 [01:15<02:11,  1.55it/s] 35%|███▌      | 111/313 [01:15<02:14,  1.50it/s] 36%|███▌      | 112/313 [01:16<02:15,  1.48it/s] 36%|███▌      | 113/313 [01:17<02:17,  1.45it/s] 36%|███▋      | 114/313 [01:18<02:18,  1.44it/s] 37%|███▋      | 115/313 [01:18<02:11,  1.50it/s] 37%|███▋      | 116/313 [01:19<02:06,  1.56it/s] 37%|███▋      | 117/313 [01:19<02:07,  1.54it/s] 38%|███▊      | 118/313 [01:20<02:07,  1.53it/s] 38%|███▊      | 119/313 [01:21<02:06,  1.53it/s] 38%|███▊      | 120/313 [01:21<02:06,  1.53it/s] 39%|███▊      | 121/313 [01:22<02:02,  1.57it/s] 39%|███▉      | 122/313 [01:23<01:59,  1.60it/s] 39%|███▉      | 123/313 [01:23<01:57,  1.62it/s] 40%|███▉      | 124/313 [01:24<01:56,  1.63it/s] 40%|███▉      | 125/313 [01:24<01:54,  1.64it/s] 40%|████      | 126/313 [01:25<01:53,  1.65it/s] 41%|████      | 127/313 [01:26<01:55,  1.62it/s] 41%|████      | 128/313 [01:26<01:56,  1.59it/s] 41%|████      | 129/313 [01:27<01:53,  1.61it/s] 42%|████▏     | 130/313 [01:28<01:52,  1.62it/s] 42%|████▏     | 131/313 [01:28<01:50,  1.64it/s] 42%|████▏     | 132/313 [01:29<01:52,  1.61it/s] 42%|████▏     | 133/313 [01:29<01:57,  1.54it/s] 43%|████▎     | 134/313 [01:30<01:58,  1.51it/s] 43%|████▎     | 135/313 [01:31<02:00,  1.48it/s] 43%|████▎     | 136/313 [01:32<02:01,  1.46it/s] 44%|████▍     | 137/313 [01:32<01:58,  1.48it/s] 44%|████▍     | 138/313 [01:33<01:56,  1.50it/s] 44%|████▍     | 139/313 [01:34<01:54,  1.51it/s] 45%|████▍     | 140/313 [01:34<01:51,  1.56it/s] 45%|████▌     | 141/313 [01:35<01:48,  1.58it/s] 45%|████▌     | 142/313 [01:35<01:46,  1.60it/s] 46%|████▌     | 143/313 [01:36<01:44,  1.63it/s] 46%|████▌     | 144/313 [01:37<01:43,  1.63it/s] 46%|████▋     | 145/313 [01:37<01:41,  1.65it/s] 47%|████▋     | 146/313 [01:38<01:41,  1.65it/s] 47%|████▋     | 147/313 [01:38<01:39,  1.66it/s] 47%|████▋     | 148/313 [01:39<01:39,  1.65it/s] 48%|████▊     | 149/313 [01:40<01:38,  1.66it/s] 48%|████▊     | 150/313 [01:40<01:38,  1.66it/s] 48%|████▊     | 151/313 [01:41<01:37,  1.66it/s] 49%|████▊     | 152/313 [01:41<01:38,  1.63it/s] 49%|████▉     | 153/313 [01:42<01:37,  1.64it/s] 49%|████▉     | 154/313 [01:43<01:36,  1.65it/s] 50%|████▉     | 155/313 [01:43<01:35,  1.66it/s] 50%|████▉     | 156/313 [01:44<01:34,  1.66it/s] 50%|█████     | 157/313 [01:44<01:36,  1.61it/s] 50%|█████     | 158/313 [01:45<01:39,  1.55it/s] 51%|█████     | 159/313 [01:46<01:39,  1.55it/s] 51%|█████     | 160/313 [01:46<01:36,  1.58it/s] 51%|█████▏    | 161/313 [01:47<01:34,  1.60it/s] 52%|█████▏    | 162/313 [01:48<01:32,  1.63it/s] 52%|█████▏    | 163/313 [01:48<01:31,  1.65it/s] 52%|█████▏    | 164/313 [01:49<01:30,  1.64it/s] 53%|█████▎    | 165/313 [01:49<01:31,  1.62it/s] 53%|█████▎    | 166/313 [01:50<01:30,  1.62it/s] 53%|█████▎    | 167/313 [01:51<01:31,  1.60it/s] 54%|█████▎    | 168/313 [01:51<01:29,  1.62it/s] 54%|█████▍    | 169/313 [01:52<01:28,  1.63it/s] 54%|█████▍    | 170/313 [01:53<01:27,  1.64it/s] 55%|█████▍    | 171/313 [01:53<01:26,  1.63it/s] 55%|█████▍    | 172/313 [01:54<01:25,  1.65it/s] 55%|█████▌    | 173/313 [01:54<01:29,  1.57it/s] 56%|█████▌    | 174/313 [01:55<01:29,  1.55it/s] 56%|█████▌    | 175/313 [01:56<01:29,  1.53it/s] 56%|█████▌    | 176/313 [01:56<01:31,  1.50it/s] 57%|█████▋    | 177/313 [01:57<01:27,  1.55it/s] 57%|█████▋    | 178/313 [01:58<01:28,  1.53it/s] 57%|█████▋    | 179/313 [01:58<01:30,  1.47it/s] 58%|█████▊    | 180/313 [01:59<01:30,  1.46it/s] 58%|█████▊    | 181/313 [02:00<01:29,  1.48it/s] 58%|█████▊    | 182/313 [02:00<01:27,  1.49it/s] 58%|█████▊    | 183/313 [02:01<01:24,  1.54it/s] 59%|█████▉    | 184/313 [02:02<01:21,  1.58it/s] 59%|█████▉    | 185/313 [02:02<01:19,  1.61it/s] 59%|█████▉    | 186/313 [02:03<01:18,  1.62it/s] 60%|█████▉    | 187/313 [02:04<01:19,  1.59it/s] 60%|██████    | 188/313 [02:04<01:17,  1.61it/s] 60%|██████    | 189/313 [02:05<01:16,  1.62it/s] 61%|██████    | 190/313 [02:05<01:15,  1.63it/s] 61%|██████    | 191/313 [02:06<01:15,  1.62it/s] 61%|██████▏   | 192/313 [02:07<01:14,  1.63it/s] 62%|██████▏   | 193/313 [02:07<01:14,  1.62it/s] 62%|██████▏   | 194/313 [02:08<01:15,  1.59it/s] 62%|██████▏   | 195/313 [02:08<01:13,  1.62it/s] 63%|██████▎   | 196/313 [02:09<01:11,  1.63it/s] 63%|██████▎   | 197/313 [02:10<01:10,  1.64it/s] 63%|██████▎   | 198/313 [02:10<01:09,  1.65it/s] 64%|██████▎   | 199/313 [02:11<01:09,  1.65it/s] 64%|██████▍   | 200/313 [02:11<01:08,  1.66it/s] 64%|██████▍   | 201/313 [02:12<01:10,  1.59it/s] 65%|██████▍   | 202/313 [02:13<01:09,  1.61it/s] 65%|██████▍   | 203/313 [02:13<01:08,  1.62it/s] 65%|██████▌   | 204/313 [02:14<01:06,  1.63it/s] 65%|██████▌   | 205/313 [02:15<01:05,  1.64it/s] 66%|██████▌   | 206/313 [02:15<01:04,  1.66it/s] 66%|██████▌   | 207/313 [02:16<01:03,  1.66it/s] 66%|██████▋   | 208/313 [02:16<01:03,  1.67it/s] 67%|██████▋   | 209/313 [02:17<01:02,  1.67it/s] 67%|██████▋   | 210/313 [02:18<01:01,  1.67it/s] 67%|██████▋   | 211/313 [02:18<01:01,  1.66it/s] 68%|██████▊   | 212/313 [02:19<01:00,  1.66it/s] 68%|██████▊   | 213/313 [02:19<01:00,  1.66it/s] 68%|██████▊   | 214/313 [02:20<00:59,  1.66it/s] 69%|██████▊   | 215/313 [02:21<00:59,  1.65it/s] 69%|██████▉   | 216/313 [02:21<00:58,  1.66it/s] 69%|██████▉   | 217/313 [02:22<00:57,  1.67it/s] 70%|██████▉   | 218/313 [02:22<00:56,  1.67it/s] 70%|██████▉   | 219/313 [02:23<00:56,  1.67it/s] 70%|███████   | 220/313 [02:24<00:55,  1.67it/s] 71%|███████   | 221/313 [02:24<00:54,  1.68it/s] 71%|███████   | 222/313 [02:25<00:54,  1.67it/s] 71%|███████   | 223/313 [02:25<00:53,  1.67it/s] 72%|███████▏  | 224/313 [02:26<00:54,  1.63it/s] 72%|███████▏  | 225/313 [02:27<00:54,  1.60it/s] 72%|███████▏  | 226/313 [02:27<00:55,  1.58it/s] 73%|███████▎  | 227/313 [02:28<00:56,  1.52it/s] 73%|███████▎  | 228/313 [02:29<00:57,  1.49it/s] 73%|███████▎  | 229/313 [02:29<00:57,  1.46it/s] 73%|███████▎  | 230/313 [02:30<00:57,  1.45it/s] 74%|███████▍  | 231/313 [02:31<00:56,  1.44it/s] 74%|███████▍  | 232/313 [02:32<00:56,  1.44it/s] 74%|███████▍  | 233/313 [02:32<00:55,  1.44it/s] 75%|███████▍  | 234/313 [02:33<00:53,  1.49it/s] 75%|███████▌  | 235/313 [02:33<00:50,  1.53it/s] 75%|███████▌  | 236/313 [02:34<00:49,  1.57it/s] 76%|███████▌  | 237/313 [02:35<00:47,  1.60it/s] 76%|███████▌  | 238/313 [02:35<00:46,  1.61it/s] 76%|███████▋  | 239/313 [02:36<00:45,  1.62it/s] 77%|███████▋  | 240/313 [02:37<00:45,  1.60it/s] 77%|███████▋  | 241/313 [02:37<00:46,  1.54it/s] 77%|███████▋  | 242/313 [02:38<00:47,  1.50it/s] 78%|███████▊  | 243/313 [02:39<00:47,  1.48it/s] 78%|███████▊  | 244/313 [02:39<00:47,  1.44it/s] 78%|███████▊  | 245/313 [02:40<00:47,  1.43it/s] 79%|███████▊  | 246/313 [02:41<00:46,  1.43it/s] 79%|███████▉  | 247/313 [02:41<00:45,  1.46it/s] 79%|███████▉  | 248/313 [02:42<00:45,  1.44it/s] 80%|███████▉  | 249/313 [02:43<00:43,  1.47it/s] 80%|███████▉  | 250/313 [02:43<00:41,  1.52it/s] 80%|████████  | 251/313 [02:44<00:39,  1.55it/s] 81%|████████  | 252/313 [02:45<00:39,  1.56it/s] 81%|████████  | 253/313 [02:45<00:40,  1.50it/s] 81%|████████  | 254/313 [02:46<00:40,  1.47it/s] 81%|████████▏ | 255/313 [02:47<00:38,  1.49it/s] 82%|████████▏ | 256/313 [02:47<00:38,  1.47it/s] 82%|████████▏ | 257/313 [02:48<00:37,  1.48it/s] 82%|████████▏ | 258/313 [02:49<00:37,  1.46it/s] 83%|████████▎ | 259/313 [02:50<00:37,  1.45it/s] 83%|████████▎ | 260/313 [02:50<00:35,  1.50it/s] 83%|████████▎ | 261/313 [02:51<00:34,  1.49it/s] 84%|████████▎ | 262/313 [02:52<00:34,  1.47it/s] 84%|████████▍ | 263/313 [02:52<00:33,  1.48it/s] 84%|████████▍ | 264/313 [02:53<00:32,  1.50it/s] 85%|████████▍ | 265/313 [02:54<00:32,  1.47it/s] 85%|████████▍ | 266/313 [02:54<00:31,  1.49it/s] 85%|████████▌ | 267/313 [02:55<00:31,  1.47it/s] 86%|████████▌ | 268/313 [02:56<00:31,  1.44it/s] 86%|████████▌ | 269/313 [02:56<00:31,  1.41it/s] 86%|████████▋ | 270/313 [02:57<00:30,  1.39it/s] 87%|████████▋ | 271/313 [02:58<00:30,  1.39it/s] 87%|████████▋ | 272/313 [02:58<00:28,  1.42it/s] 87%|████████▋ | 273/313 [02:59<00:27,  1.43it/s] 88%|████████▊ | 274/313 [03:00<00:26,  1.45it/s] 88%|████████▊ | 275/313 [03:01<00:26,  1.43it/s] 88%|████████▊ | 276/313 [03:01<00:24,  1.50it/s] 88%|████████▊ | 277/313 [03:02<00:23,  1.54it/s] 89%|████████▉ | 278/313 [03:02<00:23,  1.52it/s] 89%|████████▉ | 279/313 [03:03<00:22,  1.49it/s] 89%|████████▉ | 280/313 [03:04<00:23,  1.43it/s] 90%|████████▉ | 281/313 [03:05<00:22,  1.43it/s] 90%|█████████ | 282/313 [03:05<00:21,  1.42it/s] 90%|█████████ | 283/313 [03:06<00:21,  1.42it/s] 91%|█████████ | 284/313 [03:07<00:20,  1.42it/s] 91%|█████████ | 285/313 [03:07<00:20,  1.40it/s] 91%|█████████▏| 286/313 [03:08<00:19,  1.40it/s] 92%|█████████▏| 287/313 [03:09<00:18,  1.40it/s] 92%|█████████▏| 288/313 [03:10<00:17,  1.42it/s] 92%|█████████▏| 289/313 [03:10<00:16,  1.42it/s] 93%|█████████▎| 290/313 [03:11<00:15,  1.44it/s] 93%|█████████▎| 291/313 [03:12<00:15,  1.46it/s] 93%|█████████▎| 292/313 [03:12<00:14,  1.49it/s] 94%|█████████▎| 293/313 [03:13<00:13,  1.51it/s] 94%|█████████▍| 294/313 [03:14<00:12,  1.53it/s] 94%|█████████▍| 295/313 [03:14<00:11,  1.53it/s] 95%|█████████▍| 296/313 [03:15<00:10,  1.57it/s] 95%|█████████▍| 297/313 [03:15<00:09,  1.62it/s] 95%|█████████▌| 298/313 [03:16<00:09,  1.64it/s] 96%|█████████▌| 299/313 [03:17<00:08,  1.66it/s] 96%|█████████▌| 300/313 [03:17<00:07,  1.67it/s] 96%|█████████▌| 301/313 [03:18<00:07,  1.67it/s] 96%|█████████▋| 302/313 [03:18<00:06,  1.64it/s] 97%|█████████▋| 303/313 [03:19<00:06,  1.67it/s] 97%|█████████▋| 304/313 [03:20<00:05,  1.68it/s] 97%|█████████▋| 305/313 [03:20<00:04,  1.69it/s] 98%|█████████▊| 306/313 [03:21<00:04,  1.70it/s] 98%|█████████▊| 307/313 [03:21<00:03,  1.70it/s] 98%|█████████▊| 308/313 [03:22<00:02,  1.71it/s] 99%|█████████▊| 309/313 [03:22<00:02,  1.72it/s] 99%|█████████▉| 310/313 [03:23<00:01,  1.72it/s] 99%|█████████▉| 311/313 [03:24<00:01,  1.71it/s]100%|█████████▉| 312/313 [03:24<00:00,  1.71it/s]100%|██████████| 313/313 [03:24<00:00,  2.00it/s]100%|██████████| 313/313 [03:25<00:00,  1.53it/s]
Epoch: [0][  0/313]	Time  5.425 ( 5.425)	Data  2.691 ( 2.691)	Loss 4.4141e+00 (4.4141e+00)	Acc@1  86.72 ( 86.72)
Epoch: [0][ 10/313]	Time  0.653 ( 1.108)	Data  0.014 ( 0.271)	Loss 4.6655e-01 (8.6386e-01)	Acc@1  88.28 ( 88.42)
Epoch: [0][ 20/313]	Time  0.654 ( 0.875)	Data  0.013 ( 0.151)	Loss 4.7485e-01 (6.7991e-01)	Acc@1  88.28 ( 88.50)
Epoch: [0][ 30/313]	Time  0.597 ( 0.791)	Data  0.017 ( 0.108)	Loss 4.8267e-01 (6.1444e-01)	Acc@1  89.84 ( 88.63)
Epoch: [0][ 40/313]	Time  0.604 ( 0.749)	Data  0.015 ( 0.086)	Loss 5.1514e-01 (5.8095e-01)	Acc@1  88.28 ( 88.72)
Epoch: [0][ 50/313]	Time  0.602 ( 0.720)	Data  0.015 ( 0.072)	Loss 6.2549e-01 (5.6449e-01)	Acc@1  83.59 ( 88.56)
Epoch: [0][ 60/313]	Time  0.644 ( 0.704)	Data  0.016 ( 0.063)	Loss 4.9072e-01 (5.5743e-01)	Acc@1  90.62 ( 88.47)
Epoch: [0][ 70/313]	Time  0.713 ( 0.695)	Data  0.040 ( 0.058)	Loss 4.4727e-01 (5.4408e-01)	Acc@1  89.84 ( 88.58)
Epoch: [0][ 80/313]	Time  0.713 ( 0.696)	Data  0.041 ( 0.055)	Loss 3.8306e-01 (5.3446e-01)	Acc@1  92.19 ( 88.58)
Epoch: [0][ 90/313]	Time  0.601 ( 0.694)	Data  0.015 ( 0.053)	Loss 4.9316e-01 (5.3251e-01)	Acc@1  88.28 ( 88.38)
Epoch: [0][100/313]	Time  0.648 ( 0.689)	Data  0.026 ( 0.050)	Loss 4.2383e-01 (5.2623e-01)	Acc@1  91.41 ( 88.45)
Epoch: [0][110/313]	Time  0.706 ( 0.684)	Data  0.045 ( 0.048)	Loss 5.0635e-01 (5.2168e-01)	Acc@1  86.72 ( 88.48)
Epoch: [0][120/313]	Time  0.601 ( 0.682)	Data  0.015 ( 0.046)	Loss 5.8740e-01 (5.1651e-01)	Acc@1  82.81 ( 88.58)
Epoch: [0][130/313]	Time  0.595 ( 0.676)	Data  0.015 ( 0.044)	Loss 4.4238e-01 (5.1530e-01)	Acc@1  90.62 ( 88.53)
Epoch: [0][140/313]	Time  0.610 ( 0.676)	Data  0.015 ( 0.042)	Loss 5.1953e-01 (5.1261e-01)	Acc@1  88.28 ( 88.53)
Epoch: [0][150/313]	Time  0.594 ( 0.671)	Data  0.015 ( 0.040)	Loss 5.8105e-01 (5.1152e-01)	Acc@1  84.38 ( 88.49)
Epoch: [0][160/313]	Time  0.603 ( 0.668)	Data  0.015 ( 0.039)	Loss 4.8853e-01 (5.1110e-01)	Acc@1  87.50 ( 88.46)
Epoch: [0][170/313]	Time  0.619 ( 0.664)	Data  0.015 ( 0.038)	Loss 5.3369e-01 (5.0837e-01)	Acc@1  85.94 ( 88.49)
Epoch: [0][180/313]	Time  0.663 ( 0.665)	Data  0.024 ( 0.037)	Loss 4.8145e-01 (5.0787e-01)	Acc@1  89.06 ( 88.45)
Epoch: [0][190/313]	Time  0.624 ( 0.662)	Data  0.015 ( 0.036)	Loss 5.5371e-01 (5.0561e-01)	Acc@1  85.16 ( 88.51)
Epoch: [0][200/313]	Time  0.682 ( 0.660)	Data  0.030 ( 0.035)	Loss 3.9917e-01 (5.0429e-01)	Acc@1  90.62 ( 88.54)
Epoch: [0][210/313]	Time  0.610 ( 0.657)	Data  0.015 ( 0.034)	Loss 4.2773e-01 (5.0319e-01)	Acc@1  89.84 ( 88.53)
Epoch: [0][220/313]	Time  0.591 ( 0.655)	Data  0.015 ( 0.033)	Loss 5.6055e-01 (5.0164e-01)	Acc@1  86.72 ( 88.57)
Epoch: [0][230/313]	Time  0.702 ( 0.655)	Data  0.039 ( 0.033)	Loss 4.5947e-01 (5.0111e-01)	Acc@1  91.41 ( 88.57)
Epoch: [0][240/313]	Time  0.704 ( 0.654)	Data  0.037 ( 0.033)	Loss 4.0552e-01 (4.9911e-01)	Acc@1  91.41 ( 88.62)
Epoch: [0][250/313]	Time  0.603 ( 0.655)	Data  0.015 ( 0.033)	Loss 5.4883e-01 (4.9864e-01)	Acc@1  86.72 ( 88.64)
Epoch: [0][260/313]	Time  0.685 ( 0.656)	Data  0.043 ( 0.033)	Loss 4.2310e-01 (4.9877e-01)	Acc@1  89.84 ( 88.62)
Epoch: [0][270/313]	Time  0.714 ( 0.658)	Data  0.072 ( 0.033)	Loss 4.5703e-01 (4.9806e-01)	Acc@1  89.06 ( 88.64)
Epoch: [0][280/313]	Time  0.704 ( 0.659)	Data  0.049 ( 0.033)	Loss 4.7559e-01 (4.9757e-01)	Acc@1  89.84 ( 88.66)
Epoch: [0][290/313]	Time  0.656 ( 0.660)	Data  0.023 ( 0.033)	Loss 4.7900e-01 (4.9754e-01)	Acc@1  88.28 ( 88.64)
Epoch: [0][300/313]	Time  0.596 ( 0.658)	Data  0.015 ( 0.033)	Loss 4.8853e-01 (4.9665e-01)	Acc@1  88.28 ( 88.63)
Epoch: [0][310/313]	Time  0.600 ( 0.656)	Data  0.015 ( 0.032)	Loss 4.0625e-01 (4.9727e-01)	Acc@1  90.62 ( 88.60)
  0%|          | 0/79 [00:00<?, ?it/s]  0%|          | 0/79 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/.//main.py", line 150, in <module>
    main()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/.//main.py", line 144, in main
    learn.run()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/learner.py", line 152, in run
    acc1 = self.evaluate()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/learner.py", line 307, in evaluate
    loss = self.criterion(output, target)
  File "/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1174, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/functional.py", line 3026, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument target in method wrapper_nll_loss_forward)
