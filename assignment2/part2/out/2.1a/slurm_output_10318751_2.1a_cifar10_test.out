Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:03, 352256.73it/s]  0%|          | 131072/170498071 [00:00<06:04, 466798.66it/s]  0%|          | 196608/170498071 [00:00<06:57, 407967.68it/s]  0%|          | 294912/170498071 [00:00<05:04, 558788.13it/s]  0%|          | 425984/170498071 [00:00<04:33, 621208.93it/s]  0%|          | 753664/170498071 [00:00<02:13, 1276194.21it/s]  1%|          | 1277952/170498071 [00:00<01:13, 2306637.12it/s]  1%|▏         | 2457600/170498071 [00:01<00:34, 4878815.67it/s]  2%|▏         | 4096000/170498071 [00:01<00:20, 8080963.35it/s]  3%|▎         | 5832704/170498071 [00:01<00:15, 10673870.45it/s]  4%|▍         | 7602176/170498071 [00:01<00:12, 12625759.52it/s]  6%|▌         | 9404416/170498071 [00:01<00:11, 14138536.48it/s]  7%|▋         | 11370496/170498071 [00:01<00:10, 15744649.20it/s]  8%|▊         | 13336576/170498071 [00:01<00:09, 16873158.68it/s]  9%|▉         | 15335424/170498071 [00:01<00:08, 17786383.17it/s] 10%|█         | 17465344/170498071 [00:01<00:08, 18824892.93it/s] 12%|█▏        | 19628032/170498071 [00:01<00:07, 19644557.31it/s] 13%|█▎        | 21790720/170498071 [00:02<00:07, 20229826.33it/s] 14%|█▍        | 24150016/170498071 [00:02<00:06, 21221189.29it/s] 16%|█▌        | 26476544/170498071 [00:02<00:06, 21779126.40it/s] 17%|█▋        | 28999680/170498071 [00:02<00:06, 22799411.59it/s] 19%|█▊        | 31555584/170498071 [00:02<00:05, 23450690.04it/s] 20%|██        | 34144256/170498071 [00:02<00:05, 23998163.55it/s] 22%|██▏       | 36864000/170498071 [00:02<00:05, 24918248.21it/s] 23%|██▎       | 39682048/170498071 [00:02<00:05, 25834886.44it/s] 25%|██▌       | 42663936/170498071 [00:02<00:04, 27001682.26it/s] 27%|██▋       | 45514752/170498071 [00:02<00:04, 27420167.21it/s] 28%|██▊       | 48463872/170498071 [00:03<00:04, 27995720.58it/s] 30%|███       | 51675136/170498071 [00:03<00:04, 29212908.54it/s] 32%|███▏      | 54788096/170498071 [00:03<00:03, 29649129.41it/s] 34%|███▍      | 57999360/170498071 [00:03<00:03, 30379310.62it/s] 36%|███▌      | 61112320/170498071 [00:03<00:03, 28075068.08it/s] 38%|███▊      | 64258048/170498071 [00:03<00:03, 29026430.69it/s] 40%|███▉      | 67403776/170498071 [00:03<00:03, 29388227.28it/s] 41%|████▏     | 70549504/170498071 [00:03<00:03, 29970186.13it/s] 43%|████▎     | 73728000/170498071 [00:03<00:03, 30184942.67it/s] 45%|████▌     | 76840960/170498071 [00:04<00:03, 30458543.09it/s] 47%|████▋     | 79921152/170498071 [00:04<00:02, 30423097.30it/s] 49%|████▊     | 83066880/170498071 [00:04<00:02, 30635006.16it/s] 51%|█████     | 86245376/170498071 [00:04<00:02, 30759532.12it/s] 52%|█████▏    | 89325568/170498071 [00:04<00:02, 30720103.68it/s] 54%|█████▍    | 92405760/170498071 [00:04<00:02, 30700049.28it/s] 56%|█████▌    | 95485952/170498071 [00:04<00:02, 30639823.29it/s] 58%|█████▊    | 98566144/170498071 [00:04<00:02, 30478065.62it/s] 60%|█████▉    | 101777408/170498071 [00:04<00:02, 30931918.96it/s] 62%|██████▏   | 104923136/170498071 [00:04<00:02, 30996617.34it/s] 63%|██████▎   | 108167168/170498071 [00:05<00:02, 31125023.89it/s] 65%|██████▌   | 111280128/170498071 [00:05<00:01, 30324644.39it/s] 67%|██████▋   | 114491392/170498071 [00:05<00:01, 30579535.49it/s] 69%|██████▉   | 117669888/170498071 [00:05<00:01, 30562340.04it/s] 71%|███████   | 120750080/170498071 [00:05<00:01, 30535684.37it/s] 73%|███████▎  | 123928576/170498071 [00:05<00:01, 30867728.60it/s] 75%|███████▍  | 127139840/170498071 [00:05<00:01, 31227653.69it/s] 76%|███████▋  | 130351104/170498071 [00:05<00:01, 31484490.77it/s] 78%|███████▊  | 133529600/170498071 [00:05<00:01, 31110509.41it/s] 80%|████████  | 136708096/170498071 [00:05<00:01, 31296784.18it/s] 82%|████████▏ | 139853824/170498071 [00:06<00:00, 31315651.98it/s] 84%|████████▍ | 142999552/170498071 [00:06<00:00, 30814511.12it/s] 86%|████████▌ | 146210816/170498071 [00:06<00:00, 30971549.18it/s] 88%|████████▊ | 149422080/170498071 [00:06<00:00, 31282597.20it/s] 90%|████████▉ | 152633344/170498071 [00:06<00:00, 31515741.58it/s] 91%|█████████▏| 155811840/170498071 [00:06<00:00, 31346993.75it/s] 93%|█████████▎| 158957568/170498071 [00:06<00:00, 30456824.99it/s] 95%|█████████▌| 162201600/170498071 [00:06<00:00, 31018324.49it/s] 97%|█████████▋| 165347328/170498071 [00:06<00:00, 31114900.65it/s] 99%|█████████▉| 168493056/170498071 [00:06<00:00, 30830315.71it/s]100%|██████████| 170498071/170498071 [00:07<00:00, 24132042.45it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Using prompt template: This is a photo of a {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 2.76M/338M [00:00<00:12, 28.9MiB/s]  4%|█▋                                    | 14.9M/338M [00:00<00:03, 86.6MiB/s]  8%|███▎                                   | 28.4M/338M [00:00<00:02, 112MiB/s] 12%|████▊                                  | 41.9M/338M [00:00<00:02, 123MiB/s] 16%|██████▎                                | 55.0M/338M [00:00<00:02, 128MiB/s] 20%|███████▉                               | 68.3M/338M [00:00<00:02, 132MiB/s] 24%|█████████▍                             | 81.8M/338M [00:00<00:01, 135MiB/s] 28%|██████████▉                            | 94.7M/338M [00:00<00:01, 135MiB/s] 33%|█████████████                           | 110M/338M [00:00<00:01, 143MiB/s] 37%|██████████████▋                         | 123M/338M [00:01<00:01, 139MiB/s] 41%|████████████████▏                       | 137M/338M [00:01<00:01, 134MiB/s] 44%|█████████████████▋                      | 150M/338M [00:01<00:01, 132MiB/s] 48%|███████████████████▏                    | 162M/338M [00:01<00:01, 128MiB/s] 52%|████████████████████▋                   | 174M/338M [00:01<00:01, 127MiB/s] 55%|██████████████████████                  | 187M/338M [00:01<00:01, 126MiB/s] 59%|███████████████████████▌                | 199M/338M [00:01<00:01, 125MiB/s] 62%|████████████████████████▉               | 211M/338M [00:01<00:01, 125MiB/s] 66%|██████████████████████████▎             | 223M/338M [00:01<00:00, 125MiB/s] 69%|███████████████████████████▊            | 234M/338M [00:01<00:00, 124MiB/s] 73%|█████████████████████████████▏          | 246M/338M [00:02<00:00, 124MiB/s] 77%|██████████████████████████████▌         | 258M/338M [00:02<00:00, 124MiB/s] 80%|████████████████████████████████        | 270M/338M [00:02<00:00, 124MiB/s] 84%|█████████████████████████████████▍      | 282M/338M [00:02<00:00, 125MiB/s] 87%|██████████████████████████████████▊     | 294M/338M [00:02<00:00, 124MiB/s] 91%|████████████████████████████████████▎   | 306M/338M [00:02<00:00, 125MiB/s] 94%|█████████████████████████████████████▋  | 318M/338M [00:02<00:00, 122MiB/s] 98%|███████████████████████████████████████ | 330M/338M [00:02<00:00, 110MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 122MiB/s]


List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Precomputing text features
Iterating over test set of cifar10
Starting inference...
Zero-shot CLIP top-1 accuracy on cifar10/test: [75.]
