Running experiment on cifar10 with fixed_patch and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=12, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=True, root='/scratch/lcur0640', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:30, 333916.31it/s]  0%|          | 163840/170498071 [00:00<06:33, 432562.83it/s]  0%|          | 327680/170498071 [00:00<03:34, 793760.64it/s]  0%|          | 622592/170498071 [00:00<01:57, 1439671.40it/s]  1%|          | 1212416/170498071 [00:00<01:15, 2255694.44it/s]  1%|▏         | 2424832/170498071 [00:00<00:35, 4754418.42it/s]  2%|▏         | 4063232/170498071 [00:00<00:21, 7731506.59it/s]  3%|▎         | 5865472/170498071 [00:01<00:15, 10536482.76it/s]  4%|▍         | 7667712/170498071 [00:01<00:12, 12631965.13it/s]  6%|▌         | 9535488/170498071 [00:01<00:11, 14351467.59it/s]  7%|▋         | 11534336/170498071 [00:01<00:09, 15976322.59it/s]  8%|▊         | 13598720/170498071 [00:01<00:09, 17333848.96it/s]  9%|▉         | 15794176/170498071 [00:01<00:08, 18681716.95it/s] 11%|█         | 18120704/170498071 [00:01<00:07, 20028144.76it/s] 12%|█▏        | 20545536/170498071 [00:01<00:07, 21259421.81it/s] 13%|█▎        | 23003136/170498071 [00:01<00:07, 20682516.91it/s] 15%|█▌        | 25591808/170498071 [00:02<00:06, 22128858.24it/s] 17%|█▋        | 28278784/170498071 [00:02<00:06, 21418312.02it/s] 18%|█▊        | 31031296/170498071 [00:02<00:06, 23002869.12it/s] 20%|█▉        | 33816576/170498071 [00:02<00:05, 24333634.91it/s] 22%|██▏       | 36732928/170498071 [00:02<00:05, 25113296.04it/s] 23%|██▎       | 40009728/170498071 [00:02<00:04, 27278591.02it/s] 25%|██▌       | 42795008/170498071 [00:02<00:05, 22315035.59it/s] 27%|██▋       | 45711360/170498071 [00:02<00:05, 24032242.83it/s] 28%|██▊       | 48267264/170498071 [00:03<00:06, 19495288.70it/s] 30%|██▉       | 50462720/170498071 [00:03<00:06, 19885728.68it/s] 31%|███       | 52625408/170498071 [00:03<00:05, 20133487.44it/s] 32%|███▏      | 54788096/170498071 [00:03<00:06, 16820417.50it/s] 33%|███▎      | 56754176/170498071 [00:03<00:06, 17478768.75it/s] 34%|███▍      | 58818560/170498071 [00:03<00:06, 18262189.76it/s] 36%|███▌      | 60981248/170498071 [00:03<00:05, 19124129.19it/s] 37%|███▋      | 63209472/170498071 [00:03<00:05, 19980956.28it/s] 38%|███▊      | 65503232/170498071 [00:03<00:05, 20806141.11it/s] 40%|███▉      | 67993600/170498071 [00:04<00:04, 21957592.67it/s] 41%|████▏     | 70418432/170498071 [00:04<00:04, 22614631.10it/s] 43%|████▎     | 72744960/170498071 [00:04<00:04, 22656759.98it/s] 44%|████▍     | 75464704/170498071 [00:04<00:03, 23983426.87it/s] 46%|████▌     | 78151680/170498071 [00:04<00:03, 24821950.51it/s] 48%|████▊     | 81100800/170498071 [00:04<00:03, 26189568.57it/s] 49%|████▉     | 83951616/170498071 [00:04<00:03, 26874247.80it/s] 51%|█████     | 86835200/170498071 [00:04<00:03, 27455356.96it/s] 53%|█████▎    | 89817088/170498071 [00:04<00:02, 28151024.22it/s] 54%|█████▍    | 92733440/170498071 [00:04<00:02, 28438864.56it/s] 56%|█████▌    | 95682560/170498071 [00:05<00:02, 28737784.30it/s] 58%|█████▊    | 98992128/170498071 [00:05<00:02, 30037694.83it/s] 60%|█████▉    | 102006784/170498071 [00:05<00:02, 29879695.10it/s] 62%|██████▏   | 105021440/170498071 [00:05<00:02, 29946725.29it/s] 63%|██████▎   | 108036096/170498071 [00:05<00:02, 29926734.97it/s] 65%|██████▌   | 111050752/170498071 [00:05<00:01, 29935692.55it/s] 67%|██████▋   | 114262016/170498071 [00:05<00:01, 30358592.94it/s] 69%|██████▉   | 117571584/170498071 [00:05<00:01, 31151145.46it/s] 71%|███████   | 120815616/170498071 [00:05<00:01, 28142434.51it/s] 73%|███████▎  | 123961344/170498071 [00:05<00:01, 28557322.75it/s] 75%|███████▍  | 127107072/170498071 [00:06<00:01, 28770114.26it/s] 76%|███████▋  | 130252800/170498071 [00:06<00:01, 29299230.96it/s] 78%|███████▊  | 133496832/170498071 [00:06<00:01, 30185505.35it/s] 80%|████████  | 136740864/170498071 [00:06<00:01, 30820071.21it/s] 82%|████████▏ | 139984896/170498071 [00:06<00:00, 31275846.38it/s] 84%|████████▍ | 143261696/170498071 [00:06<00:00, 31698893.00it/s] 86%|████████▌ | 146472960/170498071 [00:06<00:00, 31705599.35it/s] 88%|████████▊ | 149651456/170498071 [00:06<00:00, 31490447.13it/s] 90%|████████▉ | 152829952/170498071 [00:06<00:00, 30653824.10it/s] 91%|█████████▏| 155910144/170498071 [00:07<00:00, 30561480.77it/s] 93%|█████████▎| 158990336/170498071 [00:07<00:00, 30495902.51it/s] 95%|█████████▌| 162168832/170498071 [00:07<00:00, 30628092.80it/s] 97%|█████████▋| 165347328/170498071 [00:07<00:00, 30968012.22it/s] 99%|█████████▉| 168591360/170498071 [00:07<00:00, 31403005.52it/s]100%|██████████| 170498071/170498071 [00:07<00:00, 22804183.35it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 2.89M/338M [00:00<00:11, 29.4MiB/s]  5%|██                                     | 17.5M/338M [00:00<00:03, 101MiB/s]  9%|███▋                                   | 31.9M/338M [00:00<00:02, 124MiB/s] 14%|█████▍                                 | 46.8M/338M [00:00<00:02, 136MiB/s] 18%|███████                                | 61.1M/338M [00:00<00:02, 141MiB/s] 22%|████████▊                              | 75.9M/338M [00:00<00:01, 146MiB/s] 27%|██████████▍                            | 90.3M/338M [00:00<00:01, 147MiB/s] 31%|████████████▍                           | 105M/338M [00:00<00:01, 150MiB/s] 35%|██████████████▏                         | 120M/338M [00:00<00:01, 151MiB/s] 40%|███████████████▉                        | 134M/338M [00:01<00:01, 139MiB/s] 44%|█████████████████▍                      | 148M/338M [00:01<00:01, 127MiB/s] 47%|██████████████████▉                     | 160M/338M [00:01<00:01, 121MiB/s] 51%|████████████████████▎                   | 172M/338M [00:01<00:01, 116MiB/s] 54%|█████████████████████▋                  | 183M/338M [00:01<00:01, 114MiB/s] 57%|██████████████████████▉                 | 194M/338M [00:01<00:01, 110MiB/s] 61%|███████████████████████▌               | 204M/338M [00:01<00:01, 97.3MiB/s] 63%|████████████████████████▋              | 214M/338M [00:01<00:01, 90.1MiB/s] 66%|█████████████████████████▋             | 223M/338M [00:02<00:01, 86.3MiB/s] 68%|██████████████████████████▋            | 231M/338M [00:02<00:01, 83.2MiB/s] 71%|███████████████████████████▋           | 239M/338M [00:02<00:01, 80.5MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:02<00:01, 80.1MiB/s] 75%|█████████████████████████████▍         | 255M/338M [00:02<00:01, 78.2MiB/s] 78%|██████████████████████████████▎        | 262M/338M [00:02<00:01, 77.8MiB/s] 80%|███████████████████████████████▏       | 269M/338M [00:02<00:00, 75.9MiB/s] 82%|███████████████████████████████▉       | 277M/338M [00:02<00:00, 75.2MiB/s] 84%|████████████████████████████████▊      | 284M/338M [00:02<00:00, 75.1MiB/s] 86%|█████████████████████████████████▋     | 291M/338M [00:02<00:00, 75.5MiB/s] 88%|██████████████████████████████████▍    | 298M/338M [00:03<00:00, 70.8MiB/s] 90%|███████████████████████████████████▎   | 305M/338M [00:03<00:00, 64.9MiB/s] 92%|███████████████████████████████████▉   | 312M/338M [00:03<00:00, 62.2MiB/s] 94%|████████████████████████████████████▋  | 318M/338M [00:03<00:00, 59.9MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:03<00:00, 57.9MiB/s] 97%|█████████████████████████████████████▉ | 329M/338M [00:03<00:00, 57.3MiB/s] 99%|██████████████████████████████████████▋| 334M/338M [00:03<00:00, 56.1MiB/s]100%|███████████████████████████████████████| 338M/338M [00:03<00:00, 91.6MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Visualizing prompt...
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
  0%|          | 0/313 [00:00<?, ?it/s]  0%|          | 1/313 [00:05<27:36,  5.31s/it]  1%|          | 2/313 [00:06<13:29,  2.60s/it]  1%|          | 3/313 [00:06<08:59,  1.74s/it]  1%|▏         | 4/313 [00:07<06:54,  1.34s/it]  2%|▏         | 5/313 [00:08<05:43,  1.12s/it]  2%|▏         | 6/313 [00:08<04:57,  1.03it/s]  2%|▏         | 7/313 [00:09<04:21,  1.17it/s]  3%|▎         | 8/313 [00:10<03:55,  1.30it/s]  3%|▎         | 9/313 [00:10<03:39,  1.39it/s]  3%|▎         | 10/313 [00:11<03:27,  1.46it/s]  4%|▎         | 11/313 [00:11<03:17,  1.53it/s]  4%|▍         | 12/313 [00:12<03:12,  1.56it/s]  4%|▍         | 13/313 [00:13<03:08,  1.59it/s]  4%|▍         | 14/313 [00:13<03:04,  1.62it/s]  5%|▍         | 15/313 [00:14<03:04,  1.62it/s]  5%|▌         | 16/313 [00:14<03:05,  1.60it/s]  5%|▌         | 17/313 [00:15<03:14,  1.53it/s]  6%|▌         | 18/313 [00:16<03:12,  1.53it/s]  6%|▌         | 19/313 [00:16<03:14,  1.51it/s]  6%|▋         | 20/313 [00:17<03:12,  1.52it/s]  7%|▋         | 21/313 [00:18<03:16,  1.48it/s]  7%|▋         | 22/313 [00:19<03:19,  1.46it/s]  7%|▋         | 23/313 [00:19<03:22,  1.43it/s]  8%|▊         | 24/313 [00:20<03:25,  1.41it/s]  8%|▊         | 25/313 [00:21<03:25,  1.40it/s]  8%|▊         | 26/313 [00:21<03:26,  1.39it/s]  9%|▊         | 27/313 [00:22<03:21,  1.42it/s]  9%|▉         | 28/313 [00:23<03:24,  1.39it/s]  9%|▉         | 29/313 [00:24<03:26,  1.38it/s] 10%|▉         | 30/313 [00:24<03:27,  1.37it/s] 10%|▉         | 31/313 [00:25<03:20,  1.41it/s] 10%|█         | 32/313 [00:26<03:16,  1.43it/s] 11%|█         | 33/313 [00:26<03:07,  1.49it/s] 11%|█         | 34/313 [00:27<03:01,  1.53it/s] 11%|█         | 35/313 [00:28<03:04,  1.50it/s] 12%|█▏        | 36/313 [00:28<03:10,  1.45it/s] 12%|█▏        | 37/313 [00:29<03:15,  1.41it/s] 12%|█▏        | 38/313 [00:30<03:15,  1.40it/s] 12%|█▏        | 39/313 [00:30<03:05,  1.48it/s] 13%|█▎        | 40/313 [00:31<02:59,  1.52it/s] 13%|█▎        | 41/313 [00:32<02:54,  1.55it/s] 13%|█▎        | 42/313 [00:32<02:57,  1.53it/s] 14%|█▎        | 43/313 [00:33<03:00,  1.50it/s] 14%|█▍        | 44/313 [00:34<03:02,  1.48it/s] 14%|█▍        | 45/313 [00:34<03:05,  1.45it/s] 15%|█▍        | 46/313 [00:35<03:01,  1.47it/s] 15%|█▌        | 47/313 [00:36<02:54,  1.52it/s] 15%|█▌        | 48/313 [00:36<02:56,  1.50it/s] 16%|█▌        | 49/313 [00:37<02:57,  1.49it/s] 16%|█▌        | 50/313 [00:38<02:59,  1.46it/s] 16%|█▋        | 51/313 [00:38<02:58,  1.47it/s] 17%|█▋        | 52/313 [00:39<02:59,  1.45it/s] 17%|█▋        | 53/313 [00:40<03:01,  1.43it/s] 17%|█▋        | 54/313 [00:41<03:03,  1.41it/s] 18%|█▊        | 55/313 [00:41<03:05,  1.39it/s] 18%|█▊        | 56/313 [00:42<03:05,  1.38it/s] 18%|█▊        | 57/313 [00:43<03:01,  1.41it/s] 19%|█▊        | 58/313 [00:43<02:59,  1.42it/s] 19%|█▉        | 59/313 [00:44<02:56,  1.44it/s] 19%|█▉        | 60/313 [00:45<02:57,  1.42it/s] 19%|█▉        | 61/313 [00:46<02:54,  1.44it/s] 20%|█▉        | 62/313 [00:46<02:48,  1.49it/s] 20%|██        | 63/313 [00:47<02:47,  1.50it/s] 20%|██        | 64/313 [00:47<02:41,  1.55it/s] 21%|██        | 65/313 [00:48<02:38,  1.56it/s] 21%|██        | 66/313 [00:49<02:36,  1.58it/s] 21%|██▏       | 67/313 [00:49<02:33,  1.61it/s] 22%|██▏       | 68/313 [00:50<02:30,  1.62it/s] 22%|██▏       | 69/313 [00:51<02:32,  1.60it/s] 22%|██▏       | 70/313 [00:51<02:38,  1.53it/s] 23%|██▎       | 71/313 [00:52<02:38,  1.53it/s] 23%|██▎       | 72/313 [00:53<02:47,  1.44it/s] 23%|██▎       | 73/313 [00:53<02:42,  1.47it/s] 24%|██▎       | 74/313 [00:54<02:40,  1.49it/s] 24%|██▍       | 75/313 [00:55<02:39,  1.49it/s] 24%|██▍       | 76/313 [00:55<02:37,  1.50it/s] 25%|██▍       | 77/313 [00:56<02:38,  1.49it/s] 25%|██▍       | 78/313 [00:57<02:36,  1.50it/s] 25%|██▌       | 79/313 [00:57<02:39,  1.46it/s] 26%|██▌       | 80/313 [00:58<02:38,  1.47it/s] 26%|██▌       | 81/313 [00:59<02:35,  1.50it/s] 26%|██▌       | 82/313 [00:59<02:33,  1.51it/s] 27%|██▋       | 83/313 [01:00<02:34,  1.49it/s] 27%|██▋       | 84/313 [01:01<02:33,  1.49it/s] 27%|██▋       | 85/313 [01:01<02:34,  1.47it/s] 27%|██▋       | 86/313 [01:02<02:37,  1.45it/s] 28%|██▊       | 87/313 [01:03<02:34,  1.46it/s] 28%|██▊       | 88/313 [01:03<02:36,  1.44it/s] 28%|██▊       | 89/313 [01:04<02:36,  1.43it/s] 29%|██▉       | 90/313 [01:05<02:35,  1.43it/s] 29%|██▉       | 91/313 [01:06<02:35,  1.43it/s] 29%|██▉       | 92/313 [01:06<02:35,  1.42it/s] 30%|██▉       | 93/313 [01:07<02:36,  1.41it/s] 30%|███       | 94/313 [01:08<02:35,  1.41it/s] 30%|███       | 95/313 [01:08<02:36,  1.39it/s] 31%|███       | 96/313 [01:09<02:35,  1.40it/s] 31%|███       | 97/313 [01:10<02:34,  1.40it/s] 31%|███▏      | 98/313 [01:11<02:31,  1.42it/s] 32%|███▏      | 99/313 [01:11<02:30,  1.42it/s] 32%|███▏      | 100/313 [01:12<02:32,  1.40it/s] 32%|███▏      | 101/313 [01:13<02:33,  1.39it/s] 33%|███▎      | 102/313 [01:13<02:28,  1.42it/s] 33%|███▎      | 103/313 [01:14<02:24,  1.45it/s] 33%|███▎      | 104/313 [01:15<02:19,  1.50it/s] 34%|███▎      | 105/313 [01:15<02:14,  1.55it/s] 34%|███▍      | 106/313 [01:16<02:15,  1.53it/s] 34%|███▍      | 107/313 [01:17<02:15,  1.52it/s] 35%|███▍      | 108/313 [01:17<02:14,  1.53it/s] 35%|███▍      | 109/313 [01:18<02:17,  1.49it/s] 35%|███▌      | 110/313 [01:19<02:19,  1.45it/s] 35%|███▌      | 111/313 [01:19<02:20,  1.44it/s] 36%|███▌      | 112/313 [01:20<02:21,  1.42it/s] 36%|███▌      | 113/313 [01:21<02:23,  1.39it/s] 36%|███▋      | 114/313 [01:22<02:22,  1.40it/s] 37%|███▋      | 115/313 [01:22<02:18,  1.43it/s] 37%|███▋      | 116/313 [01:23<02:18,  1.42it/s] 37%|███▋      | 117/313 [01:24<02:15,  1.45it/s] 38%|███▊      | 118/313 [01:24<02:13,  1.47it/s] 38%|███▊      | 119/313 [01:25<02:11,  1.47it/s] 38%|███▊      | 120/313 [01:26<02:10,  1.48it/s] 39%|███▊      | 121/313 [01:26<02:13,  1.44it/s] 39%|███▉      | 122/313 [01:27<02:11,  1.45it/s] 39%|███▉      | 123/313 [01:28<02:14,  1.42it/s] 40%|███▉      | 124/313 [01:28<02:10,  1.45it/s] 40%|███▉      | 125/313 [01:29<02:05,  1.50it/s] 40%|████      | 126/313 [01:30<02:01,  1.54it/s] 41%|████      | 127/313 [01:30<01:59,  1.55it/s] 41%|████      | 128/313 [01:31<02:01,  1.53it/s] 41%|████      | 129/313 [01:32<02:03,  1.49it/s] 42%|████▏     | 130/313 [01:32<02:02,  1.50it/s] 42%|████▏     | 131/313 [01:33<02:04,  1.46it/s] 42%|████▏     | 132/313 [01:34<02:05,  1.44it/s] 42%|████▏     | 133/313 [01:35<02:05,  1.43it/s] 43%|████▎     | 134/313 [01:35<02:02,  1.46it/s] 43%|████▎     | 135/313 [01:36<02:03,  1.45it/s] 43%|████▎     | 136/313 [01:37<02:03,  1.43it/s] 44%|████▍     | 137/313 [01:37<02:01,  1.45it/s] 44%|████▍     | 138/313 [01:38<01:59,  1.46it/s] 44%|████▍     | 139/313 [01:39<01:58,  1.47it/s] 45%|████▍     | 140/313 [01:39<01:57,  1.48it/s] 45%|████▌     | 141/313 [01:40<01:57,  1.46it/s] 45%|████▌     | 142/313 [01:41<01:59,  1.43it/s] 46%|████▌     | 143/313 [01:41<02:01,  1.40it/s] 46%|████▌     | 144/313 [01:42<02:00,  1.40it/s] 46%|████▋     | 145/313 [01:43<01:54,  1.47it/s] 47%|████▋     | 146/313 [01:43<01:53,  1.47it/s] 47%|████▋     | 147/313 [01:44<01:51,  1.48it/s] 47%|████▋     | 148/313 [01:45<01:54,  1.44it/s] 48%|████▊     | 149/313 [01:46<01:52,  1.45it/s] 48%|████▊     | 150/313 [01:46<01:54,  1.43it/s] 48%|████▊     | 151/313 [01:47<01:52,  1.44it/s] 49%|████▊     | 152/313 [01:48<01:52,  1.43it/s] 49%|████▉     | 153/313 [01:48<01:48,  1.48it/s] 49%|████▉     | 154/313 [01:49<01:45,  1.50it/s] 50%|████▉     | 155/313 [01:50<01:47,  1.47it/s] 50%|████▉     | 156/313 [01:50<01:46,  1.47it/s] 50%|█████     | 157/313 [01:51<01:47,  1.46it/s] 50%|█████     | 158/313 [01:52<01:45,  1.48it/s] 51%|█████     | 159/313 [01:52<01:40,  1.54it/s] 51%|█████     | 160/313 [01:53<01:40,  1.52it/s] 51%|█████▏    | 161/313 [01:54<01:43,  1.46it/s] 52%|█████▏    | 162/313 [01:54<01:40,  1.51it/s] 52%|█████▏    | 163/313 [01:55<01:40,  1.50it/s] 52%|█████▏    | 164/313 [01:56<01:39,  1.50it/s] 53%|█████▎    | 165/313 [01:56<01:38,  1.51it/s] 53%|█████▎    | 166/313 [01:57<01:37,  1.51it/s] 53%|█████▎    | 167/313 [01:58<01:35,  1.53it/s] 54%|█████▎    | 168/313 [01:58<01:38,  1.47it/s] 54%|█████▍    | 169/313 [01:59<01:39,  1.44it/s] 54%|█████▍    | 170/313 [02:00<01:39,  1.44it/s] 55%|█████▍    | 171/313 [02:00<01:40,  1.42it/s] 55%|█████▍    | 172/313 [02:01<01:39,  1.41it/s] 55%|█████▌    | 173/313 [02:02<01:37,  1.44it/s] 56%|█████▌    | 174/313 [02:03<01:36,  1.45it/s] 56%|█████▌    | 175/313 [02:03<01:35,  1.45it/s] 56%|█████▌    | 176/313 [02:04<01:37,  1.41it/s] 57%|█████▋    | 177/313 [02:05<01:37,  1.40it/s] 57%|█████▋    | 178/313 [02:05<01:36,  1.40it/s] 57%|█████▋    | 179/313 [02:06<01:34,  1.41it/s] 58%|█████▊    | 180/313 [02:07<01:32,  1.44it/s] 58%|█████▊    | 181/313 [02:08<01:33,  1.41it/s] 58%|█████▊    | 182/313 [02:08<01:30,  1.44it/s] 58%|█████▊    | 183/313 [02:09<01:30,  1.44it/s] 59%|█████▉    | 184/313 [02:10<01:30,  1.43it/s] 59%|█████▉    | 185/313 [02:10<01:31,  1.41it/s] 59%|█████▉    | 186/313 [02:11<01:28,  1.43it/s] 60%|█████▉    | 187/313 [02:12<01:30,  1.40it/s] 60%|██████    | 188/313 [02:12<01:27,  1.43it/s] 60%|██████    | 189/313 [02:13<01:24,  1.46it/s] 61%|██████    | 190/313 [02:14<01:22,  1.49it/s] 61%|██████    | 191/313 [02:14<01:22,  1.48it/s] 61%|██████▏   | 192/313 [02:15<01:22,  1.47it/s] 62%|██████▏   | 193/313 [02:16<01:24,  1.42it/s] 62%|██████▏   | 194/313 [02:17<01:23,  1.42it/s] 62%|██████▏   | 195/313 [02:17<01:21,  1.44it/s] 63%|██████▎   | 196/313 [02:18<01:23,  1.41it/s] 63%|██████▎   | 197/313 [02:19<01:21,  1.42it/s] 63%|██████▎   | 198/313 [02:19<01:21,  1.41it/s] 64%|██████▎   | 199/313 [02:20<01:20,  1.41it/s] 64%|██████▍   | 200/313 [02:21<01:19,  1.42it/s] 64%|██████▍   | 201/313 [02:21<01:16,  1.46it/s] 65%|██████▍   | 202/313 [02:22<01:14,  1.48it/s] 65%|██████▍   | 203/313 [02:23<01:12,  1.53it/s] 65%|██████▌   | 204/313 [02:23<01:11,  1.53it/s] 65%|██████▌   | 205/313 [02:24<01:12,  1.49it/s] 66%|██████▌   | 206/313 [02:25<01:11,  1.49it/s] 66%|██████▌   | 207/313 [02:25<01:11,  1.48it/s] 66%|██████▋   | 208/313 [02:26<01:09,  1.52it/s] 67%|██████▋   | 209/313 [02:27<01:08,  1.51it/s] 67%|██████▋   | 210/313 [02:27<01:09,  1.49it/s] 67%|██████▋   | 211/313 [02:28<01:09,  1.47it/s] 68%|██████▊   | 212/313 [02:29<01:10,  1.44it/s] 68%|██████▊   | 213/313 [02:30<01:09,  1.43it/s] 68%|██████▊   | 214/313 [02:30<01:06,  1.49it/s] 69%|██████▊   | 215/313 [02:31<01:05,  1.49it/s] 69%|██████▉   | 216/313 [02:31<01:05,  1.49it/s] 69%|██████▉   | 217/313 [02:32<01:04,  1.48it/s] 70%|██████▉   | 218/313 [02:33<01:05,  1.45it/s] 70%|██████▉   | 219/313 [02:34<01:05,  1.44it/s] 70%|███████   | 220/313 [02:34<01:03,  1.46it/s] 71%|███████   | 221/313 [02:35<01:04,  1.43it/s] 71%|███████   | 222/313 [02:36<01:02,  1.46it/s] 71%|███████   | 223/313 [02:36<01:01,  1.46it/s] 72%|███████▏  | 224/313 [02:37<00:59,  1.51it/s] 72%|███████▏  | 225/313 [02:38<00:56,  1.55it/s] 72%|███████▏  | 226/313 [02:38<00:55,  1.58it/s] 73%|███████▎  | 227/313 [02:39<00:54,  1.59it/s] 73%|███████▎  | 228/313 [02:39<00:54,  1.55it/s] 73%|███████▎  | 229/313 [02:40<00:55,  1.52it/s] 73%|███████▎  | 230/313 [02:41<00:55,  1.49it/s] 74%|███████▍  | 231/313 [02:42<00:56,  1.45it/s] 74%|███████▍  | 232/313 [02:42<00:55,  1.47it/s] 74%|███████▍  | 233/313 [02:43<00:53,  1.49it/s] 75%|███████▍  | 234/313 [02:44<00:53,  1.48it/s] 75%|███████▌  | 235/313 [02:44<00:53,  1.45it/s] 75%|███████▌  | 236/313 [02:45<00:54,  1.41it/s] 76%|███████▌  | 237/313 [02:46<00:54,  1.39it/s] 76%|███████▌  | 238/313 [02:47<00:55,  1.36it/s] 76%|███████▋  | 239/313 [02:47<00:53,  1.38it/s] 77%|███████▋  | 240/313 [02:48<00:53,  1.36it/s] 77%|███████▋  | 241/313 [02:49<00:53,  1.34it/s] 77%|███████▋  | 242/313 [02:49<00:52,  1.35it/s] 78%|███████▊  | 243/313 [02:50<00:49,  1.42it/s] 78%|███████▊  | 244/313 [02:51<00:48,  1.44it/s] 78%|███████▊  | 245/313 [02:51<00:47,  1.43it/s] 79%|███████▊  | 246/313 [02:52<00:45,  1.49it/s] 79%|███████▉  | 247/313 [02:53<00:44,  1.47it/s] 79%|███████▉  | 248/313 [02:54<00:45,  1.43it/s] 80%|███████▉  | 249/313 [02:54<00:45,  1.42it/s] 80%|███████▉  | 250/313 [02:55<00:44,  1.41it/s] 80%|████████  | 251/313 [02:56<00:43,  1.42it/s] 81%|████████  | 252/313 [02:56<00:42,  1.44it/s] 81%|████████  | 253/313 [02:57<00:42,  1.42it/s] 81%|████████  | 254/313 [02:58<00:41,  1.41it/s] 81%|████████▏ | 255/313 [02:58<00:40,  1.44it/s] 82%|████████▏ | 256/313 [02:59<00:39,  1.43it/s] 82%|████████▏ | 257/313 [03:00<00:39,  1.41it/s] 82%|████████▏ | 258/313 [03:01<00:37,  1.45it/s] 83%|████████▎ | 259/313 [03:01<00:37,  1.43it/s] 83%|████████▎ | 260/313 [03:02<00:35,  1.50it/s] 83%|████████▎ | 261/313 [03:03<00:35,  1.48it/s] 84%|████████▎ | 262/313 [03:03<00:33,  1.53it/s] 84%|████████▍ | 263/313 [03:04<00:32,  1.52it/s] 84%|████████▍ | 264/313 [03:04<00:32,  1.51it/s] 85%|████████▍ | 265/313 [03:05<00:31,  1.51it/s] 85%|████████▍ | 266/313 [03:06<00:31,  1.47it/s] 85%|████████▌ | 267/313 [03:07<00:31,  1.46it/s] 86%|████████▌ | 268/313 [03:07<00:31,  1.44it/s] 86%|████████▌ | 269/313 [03:08<00:30,  1.45it/s] 86%|████████▋ | 270/313 [03:09<00:28,  1.49it/s] 87%|████████▋ | 271/313 [03:09<00:28,  1.48it/s] 87%|████████▋ | 272/313 [03:10<00:27,  1.48it/s] 87%|████████▋ | 273/313 [03:11<00:27,  1.45it/s] 88%|████████▊ | 274/313 [03:11<00:26,  1.46it/s] 88%|████████▊ | 275/313 [03:12<00:26,  1.45it/s] 88%|████████▊ | 276/313 [03:13<00:25,  1.45it/s] 88%|████████▊ | 277/313 [03:13<00:24,  1.44it/s] 89%|████████▉ | 278/313 [03:14<00:24,  1.45it/s] 89%|████████▉ | 279/313 [03:15<00:23,  1.45it/s] 89%|████████▉ | 280/313 [03:16<00:22,  1.44it/s] 90%|████████▉ | 281/313 [03:16<00:22,  1.42it/s] 90%|█████████ | 282/313 [03:17<00:21,  1.41it/s] 90%|█████████ | 283/313 [03:18<00:21,  1.38it/s] 91%|█████████ | 284/313 [03:18<00:21,  1.38it/s] 91%|█████████ | 285/313 [03:19<00:20,  1.39it/s] 91%|█████████▏| 286/313 [03:20<00:19,  1.38it/s] 92%|█████████▏| 287/313 [03:21<00:18,  1.38it/s] 92%|█████████▏| 288/313 [03:21<00:17,  1.41it/s] 92%|█████████▏| 289/313 [03:22<00:17,  1.37it/s] 93%|█████████▎| 290/313 [03:23<00:16,  1.38it/s] 93%|█████████▎| 291/313 [03:23<00:15,  1.40it/s] 93%|█████████▎| 292/313 [03:24<00:14,  1.46it/s] 94%|█████████▎| 293/313 [03:25<00:13,  1.53it/s] 94%|█████████▍| 294/313 [03:25<00:12,  1.52it/s] 94%|█████████▍| 295/313 [03:26<00:11,  1.50it/s] 95%|█████████▍| 296/313 [03:27<00:11,  1.49it/s] 95%|█████████▍| 297/313 [03:27<00:10,  1.49it/s] 95%|█████████▌| 298/313 [03:28<00:09,  1.54it/s] 96%|█████████▌| 299/313 [03:29<00:09,  1.53it/s] 96%|█████████▌| 300/313 [03:29<00:08,  1.48it/s] 96%|█████████▌| 301/313 [03:30<00:08,  1.45it/s] 96%|█████████▋| 302/313 [03:31<00:07,  1.47it/s] 97%|█████████▋| 303/313 [03:31<00:06,  1.51it/s] 97%|█████████▋| 304/313 [03:32<00:05,  1.56it/s] 97%|█████████▋| 305/313 [03:33<00:05,  1.58it/s] 98%|█████████▊| 306/313 [03:33<00:04,  1.55it/s] 98%|█████████▊| 307/313 [03:34<00:03,  1.50it/s] 98%|█████████▊| 308/313 [03:35<00:03,  1.48it/s] 99%|█████████▊| 309/313 [03:35<00:02,  1.46it/s] 99%|█████████▉| 310/313 [03:36<00:02,  1.42it/s] 99%|█████████▉| 311/313 [03:37<00:01,  1.44it/s]100%|█████████▉| 312/313 [03:37<00:00,  1.47it/s]100%|██████████| 313/313 [03:38<00:00,  1.71it/s]100%|██████████| 313/313 [03:38<00:00,  1.43it/s]
Epoch: [0][  0/313]	Time  5.301 ( 5.301)	Data  2.138 ( 2.138)	Loss 4.1406e+00 (4.1406e+00)	Acc@1  87.50 ( 87.50)
Epoch: [0][ 10/313]	Time  0.587 ( 1.080)	Data  0.013 ( 0.224)	Loss 5.2881e-01 (7.9978e-01)	Acc@1  86.72 ( 88.71)
Epoch: [0][ 20/313]	Time  0.711 ( 0.874)	Data  0.034 ( 0.129)	Loss 4.9487e-01 (6.4590e-01)	Acc@1  89.84 ( 88.65)
Epoch: [0][ 30/313]	Time  0.660 ( 0.824)	Data  0.029 ( 0.102)	Loss 5.2246e-01 (5.9814e-01)	Acc@1  89.06 ( 88.91)
Epoch: [0][ 40/313]	Time  0.612 ( 0.785)	Data  0.016 ( 0.083)	Loss 5.1318e-01 (5.6758e-01)	Acc@1  87.50 ( 88.89)
Epoch: [0][ 50/313]	Time  0.670 ( 0.764)	Data  0.026 ( 0.075)	Loss 5.0098e-01 (5.5338e-01)	Acc@1  84.38 ( 88.76)
Epoch: [0][ 60/313]	Time  0.671 ( 0.755)	Data  0.027 ( 0.070)	Loss 5.0879e-01 (5.4344e-01)	Acc@1  85.16 ( 88.69)
Epoch: [0][ 70/313]	Time  0.655 ( 0.738)	Data  0.026 ( 0.063)	Loss 4.8218e-01 (5.3533e-01)	Acc@1  91.41 ( 88.77)
Epoch: [0][ 80/313]	Time  0.641 ( 0.731)	Data  0.016 ( 0.059)	Loss 5.8545e-01 (5.3303e-01)	Acc@1  86.72 ( 88.69)
Epoch: [0][ 90/313]	Time  0.705 ( 0.726)	Data  0.043 ( 0.056)	Loss 5.5420e-01 (5.2827e-01)	Acc@1  87.50 ( 88.68)
Epoch: [0][100/313]	Time  0.711 ( 0.725)	Data  0.071 ( 0.055)	Loss 4.6899e-01 (5.2506e-01)	Acc@1  90.62 ( 88.61)
Epoch: [0][110/313]	Time  0.709 ( 0.720)	Data  0.036 ( 0.053)	Loss 4.6875e-01 (5.2161e-01)	Acc@1  90.62 ( 88.57)
Epoch: [0][120/313]	Time  0.734 ( 0.718)	Data  0.065 ( 0.052)	Loss 3.8135e-01 (5.1621e-01)	Acc@1  92.19 ( 88.64)
Epoch: [0][130/313]	Time  0.728 ( 0.714)	Data  0.038 ( 0.050)	Loss 5.2344e-01 (5.1354e-01)	Acc@1  87.50 ( 88.70)
Epoch: [0][140/313]	Time  0.708 ( 0.713)	Data  0.045 ( 0.049)	Loss 5.3467e-01 (5.1254e-01)	Acc@1  89.06 ( 88.68)
Epoch: [0][150/313]	Time  0.685 ( 0.712)	Data  0.027 ( 0.048)	Loss 4.8047e-01 (5.0795e-01)	Acc@1  89.06 ( 88.76)
Epoch: [0][160/313]	Time  0.739 ( 0.709)	Data  0.046 ( 0.047)	Loss 3.8867e-01 (5.0368e-01)	Acc@1  89.84 ( 88.84)
Epoch: [0][170/313]	Time  0.729 ( 0.707)	Data  0.036 ( 0.046)	Loss 5.3271e-01 (5.0201e-01)	Acc@1  86.72 ( 88.82)
Epoch: [0][180/313]	Time  0.736 ( 0.707)	Data  0.043 ( 0.046)	Loss 5.2002e-01 (5.0052e-01)	Acc@1  85.94 ( 88.79)
Epoch: [0][190/313]	Time  0.679 ( 0.706)	Data  0.025 ( 0.045)	Loss 4.8364e-01 (4.9818e-01)	Acc@1  87.50 ( 88.87)
Epoch: [0][200/313]	Time  0.640 ( 0.706)	Data  0.021 ( 0.045)	Loss 4.2456e-01 (4.9628e-01)	Acc@1  90.62 ( 88.92)
Epoch: [0][210/313]	Time  0.702 ( 0.704)	Data  0.039 ( 0.044)	Loss 4.4312e-01 (4.9425e-01)	Acc@1  90.62 ( 88.96)
Epoch: [0][220/313]	Time  0.734 ( 0.703)	Data  0.051 ( 0.044)	Loss 3.5254e-01 (4.9341e-01)	Acc@1  91.41 ( 88.91)
Epoch: [0][230/313]	Time  0.730 ( 0.701)	Data  0.038 ( 0.043)	Loss 4.9731e-01 (4.9265e-01)	Acc@1  89.84 ( 88.89)
Epoch: [0][240/313]	Time  0.773 ( 0.702)	Data  0.057 ( 0.043)	Loss 5.9766e-01 (4.9252e-01)	Acc@1  85.16 ( 88.86)
Epoch: [0][250/313]	Time  0.694 ( 0.702)	Data  0.057 ( 0.043)	Loss 5.3662e-01 (4.9223e-01)	Acc@1  85.94 ( 88.83)
Epoch: [0][260/313]	Time  0.702 ( 0.701)	Data  0.044 ( 0.042)	Loss 5.3076e-01 (4.9279e-01)	Acc@1  85.94 ( 88.79)
Epoch: [0][270/313]	Time  0.682 ( 0.700)	Data  0.030 ( 0.042)	Loss 5.2637e-01 (4.9295e-01)	Acc@1  85.94 ( 88.76)
Epoch: [0][280/313]	Time  0.726 ( 0.700)	Data  0.057 ( 0.041)	Loss 6.3965e-01 (4.9374e-01)	Acc@1  81.25 ( 88.69)
Epoch: [0][290/313]	Time  0.681 ( 0.701)	Data  0.032 ( 0.042)	Loss 4.8901e-01 (4.9489e-01)	Acc@1  88.28 ( 88.64)
Epoch: [0][300/313]	Time  0.718 ( 0.700)	Data  0.052 ( 0.041)	Loss 4.3384e-01 (4.9494e-01)	Acc@1  89.84 ( 88.63)
Epoch: [0][310/313]	Time  0.671 ( 0.699)	Data  0.025 ( 0.041)	Loss 5.3271e-01 (4.9470e-01)	Acc@1  86.72 ( 88.62)
  0%|          | 0/79 [00:00<?, ?it/s]  0%|          | 0/79 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/.//main.py", line 150, in <module>
    main()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/.//main.py", line 144, in main
    learn.run()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/learner.py", line 152, in run
    acc1 = self.evaluate()
  File "/home/lcur0640/repos/DeepLearning1_UvA_22/assignment2/part2/learner.py", line 307, in evaluate
    loss = self.criterion(output)
  File "/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: CrossEntropyLoss.forward() missing 1 required positional argument: 'target'
