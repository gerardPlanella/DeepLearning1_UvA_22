Running experiment on cifar100 with fixed_patch and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=16, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', root='/scratch/lcur0640', dataset='cifar100', image_size=224, test_noise=True, visualize_prompt=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume='.//save/models/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar', evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:26, 333613.99it/s]  0%|          | 131072/169001437 [00:00<07:02, 399773.50it/s]  0%|          | 196608/169001437 [00:00<06:35, 427045.51it/s]  0%|          | 393216/169001437 [00:00<03:15, 862313.23it/s]  1%|          | 851968/169001437 [00:00<01:26, 1954141.35it/s]  1%|          | 1835008/169001437 [00:00<00:39, 4276909.78it/s]  2%|▏         | 2981888/169001437 [00:00<00:25, 6407125.64it/s]  3%|▎         | 4718592/169001437 [00:00<00:16, 9667096.52it/s]  4%|▍         | 6553600/169001437 [00:01<00:13, 12226599.71it/s]  5%|▌         | 8519680/169001437 [00:01<00:11, 14435532.94it/s]  6%|▌         | 10027008/169001437 [00:01<00:13, 11800481.91it/s]  7%|▋         | 11370496/169001437 [00:01<00:13, 11735526.82it/s]  8%|▊         | 13434880/169001437 [00:01<00:11, 14041892.92it/s]  9%|▉         | 15564800/169001437 [00:01<00:09, 16002276.40it/s] 11%|█         | 17858560/169001437 [00:01<00:08, 17918268.88it/s] 12%|█▏        | 19988480/169001437 [00:01<00:07, 18872733.51it/s] 13%|█▎        | 22347776/169001437 [00:01<00:07, 20236604.96it/s] 15%|█▍        | 24576000/169001437 [00:02<00:06, 20818486.92it/s] 16%|█▌        | 27000832/169001437 [00:02<00:06, 21819754.22it/s] 17%|█▋        | 29229056/169001437 [00:02<00:06, 21944041.09it/s] 19%|█▉        | 31752192/169001437 [00:02<00:05, 22912439.92it/s] 20%|██        | 34406400/169001437 [00:02<00:05, 23977884.44it/s] 22%|██▏       | 37158912/169001437 [00:02<00:05, 25002536.95it/s] 24%|██▎       | 39911424/169001437 [00:02<00:05, 25736853.95it/s] 25%|██▌       | 42762240/169001437 [00:02<00:04, 26553207.20it/s] 27%|██▋       | 45547520/169001437 [00:02<00:04, 26926801.25it/s] 29%|██▊       | 48496640/169001437 [00:02<00:04, 27691745.84it/s] 30%|███       | 51412992/169001437 [00:03<00:04, 28105974.06it/s] 32%|███▏      | 54296576/169001437 [00:03<00:04, 26043209.30it/s] 34%|███▍      | 57212928/169001437 [00:03<00:04, 24586706.70it/s] 36%|███▌      | 60260352/169001437 [00:03<00:04, 26159795.34it/s] 37%|███▋      | 63340544/169001437 [00:03<00:03, 27356326.68it/s] 39%|███▉      | 66355200/169001437 [00:03<00:03, 28071794.88it/s] 41%|████      | 69500928/169001437 [00:03<00:03, 29022902.03it/s] 43%|████▎     | 72450048/169001437 [00:03<00:03, 29137017.26it/s] 45%|████▍     | 75530240/169001437 [00:03<00:03, 29478208.16it/s] 47%|████▋     | 78741504/169001437 [00:04<00:03, 30041360.00it/s] 49%|████▊     | 81985536/169001437 [00:04<00:02, 30743627.60it/s] 50%|█████     | 85262336/169001437 [00:04<00:02, 31116620.86it/s] 52%|█████▏    | 88539136/169001437 [00:04<00:02, 31578093.05it/s] 54%|█████▍    | 91717632/169001437 [00:04<00:02, 31536903.69it/s] 56%|█████▌    | 94896128/169001437 [00:04<00:02, 31388509.09it/s] 58%|█████▊    | 98041856/169001437 [00:04<00:02, 31227450.56it/s] 60%|█████▉    | 101187584/169001437 [00:04<00:02, 31114187.02it/s] 62%|██████▏   | 104464384/169001437 [00:04<00:02, 27112964.49it/s] 64%|██████▎   | 107708416/169001437 [00:05<00:02, 28524041.95it/s] 66%|██████▌   | 110952448/169001437 [00:05<00:01, 29573166.73it/s] 67%|██████▋   | 114065408/169001437 [00:05<00:01, 29958500.70it/s] 69%|██████▉   | 117342208/169001437 [00:05<00:01, 30756005.41it/s] 71%|███████▏  | 120487936/169001437 [00:05<00:01, 30807444.01it/s] 73%|███████▎  | 123731968/169001437 [00:05<00:01, 31273157.69it/s] 75%|███████▌  | 126910464/169001437 [00:05<00:01, 31178354.09it/s] 77%|███████▋  | 130056192/169001437 [00:05<00:01, 31075049.31it/s] 79%|███████▉  | 133300224/169001437 [00:05<00:01, 31220727.32it/s] 81%|████████  | 136445952/169001437 [00:05<00:01, 31096615.87it/s] 83%|████████▎ | 139591680/169001437 [00:06<00:00, 31028109.97it/s] 85%|████████▍ | 142835712/169001437 [00:06<00:00, 31425902.42it/s] 86%|████████▋ | 145981440/169001437 [00:06<00:00, 31261520.80it/s] 88%|████████▊ | 149258240/169001437 [00:06<00:00, 31678570.70it/s] 90%|█████████ | 152436736/169001437 [00:06<00:00, 31646951.10it/s] 92%|█████████▏| 155680768/169001437 [00:06<00:00, 31880330.47it/s] 94%|█████████▍| 158924800/169001437 [00:06<00:00, 32036934.54it/s] 96%|█████████▌| 162136064/169001437 [00:06<00:00, 31871756.89it/s] 98%|█████████▊| 165347328/169001437 [00:06<00:00, 31690992.82it/s]100%|█████████▉| 168525824/169001437 [00:06<00:00, 31525679.14it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24166557.22it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  0%|                                       | 768k/338M [00:00<01:25, 4.13MiB/s]  0%|▏                                     | 1.50M/338M [00:00<01:01, 5.72MiB/s]  1%|▎                                     | 2.40M/338M [00:00<00:49, 7.13MiB/s]  1%|▎                                     | 3.27M/338M [00:00<00:45, 7.73MiB/s]  1%|▍                                     | 4.19M/338M [00:00<00:41, 8.37MiB/s]  2%|▌                                     | 5.22M/338M [00:00<00:38, 9.15MiB/s]  2%|▋                                     | 6.17M/338M [00:00<00:37, 9.29MiB/s]  2%|▊                                     | 7.08M/338M [00:00<00:37, 9.24MiB/s]  2%|▉                                     | 8.02M/338M [00:01<00:36, 9.36MiB/s]  3%|█                                     | 8.93M/338M [00:01<00:37, 9.30MiB/s]  3%|█                                     | 9.83M/338M [00:01<00:38, 8.88MiB/s]  3%|█▏                                    | 10.7M/338M [00:01<00:38, 8.91MiB/s]  3%|█▎                                    | 11.6M/338M [00:01<00:37, 9.10MiB/s]  4%|█▍                                    | 12.6M/338M [00:01<00:35, 9.64MiB/s]  4%|█▌                                    | 13.8M/338M [00:01<00:32, 10.3MiB/s]  4%|█▋                                    | 14.8M/338M [00:01<00:33, 10.2MiB/s]  5%|█▊                                    | 15.8M/338M [00:01<00:33, 9.98MiB/s]  5%|█▉                                    | 16.8M/338M [00:01<00:32, 10.3MiB/s]  5%|██                                    | 18.0M/338M [00:02<00:30, 10.9MiB/s]  6%|██▏                                   | 19.3M/338M [00:02<00:28, 11.6MiB/s]  6%|██▎                                   | 20.4M/338M [00:02<00:28, 11.7MiB/s]  6%|██▍                                   | 21.6M/338M [00:02<00:28, 11.7MiB/s]  7%|██▌                                   | 22.7M/338M [00:02<00:28, 11.7MiB/s]  7%|██▋                                   | 23.8M/338M [00:02<00:30, 10.9MiB/s]  7%|██▊                                   | 24.9M/338M [00:02<00:31, 10.4MiB/s]  8%|██▉                                   | 25.9M/338M [00:02<00:32, 10.1MiB/s]  8%|███                                   | 26.9M/338M [00:02<00:32, 10.1MiB/s]  8%|███▏                                  | 27.9M/338M [00:03<00:32, 10.1MiB/s]  9%|███▏                                  | 28.8M/338M [00:03<00:33, 9.60MiB/s]  9%|███▎                                  | 29.8M/338M [00:03<00:34, 9.38MiB/s]  9%|███▍                                  | 30.8M/338M [00:03<00:33, 9.68MiB/s]  9%|███▌                                  | 31.9M/338M [00:03<00:31, 10.1MiB/s] 10%|███▋                                  | 32.8M/338M [00:03<00:33, 9.59MiB/s] 10%|███▊                                  | 33.8M/338M [00:03<00:33, 9.61MiB/s] 10%|███▉                                  | 34.8M/338M [00:03<00:31, 10.0MiB/s] 11%|████                                  | 36.0M/338M [00:03<00:29, 10.7MiB/s] 11%|████▏                                 | 37.0M/338M [00:03<00:29, 10.7MiB/s] 11%|████▎                                 | 38.1M/338M [00:04<00:30, 10.3MiB/s] 12%|████▍                                 | 39.1M/338M [00:04<00:29, 10.5MiB/s] 12%|████▌                                 | 40.3M/338M [00:04<00:28, 11.1MiB/s] 12%|████▋                                 | 41.5M/338M [00:04<00:27, 11.3MiB/s] 13%|████▊                                 | 42.6M/338M [00:04<00:28, 11.0MiB/s] 13%|████▉                                 | 43.6M/338M [00:04<00:29, 10.5MiB/s] 13%|█████                                 | 44.6M/338M [00:04<00:32, 9.57MiB/s] 14%|█████▏                                | 45.6M/338M [00:04<00:31, 9.61MiB/s] 14%|█████▏                                | 46.5M/338M [00:04<00:31, 9.57MiB/s] 14%|█████▎                                | 47.4M/338M [00:05<00:31, 9.56MiB/s] 14%|█████▍                                | 48.4M/338M [00:05<00:33, 9.16MiB/s] 15%|█████▌                                | 49.3M/338M [00:05<00:32, 9.34MiB/s] 15%|█████▋                                | 50.3M/338M [00:05<00:31, 9.48MiB/s] 15%|█████▊                                | 51.2M/338M [00:05<00:32, 9.26MiB/s] 15%|█████▊                                | 52.1M/338M [00:05<00:33, 9.05MiB/s] 16%|█████▉                                | 53.0M/338M [00:05<00:32, 9.16MiB/s] 16%|██████                                | 54.0M/338M [00:05<00:31, 9.53MiB/s] 16%|██████▏                               | 55.1M/338M [00:05<00:30, 9.87MiB/s] 17%|██████▎                               | 56.0M/338M [00:06<00:30, 9.62MiB/s] 17%|██████▍                               | 57.0M/338M [00:06<00:30, 9.68MiB/s] 17%|██████▌                               | 58.1M/338M [00:06<00:29, 10.1MiB/s] 18%|██████▋                               | 59.2M/338M [00:06<00:27, 10.7MiB/s] 18%|██████▊                               | 60.3M/338M [00:06<00:28, 10.2MiB/s] 18%|██████▉                               | 61.2M/338M [00:06<00:28, 10.3MiB/s] 18%|███████                               | 62.3M/338M [00:06<00:27, 10.4MiB/s] 19%|███████                               | 63.3M/338M [00:06<00:28, 10.1MiB/s] 19%|███████▏                              | 64.3M/338M [00:06<00:28, 9.89MiB/s] 19%|███████▎                              | 65.2M/338M [00:06<00:29, 9.70MiB/s] 20%|███████▍                              | 66.2M/338M [00:07<00:28, 9.93MiB/s] 20%|███████▌                              | 67.4M/338M [00:07<00:27, 10.5MiB/s] 20%|███████▋                              | 68.6M/338M [00:07<00:25, 11.2MiB/s] 21%|███████▊                              | 69.9M/338M [00:07<00:24, 11.5MiB/s] 21%|███████▉                              | 71.0M/338M [00:07<00:24, 11.5MiB/s] 21%|████████                              | 72.0M/338M [00:07<00:26, 10.6MiB/s] 22%|████████▏                             | 73.1M/338M [00:07<00:28, 9.78MiB/s] 22%|████████▎                             | 74.0M/338M [00:07<00:28, 9.81MiB/s] 22%|████████▍                             | 75.0M/338M [00:07<00:27, 9.97MiB/s] 23%|████████▌                             | 76.1M/338M [00:08<00:26, 10.2MiB/s] 23%|████████▋                             | 77.1M/338M [00:08<00:26, 10.4MiB/s] 23%|████████▊                             | 78.1M/338M [00:08<00:26, 10.1MiB/s] 23%|████████▉                             | 79.1M/338M [00:08<00:26, 10.3MiB/s] 24%|█████████                             | 80.3M/338M [00:08<00:25, 10.8MiB/s] 24%|█████████▏                            | 81.5M/338M [00:08<00:23, 11.4MiB/s] 25%|█████████▎                            | 82.9M/338M [00:08<00:22, 12.1MiB/s] 25%|█████████▍                            | 84.3M/338M [00:08<00:20, 13.0MiB/s] 25%|█████████▋                            | 85.9M/338M [00:08<00:18, 14.0MiB/s] 26%|█████████▊                            | 87.2M/338M [00:08<00:19, 13.3MiB/s] 26%|█████████▉                            | 88.5M/338M [00:09<00:20, 12.7MiB/s] 27%|██████████                            | 89.7M/338M [00:09<00:21, 11.9MiB/s] 27%|██████████▏                           | 90.9M/338M [00:09<00:23, 11.1MiB/s] 27%|██████████▎                           | 91.9M/338M [00:09<00:23, 11.2MiB/s] 28%|██████████▍                           | 93.1M/338M [00:09<00:22, 11.4MiB/s] 28%|██████████▋                           | 94.4M/338M [00:09<00:21, 12.0MiB/s] 28%|██████████▊                           | 95.7M/338M [00:09<00:20, 12.3MiB/s] 29%|██████████▉                           | 96.9M/338M [00:09<00:21, 11.7MiB/s] 29%|███████████                           | 98.0M/338M [00:09<00:21, 11.8MiB/s] 29%|███████████▏                          | 99.3M/338M [00:10<00:20, 12.2MiB/s] 30%|███████████▋                           | 101M/338M [00:10<00:19, 12.8MiB/s] 30%|███████████▊                           | 102M/338M [00:10<00:18, 13.5MiB/s] 31%|███████████▉                           | 104M/338M [00:10<00:17, 14.4MiB/s] 31%|████████████▏                          | 105M/338M [00:10<00:16, 14.9MiB/s] 32%|████████████▎                          | 107M/338M [00:10<00:17, 14.2MiB/s] 32%|████████████▍                          | 108M/338M [00:10<00:16, 14.2MiB/s] 32%|████████████▋                          | 109M/338M [00:10<00:16, 14.2MiB/s] 33%|████████████▊                          | 111M/338M [00:10<00:16, 14.2MiB/s] 33%|████████████▉                          | 112M/338M [00:11<00:17, 13.5MiB/s] 34%|█████████████                          | 113M/338M [00:11<00:18, 12.9MiB/s] 34%|█████████████▎                         | 115M/338M [00:11<00:18, 12.9MiB/s] 34%|█████████████▍                         | 116M/338M [00:11<00:18, 12.9MiB/s] 35%|█████████████▌                         | 117M/338M [00:11<00:19, 11.8MiB/s] 35%|█████████████▋                         | 118M/338M [00:11<00:20, 11.2MiB/s] 35%|█████████████▊                         | 119M/338M [00:11<00:20, 11.3MiB/s] 36%|█████████████▉                         | 121M/338M [00:11<00:19, 11.7MiB/s] 36%|██████████████                         | 122M/338M [00:11<00:18, 12.3MiB/s] 37%|██████████████▎                        | 123M/338M [00:11<00:17, 13.1MiB/s] 37%|██████████████▍                        | 125M/338M [00:12<00:18, 12.4MiB/s] 37%|██████████████▌                        | 126M/338M [00:12<00:19, 11.4MiB/s] 38%|██████████████▋                        | 127M/338M [00:12<00:21, 10.5MiB/s] 38%|██████████████▊                        | 128M/338M [00:12<00:21, 10.3MiB/s] 38%|██████████████▉                        | 129M/338M [00:12<00:21, 10.3MiB/s] 39%|███████████████                        | 130M/338M [00:12<00:20, 10.8MiB/s] 39%|███████████████▏                       | 131M/338M [00:12<00:20, 10.4MiB/s] 39%|███████████████▎                       | 132M/338M [00:12<00:21, 10.1MiB/s] 39%|███████████████▍                       | 133M/338M [00:13<00:20, 10.4MiB/s] 40%|███████████████▌                       | 134M/338M [00:13<00:22, 9.65MiB/s] 40%|███████████████▌                       | 135M/338M [00:13<00:22, 9.44MiB/s] 40%|███████████████▋                       | 136M/338M [00:13<00:22, 9.48MiB/s] 41%|███████████████▊                       | 137M/338M [00:13<00:21, 9.92MiB/s] 41%|███████████████▉                       | 138M/338M [00:13<00:19, 10.5MiB/s] 41%|████████████████                       | 140M/338M [00:13<00:18, 11.3MiB/s] 42%|████████████████▎                      | 141M/338M [00:13<00:17, 12.1MiB/s] 42%|████████████████▍                      | 142M/338M [00:13<00:15, 12.8MiB/s] 43%|████████████████▌                      | 144M/338M [00:13<00:16, 12.1MiB/s] 43%|████████████████▋                      | 145M/338M [00:14<00:16, 12.3MiB/s] 43%|████████████████▊                      | 146M/338M [00:14<00:17, 11.2MiB/s] 44%|████████████████▉                      | 147M/338M [00:14<00:18, 10.8MiB/s] 44%|█████████████████                      | 148M/338M [00:14<00:18, 10.8MiB/s] 44%|█████████████████▏                     | 149M/338M [00:14<00:18, 10.9MiB/s] 45%|█████████████████▍                     | 150M/338M [00:14<00:17, 11.5MiB/s] 45%|█████████████████▌                     | 152M/338M [00:14<00:15, 12.2MiB/s] 45%|█████████████████▋                     | 153M/338M [00:14<00:15, 12.2MiB/s] 46%|█████████████████▊                     | 154M/338M [00:14<00:16, 11.9MiB/s] 46%|█████████████████▉                     | 155M/338M [00:15<00:16, 11.9MiB/s] 46%|██████████████████                     | 157M/338M [00:15<00:15, 12.3MiB/s] 47%|██████████████████▏                    | 158M/338M [00:15<00:16, 11.3MiB/s] 47%|██████████████████▎                    | 159M/338M [00:15<00:16, 11.1MiB/s] 47%|██████████████████▍                    | 160M/338M [00:15<00:16, 11.1MiB/s] 48%|██████████████████▌                    | 161M/338M [00:15<00:16, 11.3MiB/s] 48%|██████████████████▋                    | 162M/338M [00:15<00:15, 11.7MiB/s] 48%|██████████████████▉                    | 164M/338M [00:15<00:14, 12.5MiB/s] 49%|███████████████████                    | 165M/338M [00:15<00:15, 11.6MiB/s] 49%|███████████████████▏                   | 166M/338M [00:16<00:17, 10.1MiB/s] 49%|███████████████████▎                   | 167M/338M [00:16<00:18, 9.73MiB/s] 50%|███████████████████▍                   | 168M/338M [00:16<00:18, 9.80MiB/s] 50%|███████████████████▌                   | 169M/338M [00:16<00:18, 9.64MiB/s] 50%|███████████████████▌                   | 170M/338M [00:16<00:18, 9.26MiB/s] 51%|███████████████████▋                   | 171M/338M [00:16<00:19, 8.94MiB/s] 51%|███████████████████▊                   | 172M/338M [00:16<00:19, 8.98MiB/s] 51%|███████████████████▉                   | 173M/338M [00:16<00:18, 9.46MiB/s] 51%|████████████████████                   | 174M/338M [00:16<00:17, 10.1MiB/s] 52%|████████████████████▏                  | 175M/338M [00:17<00:15, 10.9MiB/s] 52%|████████████████████▎                  | 176M/338M [00:17<00:15, 10.6MiB/s] 52%|████████████████████▍                  | 177M/338M [00:17<00:15, 10.6MiB/s] 53%|████████████████████▌                  | 178M/338M [00:17<00:15, 10.8MiB/s] 53%|████████████████████▋                  | 179M/338M [00:17<00:14, 11.2MiB/s] 53%|████████████████████▊                  | 180M/338M [00:17<00:15, 10.7MiB/s] 54%|████████████████████▉                  | 181M/338M [00:17<00:15, 10.4MiB/s] 54%|█████████████████████                  | 182M/338M [00:17<00:15, 10.4MiB/s] 54%|█████████████████████▏                 | 183M/338M [00:17<00:14, 10.8MiB/s] 55%|█████████████████████▎                 | 185M/338M [00:17<00:14, 10.7MiB/s] 55%|█████████████████████▍                 | 186M/338M [00:18<00:15, 10.3MiB/s] 55%|█████████████████████▌                 | 187M/338M [00:18<00:15, 9.95MiB/s] 56%|█████████████████████▋                 | 188M/338M [00:18<00:15, 10.1MiB/s] 56%|█████████████████████▊                 | 189M/338M [00:18<00:14, 10.6MiB/s] 56%|█████████████████████▉                 | 190M/338M [00:18<00:14, 10.7MiB/s] 57%|██████████████████████                 | 191M/338M [00:18<00:14, 10.3MiB/s] 57%|██████████████████████▏                | 192M/338M [00:18<00:14, 10.4MiB/s] 57%|██████████████████████▎                | 193M/338M [00:18<00:15, 9.68MiB/s] 57%|██████████████████████▍                | 194M/338M [00:18<00:15, 9.48MiB/s] 58%|██████████████████████▍                | 195M/338M [00:19<00:15, 9.50MiB/s] 58%|██████████████████████▌                | 196M/338M [00:19<00:15, 9.67MiB/s] 58%|██████████████████████▋                | 197M/338M [00:19<00:14, 10.2MiB/s] 59%|██████████████████████▉                | 198M/338M [00:19<00:13, 11.1MiB/s] 59%|███████████████████████                | 199M/338M [00:19<00:13, 10.8MiB/s] 59%|███████████████████████▏               | 200M/338M [00:19<00:13, 10.7MiB/s] 60%|███████████████████████▎               | 201M/338M [00:19<00:13, 10.9MiB/s] 60%|███████████████████████▍               | 203M/338M [00:19<00:12, 11.5MiB/s] 60%|███████████████████████▌               | 204M/338M [00:19<00:11, 12.4MiB/s] 61%|███████████████████████▋               | 205M/338M [00:19<00:10, 12.9MiB/s] 61%|███████████████████████▊               | 207M/338M [00:20<00:11, 12.3MiB/s] 62%|███████████████████████▉               | 208M/338M [00:20<00:11, 12.4MiB/s] 62%|████████████████████████▏              | 209M/338M [00:20<00:10, 12.7MiB/s] 62%|████████████████████████▎              | 210M/338M [00:20<00:11, 12.1MiB/s] 63%|████████████████████████▍              | 211M/338M [00:20<00:11, 11.2MiB/s] 63%|████████████████████████▌              | 212M/338M [00:20<00:11, 11.3MiB/s] 63%|████████████████████████▋              | 214M/338M [00:20<00:11, 11.5MiB/s] 64%|████████████████████████▊              | 215M/338M [00:20<00:10, 11.8MiB/s] 64%|████████████████████████▉              | 216M/338M [00:20<00:10, 11.8MiB/s] 64%|█████████████████████████              | 217M/338M [00:21<00:10, 11.5MiB/s] 65%|█████████████████████████▏             | 218M/338M [00:21<00:10, 11.5MiB/s] 65%|█████████████████████████▎             | 219M/338M [00:21<00:11, 10.5MiB/s] 65%|█████████████████████████▍             | 220M/338M [00:21<00:12, 10.1MiB/s] 66%|█████████████████████████▌             | 221M/338M [00:21<00:12, 10.1MiB/s] 66%|█████████████████████████▋             | 222M/338M [00:21<00:11, 10.4MiB/s] 66%|█████████████████████████▊             | 224M/338M [00:21<00:10, 11.0MiB/s] 67%|█████████████████████████▉             | 225M/338M [00:21<00:10, 11.8MiB/s] 67%|██████████████████████████▏            | 226M/338M [00:21<00:09, 12.0MiB/s] 67%|██████████████████████████▎            | 227M/338M [00:22<00:09, 11.8MiB/s] 68%|██████████████████████████▍            | 228M/338M [00:22<00:10, 10.8MiB/s] 68%|██████████████████████████▌            | 229M/338M [00:22<00:11, 10.1MiB/s] 68%|██████████████████████████▋            | 230M/338M [00:22<00:11, 10.1MiB/s] 69%|██████████████████████████▋            | 231M/338M [00:22<00:10, 10.2MiB/s] 69%|██████████████████████████▊            | 233M/338M [00:22<00:10, 10.6MiB/s] 69%|███████████████████████████            | 234M/338M [00:22<00:09, 11.3MiB/s] 70%|███████████████████████████▏           | 235M/338M [00:22<00:08, 12.2MiB/s] 70%|███████████████████████████▎           | 237M/338M [00:22<00:08, 13.0MiB/s] 70%|███████████████████████████▍           | 238M/338M [00:22<00:07, 13.1MiB/s] 71%|███████████████████████████▋           | 239M/338M [00:23<00:08, 11.8MiB/s] 71%|███████████████████████████▊           | 240M/338M [00:23<00:09, 10.8MiB/s] 72%|███████████████████████████▉           | 241M/338M [00:23<00:09, 10.4MiB/s] 72%|████████████████████████████           | 242M/338M [00:23<00:09, 10.5MiB/s] 72%|████████████████████████████▏          | 244M/338M [00:23<00:08, 11.0MiB/s] 72%|████████████████████████████▎          | 245M/338M [00:23<00:09, 10.2MiB/s] 73%|████████████████████████████▍          | 246M/338M [00:23<00:09, 9.89MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:23<00:09, 9.90MiB/s] 73%|████████████████████████████▌          | 248M/338M [00:24<00:09, 9.63MiB/s] 74%|████████████████████████████▋          | 249M/338M [00:24<00:09, 9.42MiB/s] 74%|████████████████████████████▊          | 250M/338M [00:24<00:09, 9.36MiB/s] 74%|████████████████████████████▉          | 251M/338M [00:24<00:09, 9.81MiB/s] 75%|█████████████████████████████          | 252M/338M [00:24<00:08, 10.5MiB/s] 75%|█████████████████████████████▏         | 253M/338M [00:24<00:07, 11.3MiB/s] 75%|█████████████████████████████▍         | 254M/338M [00:24<00:07, 12.2MiB/s] 76%|█████████████████████████████▌         | 256M/338M [00:24<00:07, 12.1MiB/s] 76%|█████████████████████████████▋         | 257M/338M [00:24<00:06, 12.1MiB/s] 76%|█████████████████████████████▊         | 258M/338M [00:24<00:06, 12.2MiB/s] 77%|█████████████████████████████▉         | 259M/338M [00:25<00:06, 12.7MiB/s] 77%|██████████████████████████████         | 260M/338M [00:25<00:06, 12.1MiB/s] 77%|██████████████████████████████▏        | 262M/338M [00:25<00:06, 11.5MiB/s] 78%|██████████████████████████████▎        | 263M/338M [00:25<00:06, 11.5MiB/s] 78%|██████████████████████████████▍        | 264M/338M [00:25<00:06, 11.7MiB/s] 79%|██████████████████████████████▋        | 265M/338M [00:25<00:06, 12.1MiB/s] 79%|██████████████████████████████▊        | 266M/338M [00:25<00:06, 11.8MiB/s] 79%|██████████████████████████████▉        | 267M/338M [00:25<00:06, 11.3MiB/s] 80%|███████████████████████████████        | 269M/338M [00:25<00:06, 11.2MiB/s] 80%|███████████████████████████████▏       | 270M/338M [00:26<00:06, 11.4MiB/s] 80%|███████████████████████████████▎       | 271M/338M [00:26<00:06, 11.6MiB/s] 81%|███████████████████████████████▍       | 272M/338M [00:26<00:05, 12.3MiB/s] 81%|███████████████████████████████▌       | 274M/338M [00:26<00:05, 13.1MiB/s] 81%|███████████████████████████████▊       | 275M/338M [00:26<00:04, 14.0MiB/s] 82%|███████████████████████████████▉       | 277M/338M [00:26<00:04, 14.7MiB/s] 82%|████████████████████████████████▏      | 278M/338M [00:26<00:03, 15.8MiB/s] 83%|████████████████████████████████▎      | 280M/338M [00:26<00:03, 16.7MiB/s] 84%|████████████████████████████████▌      | 282M/338M [00:26<00:03, 17.7MiB/s] 84%|████████████████████████████████▊      | 284M/338M [00:26<00:03, 17.0MiB/s] 85%|████████████████████████████████▉      | 285M/338M [00:27<00:03, 14.3MiB/s] 85%|█████████████████████████████████▏     | 287M/338M [00:27<00:03, 13.4MiB/s] 85%|█████████████████████████████████▎     | 288M/338M [00:27<00:04, 12.7MiB/s] 86%|█████████████████████████████████▍     | 290M/338M [00:27<00:04, 11.5MiB/s] 86%|█████████████████████████████████▌     | 291M/338M [00:27<00:04, 11.2MiB/s] 86%|█████████████████████████████████▋     | 292M/338M [00:27<00:04, 11.2MiB/s] 87%|█████████████████████████████████▊     | 293M/338M [00:27<00:04, 11.4MiB/s] 87%|█████████████████████████████████▉     | 294M/338M [00:27<00:03, 12.0MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:28<00:03, 12.8MiB/s] 88%|██████████████████████████████████▎    | 297M/338M [00:28<00:03, 13.6MiB/s] 88%|██████████████████████████████████▍    | 299M/338M [00:28<00:02, 13.7MiB/s] 89%|██████████████████████████████████▋    | 300M/338M [00:28<00:03, 11.8MiB/s] 89%|██████████████████████████████████▊    | 301M/338M [00:28<00:03, 11.0MiB/s] 89%|██████████████████████████████████▉    | 302M/338M [00:28<00:03, 10.8MiB/s] 90%|███████████████████████████████████    | 303M/338M [00:28<00:03, 10.9MiB/s] 90%|███████████████████████████████████▏   | 304M/338M [00:28<00:03, 10.9MiB/s] 90%|███████████████████████████████████▎   | 305M/338M [00:28<00:03, 10.7MiB/s] 91%|███████████████████████████████████▍   | 306M/338M [00:29<00:03, 10.7MiB/s] 91%|███████████████████████████████████▌   | 307M/338M [00:29<00:02, 11.0MiB/s] 91%|███████████████████████████████████▋   | 308M/338M [00:29<00:02, 10.7MiB/s] 92%|███████████████████████████████████▊   | 310M/338M [00:29<00:02, 10.2MiB/s] 92%|███████████████████████████████████▊   | 311M/338M [00:29<00:02, 10.0MiB/s] 92%|███████████████████████████████████▉   | 312M/338M [00:29<00:02, 10.3MiB/s] 93%|████████████████████████████████████▏  | 313M/338M [00:29<00:02, 10.8MiB/s] 93%|████████████████████████████████████▎  | 314M/338M [00:29<00:02, 11.5MiB/s] 93%|████████████████████████████████████▍  | 315M/338M [00:29<00:01, 12.3MiB/s] 94%|████████████████████████████████████▌  | 317M/338M [00:30<00:01, 11.7MiB/s] 94%|████████████████████████████████████▋  | 318M/338M [00:30<00:01, 11.4MiB/s] 94%|████████████████████████████████████▊  | 319M/338M [00:30<00:01, 10.6MiB/s] 95%|████████████████████████████████████▉  | 320M/338M [00:30<00:01, 9.86MiB/s] 95%|█████████████████████████████████████  | 321M/338M [00:30<00:01, 10.1MiB/s] 95%|█████████████████████████████████████▏ | 322M/338M [00:30<00:01, 10.0MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:30<00:01, 9.40MiB/s] 96%|█████████████████████████████████████▍ | 324M/338M [00:30<00:01, 9.26MiB/s] 96%|█████████████████████████████████████▍ | 325M/338M [00:30<00:01, 9.41MiB/s] 96%|█████████████████████████████████████▋ | 326M/338M [00:31<00:01, 9.99MiB/s] 97%|█████████████████████████████████████▋ | 327M/338M [00:31<00:01, 10.0MiB/s] 97%|█████████████████████████████████████▊ | 328M/338M [00:31<00:01, 9.69MiB/s] 97%|█████████████████████████████████████▉ | 329M/338M [00:31<00:00, 9.88MiB/s] 98%|██████████████████████████████████████ | 330M/338M [00:31<00:00, 9.82MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:31<00:00, 9.38MiB/s] 98%|██████████████████████████████████████▎| 331M/338M [00:31<00:00, 9.19MiB/s] 98%|██████████████████████████████████████▍| 332M/338M [00:31<00:00, 9.34MiB/s] 99%|██████████████████████████████████████▌| 333M/338M [00:31<00:00, 9.83MiB/s] 99%|██████████████████████████████████████▋| 335M/338M [00:31<00:00, 10.5MiB/s] 99%|██████████████████████████████████████▊| 336M/338M [00:32<00:00, 11.3MiB/s]100%|██████████████████████████████████████▉| 337M/338M [00:32<00:00, 12.2MiB/s]100%|███████████████████████████████████████| 338M/338M [00:32<00:00, 11.0MiB/s]
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
=> loading checkpoint './/save/models/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar'
=> loaded checkpoint './/save/models/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar' (epoch 4)
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Model evaluation w/ random noise
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:08<11:09,  8.58s/it]  3%|▎         | 2/79 [00:08<04:50,  3.77s/it]  4%|▍         | 3/79 [00:09<02:47,  2.21s/it]  5%|▌         | 4/79 [00:09<01:49,  1.47s/it]  6%|▋         | 5/79 [00:09<01:17,  1.05s/it]  8%|▊         | 6/79 [00:10<00:58,  1.24it/s]  9%|▉         | 7/79 [00:10<00:48,  1.48it/s] 10%|█         | 8/79 [00:11<00:40,  1.77it/s] 11%|█▏        | 9/79 [00:11<00:33,  2.06it/s] 13%|█▎        | 10/79 [00:11<00:29,  2.32it/s] 14%|█▍        | 11/79 [00:11<00:26,  2.54it/s] 15%|█▌        | 12/79 [00:12<00:24,  2.71it/s] 16%|█▋        | 13/79 [00:12<00:23,  2.78it/s] 18%|█▊        | 14/79 [00:12<00:22,  2.92it/s] 19%|█▉        | 15/79 [00:13<00:22,  2.90it/s] 20%|██        | 16/79 [00:13<00:21,  2.89it/s] 22%|██▏       | 17/79 [00:13<00:21,  2.86it/s] 23%|██▎       | 18/79 [00:14<00:21,  2.78it/s] 24%|██▍       | 19/79 [00:14<00:21,  2.84it/s] 25%|██▌       | 20/79 [00:15<00:20,  2.88it/s] 27%|██▋       | 21/79 [00:15<00:19,  2.91it/s] 28%|██▊       | 22/79 [00:15<00:19,  2.90it/s] 29%|██▉       | 23/79 [00:16<00:19,  2.86it/s] 30%|███       | 24/79 [00:16<00:18,  2.90it/s] 32%|███▏      | 25/79 [00:16<00:19,  2.83it/s] 33%|███▎      | 26/79 [00:17<00:19,  2.79it/s] 34%|███▍      | 27/79 [00:17<00:18,  2.84it/s] 35%|███▌      | 28/79 [00:17<00:17,  2.87it/s] 37%|███▋      | 29/79 [00:18<00:18,  2.77it/s] 38%|███▊      | 30/79 [00:18<00:17,  2.85it/s] 39%|███▉      | 31/79 [00:18<00:16,  2.89it/s] 41%|████      | 32/79 [00:19<00:15,  3.08it/s] 42%|████▏     | 33/79 [00:19<00:14,  3.23it/s] 43%|████▎     | 34/79 [00:19<00:13,  3.34it/s] 44%|████▍     | 35/79 [00:19<00:12,  3.42it/s] 46%|████▌     | 36/79 [00:20<00:12,  3.48it/s] 47%|████▋     | 37/79 [00:20<00:11,  3.52it/s] 48%|████▊     | 38/79 [00:20<00:13,  3.12it/s] 49%|████▉     | 39/79 [00:21<00:13,  2.89it/s] 51%|█████     | 40/79 [00:21<00:14,  2.67it/s] 52%|█████▏    | 41/79 [00:22<00:13,  2.72it/s] 53%|█████▎    | 42/79 [00:22<00:13,  2.73it/s] 54%|█████▍    | 43/79 [00:22<00:13,  2.64it/s] 56%|█████▌    | 44/79 [00:23<00:12,  2.71it/s] 57%|█████▋    | 45/79 [00:23<00:11,  2.92it/s] 58%|█████▊    | 46/79 [00:23<00:10,  3.08it/s] 59%|█████▉    | 47/79 [00:24<00:10,  3.07it/s] 61%|██████    | 48/79 [00:24<00:09,  3.12it/s] 62%|██████▏   | 49/79 [00:24<00:09,  3.20it/s] 63%|██████▎   | 50/79 [00:25<00:08,  3.34it/s] 65%|██████▍   | 51/79 [00:25<00:08,  3.42it/s] 66%|██████▌   | 52/79 [00:25<00:07,  3.60it/s] 67%|██████▋   | 53/79 [00:25<00:06,  3.73it/s] 68%|██████▊   | 54/79 [00:26<00:06,  3.77it/s] 70%|██████▉   | 55/79 [00:26<00:06,  3.83it/s] 71%|███████   | 56/79 [00:26<00:05,  3.90it/s] 72%|███████▏  | 57/79 [00:26<00:05,  3.93it/s] 73%|███████▎  | 58/79 [00:27<00:05,  3.98it/s] 75%|███████▍  | 59/79 [00:27<00:04,  4.01it/s] 76%|███████▌  | 60/79 [00:27<00:04,  4.04it/s] 77%|███████▋  | 61/79 [00:27<00:04,  4.06it/s] 78%|███████▊  | 62/79 [00:28<00:04,  4.02it/s] 80%|███████▉  | 63/79 [00:28<00:03,  4.04it/s] 81%|████████  | 64/79 [00:28<00:03,  4.05it/s] 82%|████████▏ | 65/79 [00:28<00:03,  3.97it/s] 84%|████████▎ | 66/79 [00:29<00:03,  3.99it/s] 85%|████████▍ | 67/79 [00:29<00:02,  4.01it/s] 86%|████████▌ | 68/79 [00:29<00:02,  4.01it/s] 87%|████████▋ | 69/79 [00:29<00:02,  4.04it/s] 89%|████████▊ | 70/79 [00:30<00:02,  4.03it/s] 90%|████████▉ | 71/79 [00:30<00:01,  4.03it/s] 91%|█████████ | 72/79 [00:30<00:01,  4.03it/s] 92%|█████████▏| 73/79 [00:30<00:01,  4.02it/s] 94%|█████████▎| 74/79 [00:31<00:01,  4.05it/s] 95%|█████████▍| 75/79 [00:31<00:00,  4.06it/s] 96%|█████████▌| 76/79 [00:31<00:00,  4.04it/s] 97%|█████████▋| 77/79 [00:31<00:00,  4.01it/s] 99%|█████████▊| 78/79 [00:31<00:00,  4.04it/s]100%|██████████| 79/79 [00:32<00:00,  2.45it/s]
Validate: [ 0/79]	Time  8.585 ( 8.585)	Loss 6.9375e+00 (6.9375e+00)	Prompt Acc@1  69.53 ( 69.53)
Validate: [10/79]	Time  0.309 ( 1.088)	Loss 9.0156e+00 (9.4616e+00)	Prompt Acc@1  60.94 ( 60.09)
Validate: [20/79]	Time  0.335 ( 0.732)	Loss 8.7812e+00 (9.1957e+00)	Prompt Acc@1  62.50 ( 60.23)
Validate: [30/79]	Time  0.336 ( 0.609)	Loss 9.8281e+00 (9.7692e+00)	Prompt Acc@1  61.72 ( 59.90)
Validate: [40/79]	Time  0.350 ( 0.540)	Loss 9.2188e+00 (9.7889e+00)	Prompt Acc@1  64.06 ( 60.25)
Validate: [50/79]	Time  0.276 ( 0.496)	Loss 1.1586e+01 (9.8653e+00)	Prompt Acc@1  56.25 ( 60.06)
Validate: [60/79]	Time  0.243 ( 0.455)	Loss 1.0336e+01 (9.8510e+00)	Prompt Acc@1  57.03 ( 60.22)
Validate: [70/79]	Time  0.248 ( 0.426)	Loss 8.1016e+00 (9.7512e+00)	Prompt Acc@1  58.59 ( 60.31)
 * Prompt Acc@1 60.420
