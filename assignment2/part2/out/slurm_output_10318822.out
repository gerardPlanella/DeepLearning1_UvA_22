Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<07:59, 352138.05it/s]  0%|          | 131072/169001437 [00:00<06:01, 466866.24it/s]  0%|          | 196608/169001437 [00:00<06:01, 467283.11it/s]  0%|          | 393216/169001437 [00:00<03:23, 828365.08it/s]  1%|          | 851968/169001437 [00:00<01:28, 1899028.46it/s]  1%|          | 1474560/169001437 [00:00<00:53, 3150200.19it/s]  2%|▏         | 2949120/169001437 [00:00<00:25, 6533313.50it/s]  3%|▎         | 4751360/169001437 [00:00<00:16, 9898460.57it/s]  4%|▍         | 6586368/169001437 [00:01<00:13, 12395553.87it/s]  5%|▌         | 8519680/169001437 [00:01<00:11, 14450208.56it/s]  6%|▌         | 10289152/169001437 [00:01<00:10, 15403673.35it/s]  7%|▋         | 12255232/169001437 [00:01<00:09, 16667882.01it/s]  8%|▊         | 14254080/169001437 [00:01<00:08, 17639606.51it/s] 10%|▉         | 16351232/169001437 [00:01<00:08, 18615367.58it/s] 11%|█         | 18415616/169001437 [00:01<00:08, 17729780.50it/s] 12%|█▏        | 20578304/169001437 [00:01<00:07, 18828732.93it/s] 14%|█▎        | 22937600/169001437 [00:01<00:07, 20192276.36it/s] 15%|█▍        | 25329664/169001437 [00:02<00:07, 19183262.52it/s] 16%|█▋        | 27787264/169001437 [00:02<00:06, 20565086.47it/s] 18%|█▊        | 30343168/169001437 [00:02<00:06, 21923861.00it/s] 20%|█▉        | 33161216/169001437 [00:02<00:05, 23700260.34it/s] 21%|██▏       | 35979264/169001437 [00:02<00:05, 24988386.71it/s] 23%|██▎       | 38928384/169001437 [00:02<00:04, 26296381.25it/s] 25%|██▍       | 41844736/169001437 [00:02<00:04, 27133705.08it/s] 27%|██▋       | 44990464/169001437 [00:02<00:04, 28374384.11it/s] 29%|██▊       | 48168960/169001437 [00:02<00:04, 29382192.85it/s] 30%|███       | 51118080/169001437 [00:02<00:04, 29346628.32it/s] 32%|███▏      | 54099968/169001437 [00:03<00:03, 29479910.03it/s] 34%|███▍      | 57344000/169001437 [00:03<00:03, 30076815.20it/s] 36%|███▌      | 60620800/169001437 [00:03<00:03, 30858560.70it/s] 38%|███▊      | 63864832/169001437 [00:03<00:03, 31329435.83it/s] 40%|███▉      | 67010560/169001437 [00:03<00:03, 31279574.81it/s] 42%|████▏     | 70254592/169001437 [00:03<00:03, 31585368.85it/s] 43%|████▎     | 73465856/169001437 [00:03<00:03, 31503706.92it/s] 45%|████▌     | 76677120/169001437 [00:03<00:02, 31651395.99it/s] 47%|████▋     | 79855616/169001437 [00:03<00:02, 31432076.02it/s] 49%|████▉     | 83001344/169001437 [00:03<00:02, 31251408.93it/s] 51%|█████     | 86147072/169001437 [00:04<00:02, 31171993.09it/s] 53%|█████▎    | 89292800/169001437 [00:04<00:02, 31004815.94it/s] 55%|█████▍    | 92405760/169001437 [00:04<00:02, 30917322.55it/s] 57%|█████▋    | 95518720/169001437 [00:04<00:02, 30857716.99it/s] 58%|█████▊    | 98697216/169001437 [00:04<00:02, 30938332.48it/s] 60%|██████    | 101941248/169001437 [00:04<00:02, 31381459.21it/s] 62%|██████▏   | 105086976/169001437 [00:04<00:02, 31284570.43it/s] 64%|██████▍   | 108331008/169001437 [00:04<00:02, 28394538.79it/s] 66%|██████▌   | 111443968/169001437 [00:04<00:01, 28839035.06it/s] 68%|██████▊   | 114688000/169001437 [00:05<00:01, 29843860.71it/s] 70%|██████▉   | 117964800/169001437 [00:05<00:01, 30659496.84it/s] 72%|███████▏  | 121110528/169001437 [00:05<00:01, 30808956.70it/s] 74%|███████▎  | 124354560/169001437 [00:05<00:01, 31272995.37it/s] 75%|███████▌  | 127500288/169001437 [00:05<00:01, 31205635.60it/s] 77%|███████▋  | 130744320/169001437 [00:05<00:01, 31548238.11it/s] 79%|███████▉  | 133922816/169001437 [00:05<00:01, 31483188.78it/s] 81%|████████  | 137101312/169001437 [00:05<00:01, 31345429.18it/s] 83%|████████▎ | 140345344/169001437 [00:05<00:00, 31243800.96it/s] 85%|████████▍ | 143523840/169001437 [00:05<00:00, 31154139.48it/s] 87%|████████▋ | 146669568/169001437 [00:06<00:00, 31167244.03it/s] 89%|████████▊ | 149848064/169001437 [00:06<00:00, 31345099.05it/s] 91%|█████████ | 153092096/169001437 [00:06<00:00, 31647916.86it/s] 92%|█████████▏| 156270592/169001437 [00:06<00:00, 31523194.18it/s] 94%|█████████▍| 159449088/169001437 [00:06<00:00, 31494455.79it/s] 96%|█████████▋| 162725888/169001437 [00:06<00:00, 31866447.61it/s] 98%|█████████▊| 165969920/169001437 [00:06<00:00, 32000233.80it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 25078152.27it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Using prompt template: The colour is mostly {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▌                                     | 4.78M/338M [00:00<00:07, 49.2MiB/s]  6%|██▏                                    | 18.8M/338M [00:00<00:03, 106MiB/s] 10%|███▊                                   | 32.5M/338M [00:00<00:02, 123MiB/s] 13%|█████▏                                 | 45.4M/338M [00:00<00:02, 128MiB/s] 17%|██████▋                                | 58.3M/338M [00:00<00:02, 130MiB/s] 21%|████████▎                              | 71.8M/338M [00:00<00:02, 134MiB/s] 25%|█████████▊                             | 84.9M/338M [00:00<00:01, 135MiB/s] 29%|███████████▎                           | 97.8M/338M [00:00<00:01, 135MiB/s] 33%|█████████████▏                          | 111M/338M [00:00<00:01, 137MiB/s] 37%|██████████████▊                         | 125M/338M [00:01<00:01, 139MiB/s] 41%|████████████████▍                       | 139M/338M [00:01<00:01, 140MiB/s] 45%|█████████████████▉                      | 152M/338M [00:01<00:01, 138MiB/s] 49%|███████████████████▌                    | 165M/338M [00:01<00:01, 135MiB/s] 53%|█████████████████████                   | 178M/338M [00:01<00:01, 136MiB/s] 57%|██████████████████████▋                 | 191M/338M [00:01<00:01, 137MiB/s] 61%|████████████████████████▏               | 205M/338M [00:01<00:01, 137MiB/s] 64%|█████████████████████████▊              | 218M/338M [00:01<00:00, 137MiB/s] 68%|███████████████████████████▎            | 231M/338M [00:01<00:00, 138MiB/s] 72%|████████████████████████████▉           | 245M/338M [00:01<00:00, 139MiB/s] 77%|██████████████████████████████▊         | 260M/338M [00:02<00:00, 146MiB/s] 81%|████████████████████████████████▍       | 274M/338M [00:02<00:00, 145MiB/s] 85%|██████████████████████████████████▏     | 288M/338M [00:02<00:00, 141MiB/s] 89%|███████████████████████████████████▋    | 302M/338M [00:02<00:00, 140MiB/s] 93%|█████████████████████████████████████▎  | 315M/338M [00:02<00:00, 140MiB/s] 98%|███████████████████████████████████████ | 330M/338M [00:02<00:00, 145MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 137MiB/s]


List of prompts:
['The colour is mostly red',
 'The colour is mostly blue',
 'The colour is mostly green']
Precomputing text features
