Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:26, 333398.72it/s]  0%|          | 163840/169001437 [00:00<06:30, 432187.03it/s]  0%|          | 262144/169001437 [00:00<05:54, 475374.21it/s]  0%|          | 393216/169001437 [00:00<04:10, 671918.05it/s]  0%|          | 720896/169001437 [00:00<02:04, 1351085.85it/s]  1%|          | 1474560/169001437 [00:00<00:55, 3032040.18it/s]  1%|▏         | 2457600/169001437 [00:00<00:33, 4921829.60it/s]  3%|▎         | 4259840/169001437 [00:01<00:19, 8653182.89it/s]  4%|▎         | 6062080/169001437 [00:01<00:14, 11356999.60it/s]  5%|▍         | 7929856/169001437 [00:01<00:11, 13495387.59it/s]  6%|▌         | 9895936/169001437 [00:01<00:10, 15295990.41it/s]  7%|▋         | 11894784/169001437 [00:01<00:09, 16660630.90it/s]  8%|▊         | 13959168/169001437 [00:01<00:08, 17831639.21it/s]  9%|▉         | 15794176/169001437 [00:01<00:08, 17924521.50it/s] 11%|█         | 17858560/169001437 [00:01<00:08, 18725013.74it/s] 12%|█▏        | 19890176/169001437 [00:01<00:07, 19187195.08it/s] 13%|█▎        | 22118400/169001437 [00:01<00:07, 20102068.52it/s] 14%|█▍        | 24313856/169001437 [00:02<00:07, 20597774.16it/s] 16%|█▌        | 26574848/169001437 [00:02<00:06, 20444093.70it/s] 17%|█▋        | 28639232/169001437 [00:02<00:06, 20371513.39it/s] 18%|█▊        | 30867456/169001437 [00:02<00:06, 20869995.63it/s] 20%|█▉        | 33030144/169001437 [00:02<00:06, 21056281.50it/s] 21%|██        | 35356672/169001437 [00:02<00:06, 21707078.58it/s] 22%|██▏       | 37781504/169001437 [00:02<00:05, 22349439.01it/s] 24%|██▍       | 40173568/169001437 [00:02<00:05, 22758761.82it/s] 25%|██▌       | 42729472/169001437 [00:02<00:05, 23580159.22it/s] 27%|██▋       | 45318144/169001437 [00:03<00:05, 24148832.36it/s] 28%|██▊       | 48103424/169001437 [00:03<00:04, 25248681.00it/s] 30%|███       | 50921472/169001437 [00:03<00:04, 26101416.44it/s] 32%|███▏      | 53903360/169001437 [00:03<00:04, 27125249.10it/s] 34%|███▎      | 56852480/169001437 [00:03<00:04, 27753992.73it/s] 35%|███▌      | 59670528/169001437 [00:03<00:03, 27876904.64it/s] 37%|███▋      | 62488576/169001437 [00:03<00:03, 27785233.92it/s] 39%|███▊      | 65404928/169001437 [00:03<00:03, 28186448.28it/s] 40%|████      | 68255744/169001437 [00:03<00:03, 28228686.61it/s] 42%|████▏     | 71270400/169001437 [00:03<00:03, 28407344.03it/s] 44%|████▍     | 74350592/169001437 [00:04<00:03, 28597299.34it/s] 46%|████▌     | 77463552/169001437 [00:04<00:03, 28753289.75it/s] 48%|████▊     | 80412672/169001437 [00:04<00:03, 28639319.03it/s] 49%|████▉     | 83394560/169001437 [00:04<00:02, 28721102.69it/s] 51%|█████     | 86540288/169001437 [00:04<00:02, 28764079.04it/s] 53%|█████▎    | 89620480/169001437 [00:04<00:02, 28950307.28it/s] 55%|█████▍    | 92667904/169001437 [00:04<00:02, 28829770.93it/s] 57%|█████▋    | 95715328/169001437 [00:04<00:02, 28887422.18it/s] 58%|█████▊    | 98861056/169001437 [00:04<00:02, 29036842.29it/s] 60%|██████    | 101941248/169001437 [00:04<00:02, 29197470.70it/s] 62%|██████▏   | 105086976/169001437 [00:05<00:02, 29759645.70it/s] 64%|██████▍   | 108068864/169001437 [00:05<00:02, 28959097.20it/s] 66%|██████▌   | 111214592/169001437 [00:05<00:01, 29423129.46it/s] 68%|██████▊   | 114491392/169001437 [00:05<00:01, 30379734.82it/s] 70%|██████▉   | 117637120/169001437 [00:05<00:01, 30586547.68it/s] 72%|███████▏  | 120881152/169001437 [00:05<00:01, 31110509.89it/s] 73%|███████▎  | 124026880/169001437 [00:05<00:01, 31182033.80it/s] 75%|███████▌  | 127172608/169001437 [00:05<00:01, 30578319.54it/s] 77%|███████▋  | 130351104/169001437 [00:05<00:01, 30918785.67it/s] 79%|███████▉  | 133627904/169001437 [00:06<00:01, 31443427.46it/s] 81%|████████  | 136839168/169001437 [00:06<00:01, 31637812.11it/s] 83%|████████▎ | 140083200/169001437 [00:06<00:00, 31855130.24it/s] 85%|████████▍ | 143294464/169001437 [00:06<00:00, 30312778.49it/s] 87%|████████▋ | 146407424/169001437 [00:06<00:00, 30419979.37it/s] 89%|████████▊ | 149651456/169001437 [00:06<00:00, 31001764.92it/s] 90%|█████████ | 152797184/169001437 [00:06<00:00, 31032448.39it/s] 92%|█████████▏| 156041216/169001437 [00:06<00:00, 31440706.69it/s] 94%|█████████▍| 159219712/169001437 [00:06<00:00, 31390313.33it/s] 96%|█████████▌| 162365440/169001437 [00:06<00:00, 31271111.78it/s] 98%|█████████▊| 165511168/169001437 [00:07<00:00, 31073364.85it/s]100%|█████████▉| 168755200/169001437 [00:07<00:00, 31432764.00it/s]100%|██████████| 169001437/169001437 [00:07<00:00, 23631226.46it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Using prompt template: This image is mostly {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 3.33M/338M [00:00<00:10, 33.7MiB/s]  5%|█▉                                    | 17.0M/338M [00:00<00:03, 97.1MiB/s]  9%|███▌                                   | 30.5M/338M [00:00<00:02, 117MiB/s] 13%|█████                                  | 44.2M/338M [00:00<00:02, 128MiB/s] 17%|██████▋                                | 57.7M/338M [00:00<00:02, 133MiB/s] 21%|████████▏                              | 71.4M/338M [00:00<00:02, 136MiB/s] 25%|█████████▋                             | 84.4M/338M [00:00<00:01, 136MiB/s] 29%|███████████▎                           | 97.8M/338M [00:00<00:01, 137MiB/s] 33%|█████████████▎                          | 112M/338M [00:00<00:01, 141MiB/s] 37%|██████████████▉                         | 126M/338M [00:01<00:01, 143MiB/s] 41%|████████████████▌                       | 140M/338M [00:01<00:01, 142MiB/s] 45%|██████████████████▏                     | 153M/338M [00:01<00:01, 141MiB/s] 49%|███████████████████▊                    | 167M/338M [00:01<00:01, 141MiB/s] 53%|█████████████████████▎                  | 180M/338M [00:01<00:01, 141MiB/s] 57%|██████████████████████▉                 | 194M/338M [00:01<00:01, 141MiB/s] 61%|████████████████████████▌               | 207M/338M [00:01<00:00, 141MiB/s] 65%|██████████████████████████▏             | 221M/338M [00:01<00:00, 140MiB/s] 69%|███████████████████████████▊            | 235M/338M [00:01<00:00, 141MiB/s] 74%|█████████████████████████████▍          | 248M/338M [00:01<00:00, 142MiB/s] 78%|███████████████████████████████         | 262M/338M [00:02<00:00, 142MiB/s] 82%|████████████████████████████████▋       | 276M/338M [00:02<00:00, 144MiB/s] 86%|██████████████████████████████████▎     | 290M/338M [00:02<00:00, 144MiB/s] 90%|███████████████████████████████████▉    | 303M/338M [00:02<00:00, 143MiB/s] 94%|█████████████████████████████████████▌  | 317M/338M [00:02<00:00, 144MiB/s] 98%|███████████████████████████████████████▏| 331M/338M [00:02<00:00, 143MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 138MiB/s]


List of prompts:
['This image is mostly red',
 'This image is mostly blue',
 'This image is mostly green']
Precomputing text features
