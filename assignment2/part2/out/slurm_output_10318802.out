Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:08, 345625.77it/s]  0%|          | 131072/169001437 [00:00<06:01, 467000.80it/s]  0%|          | 196608/169001437 [00:00<05:15, 534473.70it/s]  0%|          | 360448/169001437 [00:00<03:59, 704447.26it/s]  0%|          | 720896/169001437 [00:00<01:52, 1493286.80it/s]  1%|          | 1376256/169001437 [00:00<00:57, 2911348.74it/s]  2%|▏         | 2785280/169001437 [00:00<00:27, 6109009.54it/s]  3%|▎         | 4587520/169001437 [00:00<00:17, 9562983.18it/s]  4%|▎         | 6291456/169001437 [00:01<00:13, 11751542.05it/s]  5%|▍         | 8093696/169001437 [00:01<00:11, 13542010.80it/s]  6%|▌         | 10027008/169001437 [00:01<00:10, 15249586.01it/s]  7%|▋         | 12025856/169001437 [00:01<00:09, 16634508.71it/s]  8%|▊         | 14155776/169001437 [00:01<00:08, 18005462.26it/s] 10%|▉         | 16252928/169001437 [00:01<00:08, 18761800.81it/s] 11%|█         | 18644992/169001437 [00:01<00:07, 20268855.31it/s] 12%|█▏        | 20807680/169001437 [00:01<00:07, 20657950.50it/s] 14%|█▎        | 23068672/169001437 [00:01<00:07, 20064800.10it/s] 15%|█▌        | 25526272/169001437 [00:02<00:06, 21355960.21it/s] 17%|█▋        | 28016640/169001437 [00:02<00:07, 20097367.18it/s] 18%|█▊        | 30703616/169001437 [00:02<00:06, 21933040.70it/s] 20%|█▉        | 33390592/169001437 [00:02<00:05, 23300225.85it/s] 21%|██▏       | 36208640/169001437 [00:02<00:05, 24449756.71it/s] 23%|██▎       | 39256064/169001437 [00:02<00:04, 26124755.44it/s] 25%|██▍       | 42237952/169001437 [00:02<00:04, 27130418.55it/s] 27%|██▋       | 45449216/169001437 [00:02<00:04, 28567475.73it/s] 29%|██▉       | 48693248/169001437 [00:02<00:04, 29689113.07it/s] 31%|███       | 51937280/169001437 [00:02<00:03, 30493920.23it/s] 33%|███▎      | 55017472/169001437 [00:03<00:03, 30395779.49it/s] 34%|███▍      | 58261504/169001437 [00:03<00:03, 30985939.71it/s] 36%|███▋      | 61374464/169001437 [00:03<00:03, 30923639.96it/s] 38%|███▊      | 64487424/169001437 [00:03<00:03, 30865908.20it/s] 40%|███▉      | 67600384/169001437 [00:03<00:03, 30833350.01it/s] 42%|████▏     | 70713344/169001437 [00:03<00:03, 30796392.10it/s] 44%|████▎     | 73891840/169001437 [00:03<00:03, 30888339.64it/s] 46%|████▌     | 77135872/169001437 [00:03<00:02, 31336697.73it/s] 48%|████▊     | 80379904/169001437 [00:03<00:02, 31649176.73it/s] 49%|████▉     | 83558400/169001437 [00:03<00:02, 31606904.44it/s] 51%|█████▏    | 86802432/169001437 [00:04<00:02, 31846231.14it/s] 53%|█████▎    | 90013696/169001437 [00:04<00:02, 31772112.27it/s] 55%|█████▌    | 93192192/169001437 [00:04<00:02, 31583032.33it/s] 57%|█████▋    | 96370688/169001437 [00:04<00:02, 31479490.37it/s] 59%|█████▉    | 99581952/169001437 [00:04<00:02, 28605678.51it/s] 61%|██████    | 102825984/169001437 [00:04<00:02, 29655149.88it/s] 63%|██████▎   | 106070016/169001437 [00:04<00:02, 30434752.75it/s] 65%|██████▍   | 109215744/169001437 [00:04<00:02, 29680570.41it/s] 67%|██████▋   | 112459776/169001437 [00:04<00:01, 30458556.06it/s] 68%|██████▊   | 115703808/169001437 [00:05<00:01, 31021720.47it/s] 70%|███████   | 118849536/169001437 [00:05<00:01, 31043497.91it/s] 72%|███████▏  | 121995264/169001437 [00:05<00:01, 31016128.84it/s] 74%|███████▍  | 125108224/169001437 [00:05<00:01, 30932810.72it/s] 76%|███████▌  | 128221184/169001437 [00:05<00:01, 29940269.75it/s] 78%|███████▊  | 131530752/169001437 [00:05<00:01, 30831205.11it/s] 80%|███████▉  | 134643712/169001437 [00:05<00:01, 30792998.01it/s] 82%|████████▏ | 137887744/169001437 [00:05<00:00, 31263414.23it/s] 84%|████████▎ | 141131776/169001437 [00:05<00:00, 31586240.98it/s] 85%|████████▌ | 144310272/169001437 [00:05<00:00, 31622978.65it/s] 87%|████████▋ | 147587072/169001437 [00:06<00:00, 31802899.35it/s] 89%|████████▉ | 150798336/169001437 [00:06<00:00, 31693642.19it/s] 91%|█████████ | 154042368/169001437 [00:06<00:00, 31904066.31it/s] 93%|█████████▎| 157253632/169001437 [00:06<00:00, 31773176.68it/s] 95%|█████████▍| 160432128/169001437 [00:06<00:00, 29529714.96it/s] 97%|█████████▋| 163676160/169001437 [00:06<00:00, 30332350.93it/s] 99%|█████████▉| 166920192/169001437 [00:06<00:00, 30920600.91it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 25082864.39it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Using prompt template: The most dominant colour is {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▍                                     | 3.80M/338M [00:00<00:08, 39.8MiB/s]  5%|█▊                                    | 15.6M/338M [00:00<00:03, 89.1MiB/s]  8%|██▊                                   | 25.5M/338M [00:00<00:03, 95.7MiB/s] 10%|███▉                                  | 34.6M/338M [00:00<00:03, 87.3MiB/s] 13%|████▊                                 | 43.0M/338M [00:00<00:03, 81.8MiB/s] 15%|█████▋                                | 50.9M/338M [00:00<00:03, 78.3MiB/s] 17%|██████▌                               | 58.5M/338M [00:00<00:03, 73.9MiB/s] 19%|███████▍                              | 65.6M/338M [00:00<00:04, 64.5MiB/s] 21%|████████                              | 71.9M/338M [00:01<00:04, 60.3MiB/s] 23%|████████▊                             | 77.8M/338M [00:01<00:05, 51.2MiB/s] 25%|█████████▎                            | 82.9M/338M [00:01<00:05, 46.0MiB/s] 26%|█████████▊                            | 87.5M/338M [00:01<00:06, 41.0MiB/s] 27%|██████████▎                           | 91.6M/338M [00:01<00:07, 35.9MiB/s] 28%|██████████▋                           | 95.1M/338M [00:01<00:08, 31.2MiB/s] 29%|███████████                           | 98.3M/338M [00:02<00:09, 26.8MiB/s] 30%|███████████▋                           | 101M/338M [00:02<00:10, 24.8MiB/s] 31%|███████████▉                           | 103M/338M [00:02<00:10, 23.8MiB/s] 31%|████████████▏                          | 106M/338M [00:02<00:10, 23.5MiB/s] 32%|████████████▍                          | 108M/338M [00:02<00:10, 23.3MiB/s] 33%|████████████▊                          | 111M/338M [00:02<00:09, 24.0MiB/s] 33%|█████████████                          | 113M/338M [00:02<00:09, 24.5MiB/s] 34%|█████████████▍                         | 116M/338M [00:02<00:09, 25.7MiB/s] 35%|█████████████▋                         | 119M/338M [00:02<00:08, 26.6MiB/s] 36%|██████████████                         | 122M/338M [00:03<00:08, 27.8MiB/s] 37%|██████████████▍                        | 125M/338M [00:03<00:07, 29.1MiB/s] 38%|██████████████▊                        | 128M/338M [00:03<00:07, 30.5MiB/s] 39%|███████████████▏                       | 131M/338M [00:03<00:06, 31.6MiB/s] 40%|███████████████▌                       | 135M/338M [00:03<00:06, 32.9MiB/s] 41%|███████████████▉                       | 138M/338M [00:03<00:06, 34.1MiB/s] 42%|████████████████▍                      | 142M/338M [00:03<00:05, 35.2MiB/s] 43%|████████████████▊                      | 146M/338M [00:03<00:05, 36.7MiB/s] 44%|█████████████████▎                     | 150M/338M [00:03<00:05, 37.8MiB/s] 46%|█████████████████▊                     | 154M/338M [00:03<00:04, 39.4MiB/s] 47%|██████████████████▏                    | 158M/338M [00:04<00:04, 39.9MiB/s] 48%|██████████████████▋                    | 162M/338M [00:04<00:04, 41.4MiB/s] 49%|███████████████████▏                   | 167M/338M [00:04<00:04, 42.9MiB/s] 51%|███████████████████▊                   | 171M/338M [00:04<00:03, 44.3MiB/s] 52%|████████████████████▎                  | 176M/338M [00:04<00:03, 45.6MiB/s] 54%|████████████████████▊                  | 181M/338M [00:04<00:03, 47.0MiB/s] 55%|█████████████████████▍                 | 186M/338M [00:04<00:03, 48.1MiB/s] 56%|██████████████████████                 | 191M/338M [00:04<00:03, 49.7MiB/s] 58%|██████████████████████▌                | 196M/338M [00:04<00:02, 50.6MiB/s] 60%|███████████████████████▏               | 201M/338M [00:04<00:02, 51.9MiB/s] 61%|███████████████████████▊               | 206M/338M [00:05<00:02, 53.0MiB/s] 63%|████████████████████████▍              | 212M/338M [00:05<00:02, 54.5MiB/s] 64%|█████████████████████████▏             | 218M/338M [00:05<00:02, 55.5MiB/s] 66%|█████████████████████████▊             | 224M/338M [00:05<00:02, 57.1MiB/s] 68%|██████████████████████████▌            | 230M/338M [00:05<00:01, 58.6MiB/s] 70%|███████████████████████████▏           | 236M/338M [00:05<00:01, 60.0MiB/s] 72%|███████████████████████████▉           | 242M/338M [00:05<00:01, 60.9MiB/s] 73%|████████████████████████████▋          | 248M/338M [00:05<00:01, 62.3MiB/s] 75%|█████████████████████████████▍         | 254M/338M [00:05<00:01, 63.6MiB/s] 77%|██████████████████████████████▏        | 261M/338M [00:05<00:01, 65.4MiB/s] 79%|██████████████████████████████▉        | 268M/338M [00:06<00:01, 66.6MiB/s] 81%|███████████████████████████████▋       | 275M/338M [00:06<00:00, 67.9MiB/s] 83%|████████████████████████████████▌      | 282M/338M [00:06<00:00, 69.3MiB/s] 86%|█████████████████████████████████▎     | 289M/338M [00:06<00:00, 70.7MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:06<00:00, 72.4MiB/s] 90%|███████████████████████████████████    | 303M/338M [00:06<00:00, 73.3MiB/s] 92%|███████████████████████████████████▉   | 311M/338M [00:06<00:00, 74.5MiB/s] 94%|████████████████████████████████████▊  | 318M/338M [00:06<00:00, 75.4MiB/s] 97%|█████████████████████████████████████▋ | 326M/338M [00:06<00:00, 76.6MiB/s] 99%|██████████████████████████████████████▌| 334M/338M [00:07<00:00, 78.0MiB/s]100%|███████████████████████████████████████| 338M/338M [00:07<00:00, 50.2MiB/s]


List of prompts:
['The most dominant colour is red',
 'The most dominant colour is blue',
 'The most dominant colour is green']
Precomputing text features
