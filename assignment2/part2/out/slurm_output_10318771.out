Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:26, 333494.58it/s]  0%|          | 131072/169001437 [00:00<08:10, 344605.74it/s]  0%|          | 196608/169001437 [00:00<06:33, 429190.71it/s]  0%|          | 294912/169001437 [00:00<05:56, 473497.16it/s]  0%|          | 458752/169001437 [00:00<03:43, 753597.27it/s]  1%|          | 884736/169001437 [00:00<01:40, 1671157.03it/s]  1%|          | 1769472/169001437 [00:00<00:46, 3624768.85it/s]  2%|▏         | 3178496/169001437 [00:01<00:25, 6554148.72it/s]  3%|▎         | 4980736/169001437 [00:01<00:16, 9823215.26it/s]  4%|▍         | 6717440/169001437 [00:01<00:13, 12001139.30it/s]  5%|▌         | 8519680/169001437 [00:01<00:11, 13762589.28it/s]  6%|▌         | 10387456/169001437 [00:01<00:11, 13955448.88it/s]  7%|▋         | 12156928/169001437 [00:01<00:11, 13484976.90it/s]  8%|▊         | 13959168/169001437 [00:01<00:10, 14650460.81it/s]  9%|▉         | 15925248/169001437 [00:01<00:09, 15778565.80it/s] 11%|█         | 17891328/169001437 [00:01<00:08, 16824443.38it/s] 12%|█▏        | 20021248/169001437 [00:02<00:08, 18075649.49it/s] 13%|█▎        | 22249472/169001437 [00:02<00:07, 19267766.65it/s] 15%|█▍        | 24510464/169001437 [00:02<00:07, 20222362.14it/s] 16%|█▌        | 26771456/169001437 [00:02<00:06, 20920065.52it/s] 17%|█▋        | 29163520/169001437 [00:02<00:06, 21797419.37it/s] 19%|█▊        | 31588352/169001437 [00:02<00:06, 22523268.05it/s] 20%|██        | 34078720/169001437 [00:02<00:05, 23217579.84it/s] 22%|██▏       | 36536320/169001437 [00:02<00:05, 23615456.76it/s] 23%|██▎       | 39092224/169001437 [00:02<00:05, 24183171.36it/s] 25%|██▍       | 41615360/169001437 [00:02<00:05, 23097890.45it/s] 26%|██▌       | 44171264/169001437 [00:03<00:05, 21245679.12it/s] 28%|██▊       | 46792704/169001437 [00:03<00:05, 22568978.20it/s] 29%|██▉       | 49414144/169001437 [00:03<00:05, 23279416.55it/s] 31%|███       | 52232192/169001437 [00:03<00:04, 24476149.37it/s] 33%|███▎      | 55083008/169001437 [00:03<00:04, 25604700.67it/s] 34%|███▍      | 57999360/169001437 [00:03<00:04, 26629083.63it/s] 36%|███▌      | 60948480/169001437 [00:03<00:03, 27458518.59it/s] 38%|███▊      | 63963136/169001437 [00:03<00:03, 28247451.19it/s] 40%|███▉      | 67043328/169001437 [00:03<00:03, 28975661.76it/s] 41%|████▏     | 70057984/169001437 [00:04<00:03, 29306015.68it/s] 43%|████▎     | 73039872/169001437 [00:04<00:03, 29437977.03it/s] 45%|████▌     | 76120064/169001437 [00:04<00:03, 29728715.85it/s] 47%|████▋     | 79429632/169001437 [00:04<00:02, 30710180.89it/s] 49%|████▉     | 82640896/169001437 [00:04<00:02, 31121926.10it/s] 51%|█████     | 85819392/169001437 [00:04<00:02, 31248928.73it/s] 53%|█████▎    | 88965120/169001437 [00:04<00:02, 31172572.19it/s] 55%|█████▍    | 92110848/169001437 [00:04<00:02, 31132867.33it/s] 56%|█████▋    | 95256576/169001437 [00:04<00:02, 31100673.72it/s] 58%|█████▊    | 98369536/169001437 [00:04<00:02, 30980960.66it/s] 60%|██████    | 101548032/169001437 [00:05<00:02, 31069485.86it/s] 62%|██████▏   | 104792064/169001437 [00:05<00:02, 31471188.53it/s] 64%|██████▍   | 107970560/169001437 [00:05<00:01, 31408091.22it/s] 66%|██████▌   | 111181824/169001437 [00:05<00:02, 28370632.29it/s] 68%|██████▊   | 114360320/169001437 [00:05<00:01, 28514095.73it/s] 70%|██████▉   | 117571584/169001437 [00:05<00:01, 29366902.84it/s] 71%|███████▏  | 120815616/169001437 [00:05<00:01, 30213870.32it/s] 73%|███████▎  | 124059648/169001437 [00:05<00:01, 30845945.26it/s] 75%|███████▌  | 127270912/169001437 [00:05<00:01, 30800342.83it/s] 77%|███████▋  | 130514944/169001437 [00:06<00:01, 31275318.08it/s] 79%|███████▉  | 133791744/169001437 [00:06<00:01, 31695525.21it/s] 81%|████████  | 137003008/169001437 [00:06<00:01, 30574352.80it/s] 83%|████████▎ | 140247040/169001437 [00:06<00:00, 31093000.52it/s] 85%|████████▍ | 143392768/169001437 [00:06<00:00, 31098914.72it/s] 87%|████████▋ | 146636800/169001437 [00:06<00:00, 31487364.17it/s] 89%|████████▊ | 149880832/169001437 [00:06<00:00, 31689829.05it/s] 91%|█████████ | 153157632/169001437 [00:06<00:00, 31999934.59it/s] 93%|█████████▎| 156401664/169001437 [00:06<00:00, 32118595.11it/s] 94%|█████████▍| 159645696/169001437 [00:06<00:00, 31238680.70it/s] 96%|█████████▋| 162791424/169001437 [00:07<00:00, 31163356.11it/s] 98%|█████████▊| 165937152/169001437 [00:07<00:00, 31051178.83it/s]100%|██████████| 169001437/169001437 [00:07<00:00, 23376923.72it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Using prompt template: This image is mostly {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 2.62M/338M [00:00<00:12, 27.5MiB/s]  6%|██▏                                    | 18.6M/338M [00:00<00:03, 110MiB/s] 11%|████▎                                  | 37.9M/338M [00:00<00:02, 152MiB/s] 17%|██████▌                                | 56.4M/338M [00:00<00:01, 168MiB/s] 21%|████████▎                              | 72.4M/338M [00:00<00:01, 159MiB/s] 26%|██████████▏                            | 88.1M/338M [00:00<00:01, 160MiB/s] 31%|████████████▎                           | 104M/338M [00:00<00:01, 162MiB/s] 36%|██████████████▎                         | 121M/338M [00:00<00:01, 165MiB/s] 40%|████████████████▏                       | 136M/338M [00:00<00:01, 160MiB/s] 45%|█████████████████▉                      | 152M/338M [00:01<00:01, 129MiB/s] 49%|███████████████████▌                    | 165M/338M [00:01<00:01, 102MiB/s] 52%|████████████████████▎                  | 176M/338M [00:01<00:01, 86.1MiB/s] 55%|█████████████████████▍                 | 185M/338M [00:01<00:02, 78.0MiB/s] 57%|██████████████████████▍                | 194M/338M [00:01<00:02, 72.7MiB/s] 60%|███████████████████████▏               | 201M/338M [00:01<00:02, 69.3MiB/s] 62%|████████████████████████               | 208M/338M [00:02<00:02, 67.1MiB/s] 64%|████████████████████████▊              | 215M/338M [00:02<00:01, 65.2MiB/s] 65%|█████████████████████████▌             | 221M/338M [00:02<00:01, 64.9MiB/s] 67%|██████████████████████████▎            | 227M/338M [00:02<00:01, 64.6MiB/s] 69%|██████████████████████████▉            | 233M/338M [00:02<00:01, 64.3MiB/s] 71%|███████████████████████████▋           | 240M/338M [00:02<00:01, 64.4MiB/s] 73%|████████████████████████████▍          | 246M/338M [00:02<00:01, 65.6MiB/s] 75%|█████████████████████████████▏         | 253M/338M [00:02<00:01, 66.6MiB/s] 77%|██████████████████████████████         | 260M/338M [00:02<00:01, 67.4MiB/s] 79%|██████████████████████████████▊        | 266M/338M [00:03<00:01, 60.9MiB/s] 81%|███████████████████████████████▍       | 272M/338M [00:03<00:01, 57.3MiB/s] 82%|████████████████████████████████       | 278M/338M [00:03<00:01, 55.0MiB/s] 84%|████████████████████████████████▋      | 283M/338M [00:03<00:01, 53.6MiB/s] 85%|█████████████████████████████████▎     | 288M/338M [00:03<00:00, 53.0MiB/s] 87%|█████████████████████████████████▉     | 293M/338M [00:03<00:00, 52.1MiB/s] 88%|██████████████████████████████████▍    | 298M/338M [00:03<00:00, 51.8MiB/s] 90%|███████████████████████████████████    | 304M/338M [00:03<00:00, 51.9MiB/s] 91%|███████████████████████████████████▋   | 309M/338M [00:03<00:00, 53.1MiB/s] 93%|████████████████████████████████████▎  | 314M/338M [00:04<00:00, 53.0MiB/s] 95%|████████████████████████████████████▉  | 320M/338M [00:04<00:00, 54.3MiB/s] 96%|█████████████████████████████████████▌ | 325M/338M [00:04<00:00, 55.7MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:04<00:00, 56.0MiB/s]100%|██████████████████████████████████████▊| 336M/338M [00:04<00:00, 57.5MiB/s]100%|███████████████████████████████████████| 338M/338M [00:04<00:00, 79.5MiB/s]


List of prompts:
['This image is mostly red blue green']
Precomputing text features
