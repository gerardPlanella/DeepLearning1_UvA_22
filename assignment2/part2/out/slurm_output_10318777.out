Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:04, 348350.19it/s]  0%|          | 131072/169001437 [00:00<06:49, 412141.88it/s]  0%|          | 229376/169001437 [00:00<05:29, 511477.47it/s]  0%|          | 491520/169001437 [00:00<02:46, 1014089.73it/s]  1%|          | 1081344/169001437 [00:00<01:11, 2345516.86it/s]  1%|▏         | 2195456/169001437 [00:00<00:34, 4808637.15it/s]  2%|▏         | 3997696/169001437 [00:00<00:19, 8581753.89it/s]  3%|▎         | 5537792/169001437 [00:01<00:15, 10541940.62it/s]  4%|▍         | 7372800/169001437 [00:01<00:14, 11528571.49it/s]  5%|▌         | 9175040/169001437 [00:01<00:12, 13119606.64it/s]  7%|▋         | 11108352/169001437 [00:01<00:10, 14838152.33it/s]  8%|▊         | 13107200/169001437 [00:01<00:09, 16269218.77it/s]  9%|▉         | 15204352/169001437 [00:01<00:08, 17613793.81it/s] 10%|█         | 17334272/169001437 [00:01<00:08, 18671129.95it/s] 12%|█▏        | 19529728/169001437 [00:01<00:07, 19635190.64it/s] 13%|█▎        | 21790720/169001437 [00:01<00:07, 20499581.96it/s] 14%|█▍        | 23953408/169001437 [00:01<00:07, 19392123.25it/s] 16%|█▌        | 26247168/169001437 [00:02<00:07, 20337034.99it/s] 17%|█▋        | 28606464/169001437 [00:02<00:06, 21269300.31it/s] 18%|█▊        | 31129600/169001437 [00:02<00:06, 22401479.61it/s] 20%|█▉        | 33652736/169001437 [00:02<00:05, 23224988.55it/s] 21%|██▏       | 36241408/169001437 [00:02<00:05, 23991652.45it/s] 23%|██▎       | 38830080/169001437 [00:02<00:05, 24552610.00it/s] 25%|██▍       | 41582592/169001437 [00:02<00:05, 25416575.84it/s] 26%|██▋       | 44367872/169001437 [00:02<00:04, 26142446.43it/s] 28%|██▊       | 47185920/169001437 [00:02<00:05, 24211698.26it/s] 30%|██▉       | 50135040/169001437 [00:03<00:04, 25617756.97it/s] 31%|███▏      | 53149696/169001437 [00:03<00:04, 26750069.26it/s] 33%|███▎      | 56328192/169001437 [00:03<00:04, 28153819.11it/s] 35%|███▌      | 59408384/169001437 [00:03<00:03, 28865001.12it/s] 37%|███▋      | 62652416/169001437 [00:03<00:03, 29883158.86it/s] 39%|███▉      | 65896448/169001437 [00:03<00:03, 30634667.56it/s] 41%|████      | 69140480/169001437 [00:03<00:03, 31161896.98it/s] 43%|████▎     | 72286208/169001437 [00:03<00:03, 31114309.88it/s] 45%|████▍     | 75464704/169001437 [00:03<00:02, 31299808.78it/s] 47%|████▋     | 78675968/169001437 [00:03<00:02, 31523030.74it/s] 48%|████▊     | 81854464/169001437 [00:04<00:02, 31542365.18it/s] 50%|█████     | 85032960/169001437 [00:04<00:02, 31368217.62it/s] 52%|█████▏    | 88178688/169001437 [00:04<00:02, 30727344.97it/s] 54%|█████▍    | 91324416/169001437 [00:04<00:02, 30467321.47it/s] 56%|█████▌    | 94437376/169001437 [00:04<00:02, 30551717.28it/s] 58%|█████▊    | 97583104/169001437 [00:04<00:02, 30558391.13it/s] 60%|█████▉    | 100827136/169001437 [00:04<00:02, 31047158.73it/s] 62%|██████▏   | 103940096/169001437 [00:04<00:02, 30921546.09it/s] 63%|██████▎   | 107085824/169001437 [00:04<00:01, 31062219.06it/s] 65%|██████▌   | 110264320/169001437 [00:04<00:01, 31215812.59it/s] 67%|██████▋   | 113410048/169001437 [00:05<00:01, 30938986.02it/s] 69%|██████▉   | 116523008/169001437 [00:05<00:01, 30885855.64it/s] 71%|███████   | 119635968/169001437 [00:05<00:01, 30577050.66it/s] 73%|███████▎  | 122847232/169001437 [00:05<00:01, 31029300.30it/s] 75%|███████▍  | 125960192/169001437 [00:05<00:01, 30787653.57it/s] 76%|███████▋  | 129040384/169001437 [00:05<00:01, 30724209.89it/s] 78%|███████▊  | 132120576/169001437 [00:05<00:01, 30572913.51it/s] 80%|███████▉  | 135200768/169001437 [00:05<00:01, 30377153.04it/s] 82%|████████▏ | 138346496/169001437 [00:05<00:01, 30392779.73it/s] 84%|████████▎ | 141393920/169001437 [00:05<00:00, 30288608.07it/s] 86%|████████▌ | 144637952/169001437 [00:06<00:00, 30336269.20it/s] 87%|████████▋ | 147718144/169001437 [00:06<00:00, 30340202.27it/s] 89%|████████▉ | 150831104/169001437 [00:06<00:00, 30460836.22it/s] 91%|█████████ | 154042368/169001437 [00:06<00:00, 30481242.10it/s] 93%|█████████▎| 157220864/169001437 [00:06<00:00, 30671321.46it/s] 95%|█████████▍| 160464896/169001437 [00:06<00:00, 31161258.13it/s] 97%|█████████▋| 163610624/169001437 [00:06<00:00, 31001082.61it/s] 99%|█████████▊| 166821888/169001437 [00:06<00:00, 31316854.15it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24598372.46it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Using prompt template: This image is mostly {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 3.03M/338M [00:00<00:11, 31.6MiB/s]  6%|██▏                                    | 18.9M/338M [00:00<00:03, 111MiB/s] 10%|████                                   | 35.2M/338M [00:00<00:02, 137MiB/s] 15%|██████                                 | 52.0M/338M [00:00<00:01, 150MiB/s] 20%|███████▉                               | 68.6M/338M [00:00<00:01, 159MiB/s] 25%|█████████▊                             | 84.9M/338M [00:00<00:01, 162MiB/s] 30%|████████████                            | 101M/338M [00:00<00:01, 164MiB/s] 35%|██████████████                          | 118M/338M [00:00<00:01, 166MiB/s] 40%|███████████████▉                        | 135M/338M [00:00<00:01, 168MiB/s] 45%|█████████████████▉                      | 151M/338M [00:01<00:01, 168MiB/s] 50%|████████████████████                    | 169M/338M [00:01<00:01, 175MiB/s] 57%|██████████████████████▊                 | 192M/338M [00:01<00:00, 193MiB/s] 64%|█████████████████████████▌              | 216M/338M [00:01<00:00, 211MiB/s] 71%|████████████████████████████▍           | 240M/338M [00:01<00:00, 224MiB/s] 78%|███████████████████████████████▎        | 265M/338M [00:01<00:00, 233MiB/s] 85%|█████████████████████████████████▉      | 287M/338M [00:01<00:00, 233MiB/s] 92%|████████████████████████████████████▋   | 309M/338M [00:01<00:00, 224MiB/s] 98%|███████████████████████████████████████▏| 331M/338M [00:01<00:00, 220MiB/s]100%|████████████████████████████████████████| 338M/338M [00:01<00:00, 187MiB/s]


List of prompts:
['This image is mostly red',
 'This image is mostly blue',
 'This image is mostly green']
Precomputing text features
