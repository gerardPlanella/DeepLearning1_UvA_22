Running experiment on cifar10 with random_patch and prompt size 1
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=16, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', root='/scratch/lcur0640', dataset='cifar10', image_size=224, test_noise=False, visualize_prompt=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume='.//save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar', evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0640/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:30, 333572.29it/s]  0%|          | 131072/170498071 [00:00<07:06, 399714.99it/s]  0%|          | 196608/170498071 [00:00<06:40, 425135.91it/s]  0%|          | 393216/170498071 [00:00<03:17, 861219.41it/s]  0%|          | 851968/170498071 [00:00<01:26, 1951125.79it/s]  1%|          | 1769472/170498071 [00:00<00:41, 4077489.08it/s]  2%|▏         | 2883584/170498071 [00:00<00:27, 6165922.76it/s]  3%|▎         | 4816896/170498071 [00:00<00:16, 10072038.55it/s]  4%|▍         | 6848512/170498071 [00:01<00:12, 13109207.44it/s]  5%|▌         | 8945664/170498071 [00:01<00:11, 14159222.66it/s]  6%|▋         | 10944512/170498071 [00:01<00:10, 15787299.46it/s]  8%|▊         | 13172736/170498071 [00:01<00:08, 17626090.71it/s]  9%|▉         | 15368192/170498071 [00:01<00:09, 17071761.47it/s] 10%|█         | 17793024/170498071 [00:01<00:08, 19016819.24it/s] 12%|█▏        | 20348928/170498071 [00:01<00:07, 20841711.61it/s] 13%|█▎        | 22970368/170498071 [00:01<00:06, 22068793.50it/s] 15%|█▌        | 25591808/170498071 [00:01<00:06, 23109426.36it/s] 17%|█▋        | 28508160/170498071 [00:02<00:05, 24839948.52it/s] 18%|█▊        | 31490048/170498071 [00:02<00:05, 26281278.76it/s] 20%|██        | 34734080/170498071 [00:02<00:04, 28079762.75it/s] 22%|██▏       | 37912576/170498071 [00:02<00:04, 29161366.63it/s] 24%|██▍       | 40861696/170498071 [00:02<00:04, 29206549.68it/s] 26%|██▌       | 43843584/170498071 [00:02<00:04, 29356948.78it/s] 28%|██▊       | 47087616/170498071 [00:02<00:04, 30254508.27it/s] 30%|██▉       | 50331648/170498071 [00:02<00:03, 30901089.01it/s] 31%|███▏      | 53444608/170498071 [00:02<00:03, 30920460.71it/s] 33%|███▎      | 56557568/170498071 [00:02<00:03, 30932325.68it/s] 35%|███▍      | 59670528/170498071 [00:03<00:03, 30870481.76it/s] 37%|███▋      | 62783488/170498071 [00:03<00:03, 30820328.22it/s] 39%|███▊      | 65896448/170498071 [00:03<00:03, 30788141.20it/s] 41%|████      | 69140480/170498071 [00:03<00:03, 31269167.03it/s] 42%|████▏     | 72417280/170498071 [00:03<00:03, 31704976.70it/s] 44%|████▍     | 75595776/170498071 [00:03<00:03, 30806064.15it/s] 46%|████▋     | 78872576/170498071 [00:03<00:02, 31361708.78it/s] 48%|████▊     | 82149376/170498071 [00:03<00:03, 28503630.29it/s] 50%|█████     | 85393408/170498071 [00:03<00:02, 29575932.34it/s] 52%|█████▏    | 88506368/170498071 [00:04<00:02, 29926389.00it/s] 54%|█████▍    | 91750400/170498071 [00:04<00:02, 30625400.52it/s] 56%|█████▌    | 94961664/170498071 [00:04<00:02, 31049647.24it/s] 58%|█████▊    | 98107392/170498071 [00:04<00:02, 30138147.94it/s] 59%|█████▉    | 101187584/170498071 [00:04<00:02, 30214197.04it/s] 61%|██████    | 104398848/170498071 [00:04<00:02, 30761589.90it/s] 63%|██████▎   | 107511808/170498071 [00:04<00:02, 30728709.11it/s] 65%|██████▍   | 110624768/170498071 [00:04<00:01, 30727233.93it/s] 67%|██████▋   | 113704960/170498071 [00:04<00:01, 30602777.01it/s] 68%|██████▊   | 116785152/170498071 [00:04<00:01, 30549165.71it/s] 70%|███████   | 119996416/170498071 [00:05<00:01, 31011192.67it/s] 72%|███████▏  | 123109376/170498071 [00:05<00:01, 30961031.90it/s] 74%|███████▍  | 126255104/170498071 [00:05<00:01, 30887760.32it/s] 76%|███████▌  | 129499136/170498071 [00:05<00:01, 31100620.61it/s] 78%|███████▊  | 132710400/170498071 [00:05<00:01, 31395353.24it/s] 80%|███████▉  | 135888896/170498071 [00:05<00:01, 31508815.17it/s] 82%|████████▏ | 139067392/170498071 [00:05<00:00, 31475205.79it/s] 83%|████████▎ | 142311424/170498071 [00:05<00:00, 31741147.36it/s] 85%|████████▌ | 145489920/170498071 [00:05<00:00, 31679122.02it/s] 87%|████████▋ | 148668416/170498071 [00:05<00:00, 31590063.55it/s] 89%|████████▉ | 151846912/170498071 [00:06<00:00, 31461152.37it/s] 91%|█████████ | 155025408/170498071 [00:06<00:00, 31371725.20it/s] 93%|█████████▎| 158171136/170498071 [00:06<00:00, 31237208.49it/s] 95%|█████████▍| 161316864/170498071 [00:06<00:00, 31143953.51it/s] 96%|█████████▋| 164462592/170498071 [00:06<00:00, 31090960.29it/s] 98%|█████████▊| 167575552/170498071 [00:06<00:00, 29278992.12it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25617986.58it/s]
/home/lcur0640/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0640/cifar-10-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  0%|▏                                     | 1.47M/338M [00:00<00:23, 15.0MiB/s]  1%|▎                                     | 2.91M/338M [00:00<00:28, 12.4MiB/s]  1%|▍                                     | 4.12M/338M [00:00<00:29, 11.9MiB/s]  2%|▌                                     | 5.42M/338M [00:00<00:28, 12.2MiB/s]  2%|▋                                     | 6.60M/338M [00:00<00:31, 11.1MiB/s]  2%|▊                                     | 7.68M/338M [00:00<00:31, 10.9MiB/s]  3%|▉                                     | 8.74M/338M [00:00<00:31, 11.0MiB/s]  3%|█                                     | 9.80M/338M [00:00<00:31, 11.0MiB/s]  3%|█▏                                    | 10.9M/338M [00:01<00:32, 10.5MiB/s]  4%|█▎                                    | 11.9M/338M [00:01<00:32, 10.4MiB/s]  4%|█▍                                    | 13.1M/338M [00:01<00:31, 10.7MiB/s]  4%|█▌                                    | 14.4M/338M [00:01<00:29, 11.5MiB/s]  5%|█▊                                    | 15.8M/338M [00:01<00:27, 12.4MiB/s]  5%|█▉                                    | 17.0M/338M [00:01<00:28, 11.8MiB/s]  5%|██                                    | 18.2M/338M [00:01<00:28, 11.8MiB/s]  6%|██▏                                   | 19.6M/338M [00:01<00:26, 12.4MiB/s]  6%|██▍                                   | 21.1M/338M [00:01<00:24, 13.3MiB/s]  7%|██▌                                   | 22.7M/338M [00:01<00:23, 14.3MiB/s]  7%|██▊                                   | 24.5M/338M [00:02<00:21, 15.4MiB/s]  8%|██▉                                   | 26.0M/338M [00:02<00:23, 14.1MiB/s]  8%|███                                   | 27.4M/338M [00:02<00:25, 12.6MiB/s]  8%|███▏                                  | 28.6M/338M [00:02<00:25, 12.5MiB/s]  9%|███▎                                  | 29.9M/338M [00:02<00:25, 12.4MiB/s]  9%|███▍                                  | 31.1M/338M [00:02<00:26, 12.2MiB/s] 10%|███▋                                  | 32.2M/338M [00:02<00:27, 11.8MiB/s] 10%|███▊                                  | 33.5M/338M [00:02<00:26, 12.0MiB/s] 10%|███▉                                  | 34.9M/338M [00:03<00:25, 12.6MiB/s] 11%|████                                  | 36.2M/338M [00:03<00:26, 12.1MiB/s] 11%|████▏                                 | 37.3M/338M [00:03<00:27, 11.6MiB/s] 11%|████▎                                 | 38.4M/338M [00:03<00:29, 10.7MiB/s] 12%|████▍                                 | 39.5M/338M [00:03<00:29, 10.4MiB/s] 12%|████▌                                 | 40.6M/338M [00:03<00:28, 10.7MiB/s] 12%|████▋                                 | 41.7M/338M [00:03<00:29, 10.7MiB/s] 13%|████▊                                 | 42.7M/338M [00:03<00:29, 10.5MiB/s] 13%|████▉                                 | 43.9M/338M [00:03<00:28, 10.8MiB/s] 13%|█████                                 | 44.9M/338M [00:04<00:28, 10.8MiB/s] 14%|█████▏                                | 46.0M/338M [00:04<00:29, 10.5MiB/s] 14%|█████▎                                | 47.1M/338M [00:04<00:28, 10.7MiB/s] 14%|█████▍                                | 48.1M/338M [00:04<00:30, 9.98MiB/s] 15%|█████▌                                | 49.1M/338M [00:04<00:30, 9.84MiB/s] 15%|█████▋                                | 50.1M/338M [00:04<00:29, 10.1MiB/s] 15%|█████▊                                | 51.4M/338M [00:04<00:27, 10.8MiB/s] 16%|█████▉                                | 52.8M/338M [00:04<00:25, 11.7MiB/s] 16%|██████                                | 54.3M/338M [00:04<00:23, 12.7MiB/s] 17%|██████▎                               | 55.7M/338M [00:04<00:22, 13.0MiB/s] 17%|██████▍                               | 57.0M/338M [00:05<00:22, 13.0MiB/s] 17%|██████▌                               | 58.3M/338M [00:05<00:22, 13.1MiB/s] 18%|██████▋                               | 59.9M/338M [00:05<00:21, 13.7MiB/s] 18%|██████▉                               | 61.2M/338M [00:05<00:21, 13.4MiB/s] 18%|███████                               | 62.4M/338M [00:05<00:22, 12.8MiB/s] 19%|███████▏                              | 63.7M/338M [00:05<00:22, 12.8MiB/s] 19%|███████▎                              | 65.1M/338M [00:05<00:21, 13.1MiB/s] 20%|███████▍                              | 66.3M/338M [00:05<00:24, 11.7MiB/s] 20%|███████▌                              | 67.5M/338M [00:05<00:24, 11.5MiB/s] 20%|███████▋                              | 68.7M/338M [00:06<00:24, 11.7MiB/s] 21%|███████▊                              | 69.8M/338M [00:06<00:25, 11.0MiB/s] 21%|███████▉                              | 70.9M/338M [00:06<00:26, 10.6MiB/s] 21%|████████                              | 72.0M/338M [00:06<00:25, 10.7MiB/s] 22%|████████▏                             | 73.2M/338M [00:06<00:25, 11.0MiB/s] 22%|████████▎                             | 74.2M/338M [00:06<00:26, 10.3MiB/s] 22%|████████▍                             | 75.3M/338M [00:06<00:26, 10.3MiB/s] 23%|████████▌                             | 76.5M/338M [00:06<00:25, 10.7MiB/s] 23%|████████▊                             | 77.8M/338M [00:06<00:23, 11.4MiB/s] 23%|████████▉                             | 79.2M/338M [00:07<00:22, 12.3MiB/s] 24%|█████████                             | 80.4M/338M [00:07<00:22, 11.8MiB/s] 24%|█████████▏                            | 81.5M/338M [00:07<00:22, 11.8MiB/s] 25%|█████████▎                            | 82.9M/338M [00:07<00:21, 12.4MiB/s] 25%|█████████▍                            | 84.2M/338M [00:07<00:21, 12.6MiB/s] 25%|█████████▌                            | 85.4M/338M [00:07<00:21, 12.3MiB/s] 26%|█████████▊                            | 86.6M/338M [00:07<00:21, 12.2MiB/s] 26%|█████████▉                            | 87.8M/338M [00:07<00:23, 11.3MiB/s] 26%|██████████                            | 88.9M/338M [00:07<00:23, 11.2MiB/s] 27%|██████████▏                           | 90.0M/338M [00:08<00:23, 11.2MiB/s] 27%|██████████▎                           | 91.3M/338M [00:08<00:22, 11.7MiB/s] 27%|██████████▍                           | 92.4M/338M [00:08<00:23, 11.0MiB/s] 28%|██████████▌                           | 93.5M/338M [00:08<00:24, 10.6MiB/s] 28%|██████████▋                           | 94.6M/338M [00:08<00:23, 10.9MiB/s] 28%|██████████▊                           | 96.0M/338M [00:08<00:21, 11.5MiB/s] 29%|██████████▉                           | 97.5M/338M [00:08<00:20, 12.5MiB/s] 29%|███████████▏                          | 99.0M/338M [00:08<00:18, 13.3MiB/s] 30%|███████████▌                           | 100M/338M [00:08<00:19, 12.8MiB/s] 30%|███████████▋                           | 102M/338M [00:09<00:18, 13.2MiB/s] 31%|███████████▉                           | 103M/338M [00:09<00:18, 13.6MiB/s] 31%|████████████                           | 105M/338M [00:09<00:16, 14.6MiB/s] 31%|████████████▎                          | 106M/338M [00:09<00:17, 13.8MiB/s] 32%|████████████▍                          | 108M/338M [00:09<00:19, 12.1MiB/s] 32%|████████████▌                          | 109M/338M [00:09<00:20, 11.6MiB/s] 33%|████████████▋                          | 110M/338M [00:09<00:20, 11.5MiB/s] 33%|████████████▊                          | 111M/338M [00:09<00:19, 12.1MiB/s] 33%|█████████████                          | 113M/338M [00:09<00:18, 12.8MiB/s] 34%|█████████████▏                         | 114M/338M [00:10<00:17, 13.2MiB/s] 34%|█████████████▎                         | 115M/338M [00:10<00:17, 13.6MiB/s] 35%|█████████████▍                         | 117M/338M [00:10<00:17, 13.4MiB/s] 35%|█████████████▋                         | 118M/338M [00:10<00:16, 13.6MiB/s] 35%|█████████████▊                         | 120M/338M [00:10<00:19, 11.7MiB/s] 36%|█████████████▉                         | 121M/338M [00:10<00:21, 10.8MiB/s] 36%|██████████████                         | 122M/338M [00:10<00:21, 10.7MiB/s] 36%|██████████████▏                        | 123M/338M [00:10<00:20, 10.8MiB/s] 37%|██████████████▎                        | 124M/338M [00:10<00:19, 11.4MiB/s] 37%|██████████████▍                        | 125M/338M [00:11<00:19, 11.2MiB/s] 37%|██████████████▌                        | 126M/338M [00:11<00:19, 11.2MiB/s] 38%|██████████████▋                        | 128M/338M [00:11<00:18, 11.8MiB/s] 38%|██████████████▉                        | 129M/338M [00:11<00:18, 11.6MiB/s] 38%|███████████████                        | 130M/338M [00:11<00:19, 11.4MiB/s] 39%|███████████████▏                       | 131M/338M [00:11<00:18, 11.5MiB/s] 39%|███████████████▎                       | 133M/338M [00:11<00:17, 12.3MiB/s] 40%|███████████████▍                       | 134M/338M [00:11<00:17, 12.3MiB/s] 40%|███████████████▌                       | 135M/338M [00:11<00:17, 12.1MiB/s] 40%|███████████████▋                       | 136M/338M [00:12<00:18, 11.3MiB/s] 41%|███████████████▊                       | 137M/338M [00:12<00:19, 10.7MiB/s] 41%|███████████████▉                       | 138M/338M [00:12<00:19, 10.7MiB/s] 41%|████████████████                       | 139M/338M [00:12<00:18, 11.1MiB/s] 42%|████████████████▎                      | 141M/338M [00:12<00:17, 11.9MiB/s] 42%|████████████████▍                      | 142M/338M [00:12<00:15, 12.9MiB/s] 43%|████████████████▌                      | 144M/338M [00:12<00:16, 12.7MiB/s] 43%|████████████████▋                      | 145M/338M [00:12<00:16, 12.3MiB/s] 43%|████████████████▊                      | 146M/338M [00:12<00:17, 11.4MiB/s] 44%|████████████████▉                      | 147M/338M [00:13<00:17, 11.2MiB/s] 44%|█████████████████▏                     | 148M/338M [00:13<00:17, 11.2MiB/s] 44%|█████████████████▎                     | 149M/338M [00:13<00:17, 11.1MiB/s] 45%|█████████████████▍                     | 150M/338M [00:13<00:18, 10.8MiB/s] 45%|█████████████████▌                     | 152M/338M [00:13<00:17, 10.9MiB/s] 45%|█████████████████▋                     | 153M/338M [00:13<00:16, 11.6MiB/s] 46%|█████████████████▊                     | 154M/338M [00:13<00:15, 12.4MiB/s] 46%|██████████████████                     | 156M/338M [00:13<00:14, 13.5MiB/s] 47%|██████████████████▏                    | 158M/338M [00:13<00:13, 14.5MiB/s] 47%|██████████████████▎                    | 159M/338M [00:13<00:12, 14.5MiB/s] 47%|██████████████████▌                    | 160M/338M [00:14<00:15, 12.4MiB/s] 48%|██████████████████▋                    | 162M/338M [00:14<00:15, 11.9MiB/s] 48%|██████████████████▊                    | 163M/338M [00:14<00:15, 11.8MiB/s] 49%|██████████████████▉                    | 164M/338M [00:14<00:14, 12.2MiB/s] 49%|███████████████████▏                   | 166M/338M [00:14<00:13, 13.0MiB/s] 49%|███████████████████▎                   | 167M/338M [00:14<00:15, 11.7MiB/s] 50%|███████████████████▍                   | 168M/338M [00:14<00:16, 10.5MiB/s] 50%|███████████████████▌                   | 169M/338M [00:14<00:16, 10.5MiB/s] 50%|███████████████████▋                   | 170M/338M [00:15<00:16, 10.5MiB/s] 51%|███████████████████▊                   | 171M/338M [00:15<00:16, 10.7MiB/s] 51%|███████████████████▉                   | 172M/338M [00:15<00:16, 10.7MiB/s] 51%|████████████████████                   | 173M/338M [00:15<00:15, 10.8MiB/s] 52%|████████████████████▏                  | 175M/338M [00:15<00:15, 11.2MiB/s] 52%|████████████████████▎                  | 176M/338M [00:15<00:14, 11.7MiB/s] 52%|████████████████████▍                  | 177M/338M [00:15<00:14, 11.6MiB/s] 53%|████████████████████▌                  | 178M/338M [00:15<00:14, 11.8MiB/s] 53%|████████████████████▊                  | 180M/338M [00:15<00:13, 12.4MiB/s] 54%|████████████████████▉                  | 181M/338M [00:16<00:13, 12.2MiB/s] 54%|█████████████████████                  | 182M/338M [00:16<00:13, 11.7MiB/s] 54%|█████████████████████▏                 | 183M/338M [00:16<00:14, 10.8MiB/s] 55%|█████████████████████▎                 | 184M/338M [00:16<00:15, 10.5MiB/s] 55%|█████████████████████▍                 | 185M/338M [00:16<00:15, 10.6MiB/s] 55%|█████████████████████▌                 | 187M/338M [00:16<00:14, 11.1MiB/s] 56%|█████████████████████▋                 | 188M/338M [00:16<00:13, 12.0MiB/s] 56%|█████████████████████▉                 | 189M/338M [00:16<00:11, 13.0MiB/s] 57%|██████████████████████                 | 191M/338M [00:16<00:10, 14.0MiB/s] 57%|██████████████████████▏                | 193M/338M [00:17<00:10, 14.5MiB/s] 57%|██████████████████████▍                | 194M/338M [00:17<00:10, 14.2MiB/s] 58%|██████████████████████▌                | 195M/338M [00:17<00:12, 12.4MiB/s] 58%|██████████████████████▋                | 197M/338M [00:17<00:12, 12.1MiB/s] 59%|██████████████████████▊                | 198M/338M [00:17<00:11, 12.3MiB/s] 59%|██████████████████████▉                | 199M/338M [00:17<00:11, 12.6MiB/s] 59%|███████████████████████▏               | 200M/338M [00:17<00:12, 11.8MiB/s] 60%|███████████████████████▎               | 201M/338M [00:17<00:12, 11.8MiB/s] 60%|███████████████████████▍               | 203M/338M [00:17<00:11, 12.3MiB/s] 60%|███████████████████████▌               | 204M/338M [00:18<00:11, 12.1MiB/s] 61%|███████████████████████▋               | 205M/338M [00:18<00:11, 12.0MiB/s] 61%|███████████████████████▊               | 206M/338M [00:18<00:12, 10.7MiB/s] 61%|███████████████████████▉               | 207M/338M [00:18<00:12, 10.6MiB/s] 62%|████████████████████████               | 208M/338M [00:18<00:12, 10.7MiB/s] 62%|████████████████████████▏              | 209M/338M [00:18<00:12, 10.6MiB/s] 62%|████████████████████████▎              | 211M/338M [00:18<00:12, 10.5MiB/s] 63%|████████████████████████▍              | 212M/338M [00:18<00:12, 10.4MiB/s] 63%|████████████████████████▌              | 213M/338M [00:18<00:11, 11.1MiB/s] 63%|████████████████████████▋              | 214M/338M [00:19<00:10, 11.9MiB/s] 64%|████████████████████████▉              | 215M/338M [00:19<00:10, 12.3MiB/s] 64%|█████████████████████████              | 217M/338M [00:19<00:10, 12.1MiB/s] 65%|█████████████████████████▏             | 218M/338M [00:19<00:10, 12.4MiB/s] 65%|█████████████████████████▎             | 219M/338M [00:19<00:10, 12.4MiB/s] 65%|█████████████████████████▍             | 220M/338M [00:19<00:10, 11.7MiB/s] 66%|█████████████████████████▌             | 221M/338M [00:19<00:10, 11.5MiB/s] 66%|█████████████████████████▋             | 223M/338M [00:19<00:10, 11.9MiB/s] 66%|█████████████████████████▉             | 224M/338M [00:19<00:09, 12.6MiB/s] 67%|██████████████████████████             | 225M/338M [00:19<00:09, 12.4MiB/s] 67%|██████████████████████████▏            | 227M/338M [00:20<00:09, 12.0MiB/s] 67%|██████████████████████████▎            | 228M/338M [00:20<00:09, 12.4MiB/s] 68%|██████████████████████████▍            | 229M/338M [00:20<00:09, 11.9MiB/s] 68%|██████████████████████████▌            | 230M/338M [00:20<00:09, 11.5MiB/s] 69%|██████████████████████████▋            | 231M/338M [00:20<00:09, 11.6MiB/s] 69%|██████████████████████████▉            | 233M/338M [00:20<00:09, 12.2MiB/s] 69%|███████████████████████████            | 234M/338M [00:20<00:08, 12.7MiB/s] 70%|███████████████████████████▏           | 236M/338M [00:20<00:07, 13.7MiB/s] 70%|███████████████████████████▍           | 237M/338M [00:20<00:07, 14.6MiB/s] 71%|███████████████████████████▌           | 239M/338M [00:21<00:07, 14.5MiB/s] 71%|███████████████████████████▋           | 240M/338M [00:21<00:08, 12.6MiB/s] 71%|███████████████████████████▉           | 241M/338M [00:21<00:08, 12.0MiB/s] 72%|████████████████████████████           | 243M/338M [00:21<00:08, 12.1MiB/s] 72%|████████████████████████████▏          | 244M/338M [00:21<00:07, 12.3MiB/s] 73%|████████████████████████████▎          | 245M/338M [00:21<00:07, 13.1MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:21<00:06, 14.0MiB/s] 74%|████████████████████████████▋          | 248M/338M [00:21<00:06, 14.0MiB/s] 74%|████████████████████████████▊          | 250M/338M [00:21<00:06, 13.8MiB/s] 74%|████████████████████████████▉          | 251M/338M [00:22<00:06, 13.9MiB/s] 75%|█████████████████████████████▏         | 252M/338M [00:22<00:06, 13.6MiB/s] 75%|█████████████████████████████▎         | 254M/338M [00:22<00:07, 12.5MiB/s] 75%|█████████████████████████████▍         | 255M/338M [00:22<00:06, 12.6MiB/s] 76%|█████████████████████████████▌         | 256M/338M [00:22<00:06, 13.0MiB/s] 76%|█████████████████████████████▋         | 257M/338M [00:22<00:07, 11.9MiB/s] 77%|█████████████████████████████▉         | 259M/338M [00:22<00:07, 11.6MiB/s] 77%|██████████████████████████████         | 260M/338M [00:22<00:07, 11.6MiB/s] 77%|██████████████████████████████▏        | 261M/338M [00:22<00:06, 12.3MiB/s] 78%|██████████████████████████████▎        | 262M/338M [00:23<00:06, 11.9MiB/s] 78%|██████████████████████████████▍        | 263M/338M [00:23<00:06, 11.7MiB/s] 78%|██████████████████████████████▌        | 265M/338M [00:23<00:06, 12.3MiB/s] 79%|██████████████████████████████▊        | 266M/338M [00:23<00:05, 12.9MiB/s] 79%|██████████████████████████████▉        | 268M/338M [00:23<00:05, 13.9MiB/s] 80%|███████████████████████████████        | 269M/338M [00:23<00:05, 13.3MiB/s] 80%|███████████████████████████████▏       | 270M/338M [00:23<00:05, 12.3MiB/s] 80%|███████████████████████████████▍       | 272M/338M [00:23<00:06, 11.4MiB/s] 81%|███████████████████████████████▌       | 273M/338M [00:23<00:06, 11.2MiB/s] 81%|███████████████████████████████▋       | 274M/338M [00:24<00:06, 10.9MiB/s] 81%|███████████████████████████████▊       | 275M/338M [00:24<00:06, 10.2MiB/s] 82%|███████████████████████████████▊       | 276M/338M [00:24<00:06, 10.2MiB/s] 82%|███████████████████████████████▉       | 277M/338M [00:24<00:06, 10.5MiB/s] 82%|████████████████████████████████▏      | 278M/338M [00:24<00:05, 11.3MiB/s] 83%|████████████████████████████████▎      | 280M/338M [00:24<00:05, 12.1MiB/s] 83%|████████████████████████████████▍      | 281M/338M [00:24<00:04, 13.2MiB/s] 84%|████████████████████████████████▋      | 283M/338M [00:24<00:04, 12.7MiB/s] 84%|████████████████████████████████▊      | 284M/338M [00:24<00:04, 12.9MiB/s] 85%|████████████████████████████████▉      | 285M/338M [00:25<00:04, 13.6MiB/s] 85%|█████████████████████████████████▏     | 287M/338M [00:25<00:03, 14.3MiB/s] 86%|█████████████████████████████████▎     | 289M/338M [00:25<00:03, 15.2MiB/s] 86%|█████████████████████████████████▌     | 290M/338M [00:25<00:03, 16.2MiB/s] 87%|█████████████████████████████████▊     | 292M/338M [00:25<00:02, 17.5MiB/s] 87%|██████████████████████████████████     | 295M/338M [00:25<00:02, 18.8MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:25<00:02, 18.3MiB/s] 88%|██████████████████████████████████▍    | 298M/338M [00:25<00:02, 18.3MiB/s] 89%|██████████████████████████████████▋    | 300M/338M [00:25<00:02, 18.1MiB/s] 89%|██████████████████████████████████▊    | 302M/338M [00:25<00:02, 16.5MiB/s] 90%|███████████████████████████████████    | 303M/338M [00:26<00:02, 15.7MiB/s] 90%|███████████████████████████████████▏   | 305M/338M [00:26<00:02, 15.4MiB/s] 91%|███████████████████████████████████▍   | 306M/338M [00:26<00:02, 13.7MiB/s] 91%|███████████████████████████████████▌   | 308M/338M [00:26<00:02, 13.2MiB/s] 92%|███████████████████████████████████▋   | 309M/338M [00:26<00:02, 13.2MiB/s] 92%|███████████████████████████████████▊   | 310M/338M [00:26<00:02, 13.5MiB/s] 92%|████████████████████████████████████   | 312M/338M [00:26<00:01, 14.4MiB/s] 93%|████████████████████████████████████▏  | 313M/338M [00:26<00:01, 14.2MiB/s] 93%|████████████████████████████████████▎  | 315M/338M [00:26<00:01, 14.0MiB/s] 94%|████████████████████████████████████▌  | 316M/338M [00:27<00:01, 12.7MiB/s] 94%|████████████████████████████████████▋  | 317M/338M [00:27<00:01, 12.0MiB/s] 94%|████████████████████████████████████▊  | 319M/338M [00:27<00:01, 12.1MiB/s] 95%|████████████████████████████████████▉  | 320M/338M [00:27<00:01, 11.8MiB/s] 95%|█████████████████████████████████████  | 321M/338M [00:27<00:01, 11.1MiB/s] 95%|█████████████████████████████████████▏ | 322M/338M [00:27<00:01, 11.0MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:27<00:01, 11.3MiB/s] 96%|█████████████████████████████████████▍ | 325M/338M [00:27<00:01, 11.9MiB/s] 97%|█████████████████████████████████████▋ | 326M/338M [00:28<00:00, 12.9MiB/s] 97%|█████████████████████████████████████▊ | 328M/338M [00:28<00:00, 13.9MiB/s] 98%|██████████████████████████████████████ | 329M/338M [00:28<00:00, 14.7MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:28<00:00, 14.3MiB/s] 98%|██████████████████████████████████████▎| 332M/338M [00:28<00:00, 13.2MiB/s] 99%|██████████████████████████████████████▌| 333M/338M [00:28<00:00, 11.0MiB/s] 99%|██████████████████████████████████████▋| 334M/338M [00:28<00:00, 10.4MiB/s] 99%|██████████████████████████████████████▊| 336M/338M [00:28<00:00, 10.5MiB/s]100%|██████████████████████████████████████▉| 337M/338M [00:28<00:00, 11.0MiB/s]100%|███████████████████████████████████████| 338M/338M [00:29<00:00, 12.2MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
=> loading checkpoint './/save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar'
=> loaded checkpoint './/save/models/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar' (epoch 17)
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Files already downloaded and verified
Files already downloaded and verified
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0640/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:25, 333980.01it/s]  0%|          | 131072/169001437 [00:00<07:00, 401176.92it/s]  0%|          | 196608/169001437 [00:00<05:47, 485169.07it/s]  0%|          | 393216/169001437 [00:00<03:24, 824562.72it/s]  0%|          | 819200/169001437 [00:00<01:33, 1798865.67it/s]  1%|          | 1376256/169001437 [00:00<00:58, 2885028.00it/s]  2%|▏         | 2818048/169001437 [00:00<00:26, 6231866.36it/s]  3%|▎         | 4620288/169001437 [00:00<00:16, 9681544.88it/s]  4%|▍         | 6520832/169001437 [00:01<00:13, 12409854.79it/s]  5%|▍         | 8388608/169001437 [00:01<00:11, 14260463.53it/s]  6%|▌         | 10321920/169001437 [00:01<00:10, 15763036.41it/s]  7%|▋         | 12353536/169001437 [00:01<00:09, 17115278.43it/s]  9%|▊         | 14385152/169001437 [00:01<00:08, 18066955.44it/s] 10%|▉         | 16547840/169001437 [00:01<00:08, 17905323.14it/s] 11%|█         | 18743296/169001437 [00:01<00:07, 18954215.13it/s] 12%|█▏        | 21037056/169001437 [00:01<00:07, 20086754.73it/s] 14%|█▍        | 23429120/169001437 [00:01<00:06, 21153517.75it/s] 15%|█▌        | 25919488/169001437 [00:02<00:06, 22245644.14it/s] 17%|█▋        | 28508160/169001437 [00:02<00:06, 21106362.32it/s] 18%|█▊        | 31064064/169001437 [00:02<00:06, 22144395.83it/s] 20%|█▉        | 33718272/169001437 [00:02<00:05, 23305820.95it/s] 22%|██▏       | 36536320/169001437 [00:02<00:05, 24692839.17it/s] 23%|██▎       | 39616512/169001437 [00:02<00:04, 26436992.88it/s] 25%|██▌       | 42729472/169001437 [00:02<00:04, 27805995.47it/s] 27%|██▋       | 45711360/169001437 [00:02<00:04, 28395318.46it/s] 29%|██▉       | 48955392/169001437 [00:02<00:04, 29581272.71it/s] 31%|███       | 52068352/169001437 [00:02<00:03, 29916463.15it/s] 33%|███▎      | 55246848/169001437 [00:03<00:03, 30440914.39it/s] 35%|███▍      | 58425344/169001437 [00:03<00:03, 30840627.47it/s] 36%|███▋      | 61571072/169001437 [00:03<00:03, 31012278.69it/s] 38%|███▊      | 64782336/169001437 [00:03<00:03, 30067796.47it/s] 40%|████      | 67993600/169001437 [00:03<00:03, 30207859.12it/s] 42%|████▏     | 71073792/169001437 [00:03<00:03, 30378722.05it/s] 44%|████▍     | 74186752/169001437 [00:03<00:03, 30331469.99it/s] 46%|████▌     | 77463552/169001437 [00:03<00:02, 30817921.37it/s] 48%|████▊     | 80740352/169001437 [00:03<00:02, 31371312.63it/s] 50%|████▉     | 83886080/169001437 [00:03<00:02, 30627580.74it/s] 52%|█████▏    | 87097344/169001437 [00:04<00:02, 31038176.62it/s] 53%|█████▎    | 90210304/169001437 [00:04<00:02, 30764956.86it/s] 55%|█████▌    | 93388800/169001437 [00:04<00:02, 31048201.59it/s] 57%|█████▋    | 96501760/169001437 [00:04<00:02, 31051327.51it/s] 59%|█████▉    | 99614720/169001437 [00:04<00:02, 30464642.45it/s] 61%|██████    | 102825984/169001437 [00:04<00:02, 30808963.79it/s] 63%|██████▎   | 105938944/169001437 [00:04<00:02, 30571343.30it/s] 65%|██████▍   | 109019136/169001437 [00:04<00:01, 30548679.60it/s] 66%|██████▋   | 112099328/169001437 [00:04<00:01, 30134657.31it/s] 68%|██████▊   | 115146752/169001437 [00:05<00:01, 30019307.39it/s] 70%|██████▉   | 118161408/169001437 [00:05<00:01, 29935670.12it/s] 72%|███████▏  | 121176064/169001437 [00:05<00:01, 29804544.09it/s] 74%|███████▎  | 124387328/169001437 [00:05<00:01, 30035232.45it/s] 75%|███████▌  | 127565824/169001437 [00:05<00:01, 30534565.14it/s] 77%|███████▋  | 130744320/169001437 [00:05<00:01, 30889694.48it/s] 79%|███████▉  | 133890048/169001437 [00:05<00:01, 30943902.68it/s] 81%|████████  | 137035776/169001437 [00:05<00:01, 30574093.28it/s] 83%|████████▎ | 140214272/169001437 [00:05<00:00, 30929590.42it/s] 85%|████████▍ | 143392768/169001437 [00:05<00:00, 31169357.97it/s] 87%|████████▋ | 146538496/169001437 [00:06<00:00, 31123126.39it/s] 89%|████████▊ | 149684224/169001437 [00:06<00:00, 29786789.51it/s] 90%|█████████ | 152862720/169001437 [00:06<00:00, 30308000.75it/s] 92%|█████████▏| 156008448/169001437 [00:06<00:00, 29696773.62it/s] 94%|█████████▍| 159154176/169001437 [00:06<00:00, 29825407.68it/s] 96%|█████████▌| 162299904/169001437 [00:06<00:00, 30285196.18it/s] 98%|█████████▊| 165445632/169001437 [00:06<00:00, 30206433.15it/s]100%|█████████▉| 168656896/169001437 [00:06<00:00, 30752513.09it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24882290.36it/s]
Extracting /scratch/lcur0640/cifar-100-python.tar.gz to /scratch/lcur0640
Files already downloaded and verified
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck',
 'This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:06<08:39,  6.65s/it]  3%|▎         | 2/79 [00:06<03:42,  2.89s/it]  4%|▍         | 3/79 [00:07<02:10,  1.71s/it]  5%|▌         | 4/79 [00:07<01:25,  1.14s/it]  6%|▋         | 5/79 [00:07<01:00,  1.22it/s]  8%|▊         | 6/79 [00:08<00:46,  1.57it/s]  9%|▉         | 7/79 [00:08<00:38,  1.88it/s] 10%|█         | 8/79 [00:08<00:31,  2.22it/s] 11%|█▏        | 9/79 [00:08<00:26,  2.60it/s] 13%|█▎        | 10/79 [00:09<00:23,  2.92it/s] 14%|█▍        | 11/79 [00:09<00:21,  3.18it/s] 15%|█▌        | 12/79 [00:09<00:20,  3.29it/s] 16%|█▋        | 13/79 [00:09<00:18,  3.48it/s] 18%|█▊        | 14/79 [00:10<00:19,  3.39it/s] 19%|█▉        | 15/79 [00:10<00:18,  3.46it/s] 20%|██        | 16/79 [00:10<00:17,  3.52it/s] 22%|██▏       | 17/79 [00:11<00:18,  3.32it/s] 23%|██▎       | 18/79 [00:11<00:17,  3.40it/s] 24%|██▍       | 19/79 [00:11<00:16,  3.60it/s] 25%|██▌       | 20/79 [00:11<00:15,  3.75it/s] 27%|██▋       | 21/79 [00:12<00:15,  3.77it/s] 28%|██▊       | 22/79 [00:12<00:15,  3.61it/s] 29%|██▉       | 23/79 [00:12<00:16,  3.45it/s] 30%|███       | 24/79 [00:12<00:15,  3.52it/s] 32%|███▏      | 25/79 [00:13<00:14,  3.68it/s] 33%|███▎      | 26/79 [00:13<00:15,  3.49it/s] 34%|███▍      | 27/79 [00:13<00:14,  3.55it/s] 35%|███▌      | 28/79 [00:14<00:14,  3.47it/s] 37%|███▋      | 29/79 [00:14<00:15,  3.33it/s] 38%|███▊      | 30/79 [00:14<00:13,  3.52it/s] 39%|███▉      | 31/79 [00:14<00:13,  3.65it/s] 41%|████      | 32/79 [00:15<00:12,  3.65it/s] 42%|████▏     | 33/79 [00:15<00:12,  3.64it/s] 43%|████▎     | 34/79 [00:15<00:12,  3.74it/s] 44%|████▍     | 35/79 [00:16<00:11,  3.71it/s] 46%|████▌     | 36/79 [00:16<00:11,  3.79it/s] 47%|████▋     | 37/79 [00:16<00:11,  3.75it/s] 48%|████▊     | 38/79 [00:16<00:11,  3.72it/s] 49%|████▉     | 39/79 [00:17<00:10,  3.68it/s] 51%|█████     | 40/79 [00:17<00:10,  3.70it/s] 52%|█████▏    | 41/79 [00:17<00:10,  3.49it/s] 53%|█████▎    | 42/79 [00:17<00:10,  3.46it/s] 54%|█████▍    | 43/79 [00:18<00:10,  3.50it/s] 56%|█████▌    | 44/79 [00:18<00:09,  3.67it/s] 57%|█████▋    | 45/79 [00:18<00:09,  3.62it/s] 58%|█████▊    | 46/79 [00:19<00:08,  3.76it/s] 59%|█████▉    | 47/79 [00:19<00:08,  3.61it/s] 61%|██████    | 48/79 [00:19<00:08,  3.71it/s] 62%|██████▏   | 49/79 [00:19<00:07,  3.82it/s] 63%|██████▎   | 50/79 [00:20<00:07,  3.89it/s] 65%|██████▍   | 51/79 [00:20<00:07,  3.94it/s] 66%|██████▌   | 52/79 [00:20<00:06,  3.97it/s] 67%|██████▋   | 53/79 [00:20<00:06,  4.00it/s] 68%|██████▊   | 54/79 [00:21<00:06,  4.02it/s] 70%|██████▉   | 55/79 [00:21<00:05,  4.06it/s] 71%|███████   | 56/79 [00:21<00:05,  4.07it/s] 72%|███████▏  | 57/79 [00:21<00:05,  4.09it/s] 73%|███████▎  | 58/79 [00:22<00:05,  4.09it/s] 75%|███████▍  | 59/79 [00:22<00:04,  4.10it/s] 76%|███████▌  | 60/79 [00:22<00:04,  4.11it/s] 77%|███████▋  | 61/79 [00:22<00:04,  4.10it/s] 78%|███████▊  | 62/79 [00:23<00:04,  4.11it/s] 80%|███████▉  | 63/79 [00:23<00:03,  4.11it/s] 81%|████████  | 64/79 [00:23<00:03,  4.09it/s] 82%|████████▏ | 65/79 [00:23<00:03,  4.08it/s] 84%|████████▎ | 66/79 [00:23<00:03,  4.09it/s] 85%|████████▍ | 67/79 [00:24<00:02,  4.10it/s] 86%|████████▌ | 68/79 [00:24<00:02,  4.10it/s] 87%|████████▋ | 69/79 [00:24<00:02,  4.09it/s] 89%|████████▊ | 70/79 [00:24<00:02,  4.09it/s] 90%|████████▉ | 71/79 [00:25<00:01,  4.08it/s] 91%|█████████ | 72/79 [00:25<00:01,  4.08it/s] 92%|█████████▏| 73/79 [00:25<00:01,  4.08it/s] 94%|█████████▎| 74/79 [00:25<00:01,  4.08it/s] 95%|█████████▍| 75/79 [00:26<00:00,  4.09it/s] 96%|█████████▌| 76/79 [00:26<00:00,  4.08it/s] 97%|█████████▋| 77/79 [00:26<00:00,  4.08it/s] 99%|█████████▊| 78/79 [00:26<00:00,  4.07it/s]100%|██████████| 79/79 [00:27<00:00,  2.91it/s]
Validate: [ 0/79]	Time  6.655 ( 6.655)	Loss 1.0215e+00 (1.0215e+00)	Prompt Acc@1  78.91 ( 78.91)
Validate: [10/79]	Time  0.252 ( 0.850)	Loss 9.9463e-01 (1.0040e+00)	Prompt Acc@1  80.47 ( 77.13)
Validate: [20/79]	Time  0.263 ( 0.576)	Loss 9.3066e-01 (1.0034e+00)	Prompt Acc@1  79.69 ( 77.57)
Validate: [30/79]	Time  0.249 ( 0.483)	Loss 9.9268e-01 (1.0239e+00)	Prompt Acc@1  78.12 ( 76.84)
Validate: [40/79]	Time  0.323 ( 0.432)	Loss 1.0869e+00 (1.0206e+00)	Prompt Acc@1  72.66 ( 76.89)
Validate: [50/79]	Time  0.246 ( 0.399)	Loss 1.0967e+00 (1.0368e+00)	Prompt Acc@1  75.78 ( 76.36)
Validate: [60/79]	Time  0.245 ( 0.373)	Loss 1.0918e+00 (1.0359e+00)	Prompt Acc@1  74.22 ( 76.59)
Validate: [70/79]	Time  0.246 ( 0.355)	Loss 1.1240e+00 (1.0440e+00)	Prompt Acc@1  75.00 ( 76.45)
 * Prompt Acc@1 76.460
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:04<05:48,  4.47s/it]  3%|▎         | 2/79 [00:05<02:50,  2.21s/it]  4%|▍         | 3/79 [00:05<01:56,  1.54s/it]  5%|▌         | 4/79 [00:06<01:23,  1.11s/it]  6%|▋         | 5/79 [00:06<01:03,  1.16it/s]  8%|▊         | 6/79 [00:07<00:50,  1.44it/s]  9%|▉         | 7/79 [00:07<00:40,  1.79it/s] 10%|█         | 8/79 [00:07<00:34,  2.07it/s] 11%|█▏        | 9/79 [00:07<00:30,  2.32it/s] 13%|█▎        | 10/79 [00:08<00:26,  2.60it/s] 14%|█▍        | 11/79 [00:08<00:24,  2.78it/s] 15%|█▌        | 12/79 [00:08<00:22,  2.99it/s] 16%|█▋        | 13/79 [00:09<00:20,  3.26it/s] 18%|█▊        | 14/79 [00:09<00:20,  3.23it/s] 19%|█▉        | 15/79 [00:09<00:19,  3.33it/s] 20%|██        | 16/79 [00:09<00:18,  3.42it/s] 22%|██▏       | 17/79 [00:10<00:18,  3.44it/s] 23%|██▎       | 18/79 [00:10<00:16,  3.59it/s] 24%|██▍       | 19/79 [00:10<00:16,  3.71it/s] 25%|██▌       | 20/79 [00:11<00:16,  3.64it/s] 27%|██▋       | 21/79 [00:11<00:16,  3.49it/s] 28%|██▊       | 22/79 [00:11<00:15,  3.64it/s] 29%|██▉       | 23/79 [00:11<00:14,  3.78it/s] 30%|███       | 24/79 [00:12<00:15,  3.54it/s] 32%|███▏      | 25/79 [00:12<00:15,  3.56it/s] 33%|███▎      | 26/79 [00:12<00:14,  3.69it/s] 34%|███▍      | 27/79 [00:12<00:14,  3.67it/s] 35%|███▌      | 28/79 [00:13<00:14,  3.40it/s] 37%|███▋      | 29/79 [00:13<00:14,  3.48it/s] 38%|███▊      | 30/79 [00:13<00:13,  3.62it/s] 39%|███▉      | 31/79 [00:14<00:13,  3.63it/s] 41%|████      | 32/79 [00:14<00:12,  3.63it/s] 42%|████▏     | 33/79 [00:14<00:12,  3.61it/s] 43%|████▎     | 34/79 [00:14<00:12,  3.63it/s] 44%|████▍     | 35/79 [00:15<00:12,  3.62it/s] 46%|████▌     | 36/79 [00:15<00:11,  3.76it/s] 47%|████▋     | 37/79 [00:15<00:10,  3.87it/s] 48%|████▊     | 38/79 [00:16<00:11,  3.57it/s] 49%|████▉     | 39/79 [00:16<00:11,  3.35it/s] 51%|█████     | 40/79 [00:16<00:11,  3.43it/s] 52%|█████▏    | 41/79 [00:16<00:10,  3.61it/s] 53%|█████▎    | 42/79 [00:17<00:10,  3.41it/s] 54%|█████▍    | 43/79 [00:17<00:10,  3.47it/s] 56%|█████▌    | 44/79 [00:17<00:09,  3.53it/s] 57%|█████▋    | 45/79 [00:18<00:09,  3.55it/s] 58%|█████▊    | 46/79 [00:18<00:09,  3.58it/s] 59%|█████▉    | 47/79 [00:18<00:08,  3.61it/s] 61%|██████    | 48/79 [00:18<00:08,  3.74it/s] 62%|██████▏   | 49/79 [00:19<00:07,  3.84it/s] 63%|██████▎   | 50/79 [00:19<00:07,  3.90it/s] 65%|██████▍   | 51/79 [00:19<00:07,  3.97it/s] 66%|██████▌   | 52/79 [00:19<00:06,  4.01it/s] 67%|██████▋   | 53/79 [00:20<00:06,  4.02it/s] 68%|██████▊   | 54/79 [00:20<00:06,  4.05it/s] 70%|██████▉   | 55/79 [00:20<00:05,  4.06it/s] 71%|███████   | 56/79 [00:20<00:05,  4.08it/s] 72%|███████▏  | 57/79 [00:21<00:05,  4.09it/s] 73%|███████▎  | 58/79 [00:21<00:05,  4.08it/s] 75%|███████▍  | 59/79 [00:21<00:04,  4.08it/s] 76%|███████▌  | 60/79 [00:21<00:04,  4.07it/s] 77%|███████▋  | 61/79 [00:22<00:04,  4.07it/s] 78%|███████▊  | 62/79 [00:22<00:04,  4.07it/s] 80%|███████▉  | 63/79 [00:22<00:03,  4.07it/s] 81%|████████  | 64/79 [00:22<00:03,  4.08it/s] 82%|████████▏ | 65/79 [00:22<00:03,  4.09it/s] 84%|████████▎ | 66/79 [00:23<00:03,  4.09it/s] 85%|████████▍ | 67/79 [00:23<00:02,  4.08it/s] 86%|████████▌ | 68/79 [00:23<00:02,  4.09it/s] 87%|████████▋ | 69/79 [00:23<00:02,  4.08it/s] 89%|████████▊ | 70/79 [00:24<00:02,  4.08it/s] 90%|████████▉ | 71/79 [00:24<00:01,  4.09it/s] 91%|█████████ | 72/79 [00:24<00:01,  4.09it/s] 92%|█████████▏| 73/79 [00:24<00:01,  4.10it/s] 94%|█████████▎| 74/79 [00:25<00:01,  4.09it/s] 95%|█████████▍| 75/79 [00:25<00:00,  4.10it/s] 96%|█████████▌| 76/79 [00:25<00:00,  4.09it/s] 97%|█████████▋| 77/79 [00:25<00:00,  4.08it/s] 99%|█████████▊| 78/79 [00:26<00:00,  4.09it/s]100%|██████████| 79/79 [00:26<00:00,  2.99it/s]
Validate: [ 0/79]	Time  4.471 ( 4.471)	Loss 7.4922e+00 (7.4922e+00)	Prompt Acc@1   0.00 (  0.00)
Validate: [10/79]	Time  0.303 ( 0.780)	Loss 7.4219e+00 (7.5121e+00)	Prompt Acc@1   0.78 (  0.36)
Validate: [20/79]	Time  0.315 ( 0.541)	Loss 7.4844e+00 (7.4894e+00)	Prompt Acc@1   0.00 (  0.33)
Validate: [30/79]	Time  0.274 ( 0.455)	Loss 7.4570e+00 (7.4803e+00)	Prompt Acc@1   0.78 (  0.38)
Validate: [40/79]	Time  0.244 ( 0.412)	Loss 7.4570e+00 (7.4479e+00)	Prompt Acc@1   0.00 (  0.32)
Validate: [50/79]	Time  0.242 ( 0.384)	Loss 7.4727e+00 (7.4440e+00)	Prompt Acc@1   0.00 (  0.31)
Validate: [60/79]	Time  0.245 ( 0.361)	Loss 7.1875e+00 (7.4458e+00)	Prompt Acc@1   0.00 (  0.28)
Validate: [70/79]	Time  0.243 ( 0.345)	Loss 7.1914e+00 (7.4482e+00)	Prompt Acc@1   0.78 (  0.31)
 * Prompt Acc@1 0.300
TOP1 Accuracy on cifar10 + cifar100 is: 38.379999999999995
